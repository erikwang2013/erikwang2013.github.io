{
    "version": "https://jsonfeed.org/version/1",
    "title": "艾瑞可erik • All posts by \"框架\" tag • All posts by \"undefined\" categories",
    "description": "一只PHP开发的程序猿，偶尔做做运维、Goland、Python、Java、摄影、画画、写作、顺便睡觉，反正整站都搞过。",
    "home_page_url": "https://erik.xyz",
    "items": [
        {
            "id": "https://erik.xyz/2014/11/05/ecshop-hou-tai-guan-li-yuan-deng-lu-xian-shi-shang-pin-lie-biao-jia-ge-bu-tong/",
            "url": "https://erik.xyz/2014/11/05/ecshop-hou-tai-guan-li-yuan-deng-lu-xian-shi-shang-pin-lie-biao-jia-ge-bu-tong/",
            "title": "ecshop后台管理员登陆显示商品列表价格不同",
            "date_published": "2014-11-05T10:35:00.000Z",
            "content_html": "<p>文件 goods_list.htm privilege.php privilege.php找到set_admin_session($row[‘user_id’], $row[‘user_name’], $row[‘action_list’], $row[‘last_login’]);在其上下分别添加 $admin_zk=explode(“||”,$row[‘adminzk’ ]);上 $_SESSION[‘adminzk’] = $admin_zk[2];下 在查找 if(!empty($ec_salt))把sql预计加上字段adminzk 在goods_list.htm查找 {$goods.shop_price} 把 {$goods.shop_price} 改为{if $goods.shop_price=$goods.shop_price*$smarty.session.adminzk/100} {$goods.shop_price} {/if} 其中折扣adminzk在管理员列表里格式###|###|###|###|###||###||###</p>\n",
            "tags": [
                "ecshop",
                "框架"
            ]
        },
        {
            "id": "https://erik.xyz/2014/11/03/ecshop-hou-tai-hui-yuan-you-xiang-yan-zheng-gai-wei-guan-li-yuan-ke-kong-zhi-yan-zheng-tong-guo/",
            "url": "https://erik.xyz/2014/11/03/ecshop-hou-tai-hui-yuan-you-xiang-yan-zheng-gai-wei-guan-li-yuan-ke-kong-zhi-yan-zheng-tong-guo/",
            "title": "ecshop后台会员邮箱验证改为管理员可控制验证通过",
            "date_published": "2014-11-03T00:43:00.000Z",
            "content_html": "<p>登陆后管理员查看会员列表会发现邮箱验证这块必须客户验证才有效果，不过大多数客户不愿意去验证，就改为管理员可操作吧 因为邮箱验证时判断客户验证状态0或1来选择显示图片对和错的，也刚好想到，在商品列表里有上架、下架，是否新品……刚好可以吧代码复制过来作参考 从商品列表里获知是js验证传输数据的，直接找到js文件，从中打印一下看看路径。根据路径在会员文件里更改数据 商品列表代码<span id=\"more\"></span><br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elseif ($\\_REQUEST\\[&#x27;act&#x27;\\] == &#x27;toggle\\_on\\_sale&#x27;) &#123; </span><br><span class=\"line\">check\\_authz\\_json(&#x27;goods\\_manage&#x27;); </span><br><span class=\"line\">$goods\\_id = intval($\\_POST\\[&#x27;id&#x27;\\]); </span><br><span class=\"line\">$on\\_sale = intval($\\_POST\\[&#x27;val&#x27;\\]); </span><br><span class=\"line\">if ($exc-&gt;edit(&quot;is\\_on\\_sale = &#x27;$on\\_sale&#x27;, last\\_update=&quot; .gmtime(), $goods\\_id)) &#123; clear\\_cache\\_files(); make\\_json\\_result($on\\_sale); &#125; &#125; </span><br></pre></td></tr></table></figure><br>根据这写代码，复制到会员文件里，进行更改。 更改后<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elseif ($\\_REQUEST\\[&#x27;act&#x27;\\] == &#x27;toggle\\_validated&#x27;) &#123;</span><br><span class=\"line\">$user\\_id = intval($\\_REQUEST\\[&#x27;id&#x27;\\]);</span><br><span class=\"line\">$is\\_validated = intval($\\_REQUEST\\[&#x27;val&#x27;\\]);</span><br><span class=\"line\">$exc = new exchange($ecs-&gt;table(&#x27;users&#x27;), $db, &#x27;user\\_id&#x27;, &#x27;user\\_name&#x27;);</span><br><span class=\"line\">if ($exc-&gt;edit(&quot;is\\_validated = &#x27;$is\\_validated&#x27;&quot;, $user\\_id)) &#123; </span><br><span class=\"line\">clear\\_cache\\_files(); make\\_json\\_result(stripslashes($is\\_validated));</span><br><span class=\"line\">&#125; </span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure><br>另外要注意htm文件也要更改，仿照商品表里的即可。</p>\n",
            "tags": [
                "ecshop",
                "框架"
            ]
        },
        {
            "id": "https://erik.xyz/2014/10/30/zai-ecshop-yong-hu-zhong-xin-wo-de-ding-dan-lie-biao-zhong-xian-shi-shang-pin-suo-lve-tu/",
            "url": "https://erik.xyz/2014/10/30/zai-ecshop-yong-hu-zhong-xin-wo-de-ding-dan-lie-biao-zhong-xian-shi-shang-pin-suo-lve-tu/",
            "title": "在ecshop用户中心我的订单列表中显示商品缩略图",
            "date_published": "2014-10-30T02:16:00.000Z",
            "content_html": "<p>在/includes/lib_transaction.php找到<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$arr\\[\\] = array(</span><br><span class=\"line\">&#x27;order\\_id&#x27;       =&gt; $row\\[&#x27;order\\_id&#x27;\\],</span><br><span class=\"line\">&#x27;order\\_sn&#x27;       =&gt; $row\\[&#x27;order\\_sn&#x27;\\], </span><br><span class=\"line\">&#x27;order\\_time&#x27;     =&gt; local\\_date($GLOBALS\\[&#x27;\\_CFG&#x27;\\]\\[&#x27;time\\_format&#x27;\\], $row\\[&#x27;add\\_time&#x27;\\]), &#x27;order\\_status&#x27;   =&gt; $row\\[&#x27;order\\_status&#x27;\\], </span><br><span class=\"line\">&#x27;total\\_fee&#x27;      =&gt; price\\_format($row\\[&#x27;total\\_fee&#x27;\\], false),</span><br><span class=\"line\">&#x27;handler&#x27;        =&gt; $row\\[&#x27;handler&#x27;\\]); </span><br></pre></td></tr></table></figure><br><span id=\"more\"></span><br>修改为<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$arr\\[\\] = array(</span><br><span class=\"line\">&#x27;order\\_id&#x27;       =&gt; $row\\[&#x27;order\\_id&#x27;\\],</span><br><span class=\"line\">&#x27;order\\_sn&#x27;       =&gt; $row\\[&#x27;order\\_sn&#x27;\\], </span><br><span class=\"line\">&#x27;order\\_time&#x27;     =&gt; local\\_date($GLOBALS\\[&#x27;\\_CFG&#x27;\\]\\[&#x27;time\\_format&#x27;\\], $row\\[&#x27;add\\_time&#x27;\\]), &#x27;order\\_status&#x27;   =&gt; $row\\[&#x27;order\\_status&#x27;\\],</span><br><span class=\"line\">&#x27;total\\_fee&#x27;      =&gt; price\\_format($row\\[&#x27;total\\_fee&#x27;\\], false), </span><br><span class=\"line\">&#x27;handler&#x27;        =&gt; $row\\[&#x27;handler&#x27;\\], &#x27;thumb&#x27;          =&gt; $row\\[&#x27;thumb&#x27;\\]); </span><br></pre></td></tr></table></figure><br>并在其前面添加<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$row\\[&#x27;thumb&#x27;\\] =$GLOBALS\\[&#x27;db&#x27;\\] -&gt;getOne(&quot;select goods\\_thumb from&quot;. $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&quot;goods&quot;). &quot;where goods\\_id =(select min(goods\\_id) from&quot;. $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&quot;order\\_goods&quot;). &quot;where order\\_id=&quot;.$row\\[&#x27;order\\_id&#x27;\\].&quot;)&quot;); </span><br></pre></td></tr></table></figure><br>在themes/default/user_transaction.dwt中 找到<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;td bgcolor=&quot;#ffffff&quot;&gt;&#123;$lang.order\\_addtime&#125;&lt;/td&gt; </span><br></pre></td></tr></table></figure><br>在其前面添加<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;td bgcolor=&quot;#ffffff&quot;&gt;缩略图&lt;/td&gt; </span><br></pre></td></tr></table></figure><br>再找到<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;td align=&quot;center&quot; bgcolor=&quot;#ffffff&quot;&gt;&#123;$item.order\\_time&#125;&lt;/td&gt; </span><br></pre></td></tr></table></figure><br>在其前面添加<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;td  align=center bgcolor=&quot;#ffffff&quot;&gt;&lt;img src=&quot;&#123;$item.thumb&#125;&quot; class=&quot;img_sstb&quot;/&gt;&lt;/td&gt;</span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "ecshop",
                "框架"
            ]
        },
        {
            "id": "https://erik.xyz/2014/10/30/echsop-gou-wu-che-ding-dan-ti-jiao-xiang-xi-ye-shang-pin-suo-lve-tu/",
            "url": "https://erik.xyz/2014/10/30/echsop-gou-wu-che-ding-dan-ti-jiao-xiang-xi-ye-shang-pin-suo-lve-tu/",
            "title": "echsop购物车、订单提交详细页商品缩略图",
            "date_published": "2014-10-30T02:13:00.000Z",
            "content_html": "<p>ecshop不提供商品缩略图展示功能， 找到include/lib_order.php库文件中的cart_goods()函数 在其中添加红色部分<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">foreach ($arr as $key =&gt; $value) &#123;     /\\* LONGHTML 增加是否在购物车里显示商品图 */    </span><br><span class=\"line\">  if (($GLOBALS\\[&#x27;\\_CFG&#x27;\\]\\[&#x27;show\\_goods\\_in\\_cart&#x27;\\] == &quot;2&quot; || $GLOBALS\\[&#x27;\\_CFG&#x27;\\]\\[&#x27;show\\_goods\\_in\\_cart&#x27;\\] == &quot;3&quot;) &amp;&amp; $row\\[&#x27;extension\\_code&#x27;\\] != &#x27;package\\_buy&#x27;)      &#123; </span><br><span class=\"line\">  $goods\\_thumb = $GLOBALS\\[&#x27;db&#x27;\\]-&gt;getOne(&quot;SELECT \\`goods\\_thumb\\` FROM &quot; . $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;goods&#x27;) . &quot; WHERE \\`goods\\_id\\`=&quot;.$arr\\[$key\\]\\[&#x27;goods\\_id&#x27;\\]);          </span><br><span class=\"line\">  $arr\\[$key\\]\\[&#x27;goods\\_thumb&#x27;\\] = get\\_image\\_path($arr\\[$key\\]\\[&#x27;goods\\_id&#x27;\\], $goods_thumb, true);        </span><br><span class=\"line\">  &#125; // END </span><br><span class=\"line\">  $arr\\[$key\\]\\[&#x27;formated\\_market\\_price&#x27;\\] = price\\_format($value\\[&#x27;market\\_price&#x27;\\], false);</span><br><span class=\"line\">  $arr\\[$key\\]\\[&#x27;formated\\_goods\\_price&#x27;\\]  = price\\_format($value\\[&#x27;goods\\_price&#x27;\\], false);</span><br><span class=\"line\">  $arr\\[$key\\]\\[&#x27;formated\\_subtotal&#x27;\\]     = price\\_format($value\\[&#x27;subtotal&#x27;\\], false); </span><br><span class=\"line\">  if ($value\\[&#x27;extension\\_code&#x27;\\] == &#x27;package\\_buy&#x27;) &#123; </span><br><span class=\"line\">  $arr\\[$key\\]\\[&#x27;package\\_goods\\_list&#x27;\\] = get\\_package\\_goods($value\\[&#x27;goods\\_id&#x27;\\]); </span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125; </span><br></pre></td></tr></table></figure><br><span id=\"more\"></span><br>修改修改themes/defalut/flow.dwt文件 中找到67行左右在{$goods.goods_name}前添加<img width=\"100\" height=\"100\" src=\"{$goods.goods\\_thumb}\" border=\"0\" />购物车显示缩略图 中找到564行左右在{$goods.goods_name}前添加<img width=\"100\" height=\"100\" src=\"{$goods.goods_thumb}\" border=\"0\" />订单提交页面显示缩略图</p>\n",
            "tags": [
                "ecshop",
                "框架"
            ]
        },
        {
            "id": "https://erik.xyz/2014/10/29/excel-biao-ge-dao-chu-ecshop-ding-dan-xiang-qing-ye-dao-chu/",
            "url": "https://erik.xyz/2014/10/29/excel-biao-ge-dao-chu-ecshop-ding-dan-xiang-qing-ye-dao-chu/",
            "title": "excel表格导出，ecshop订单详情页导出。",
            "date_published": "2014-10-29T03:30:00.000Z",
            "content_html": "<p>最近被excel 导出困扰了，终于解决了大部分为题，在这里分享一下 方法1 首先下载PHPexcel插件包 <a href=\"http://download.csdn.net/detail/w15875510692/7747765\">http://download.csdn.net/detail/w15875510692/7747765</a> 以下是ecshop订单详细页的导出代码 目前没找到直接能到处网站空间的图片（超链接地址的图片），只能到处本地网站的图片。。 htm页面代码 <span id=\"more\"></span><br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;script language=&quot;JavaScript&quot;&gt; </span><br><span class=\"line\">function check() &#123; </span><br><span class=\"line\">  var snArray = new Array(); var eles = document.forms\\[&#x27;listForm&#x27;\\].elements; </span><br><span class=\"line\">  for (var i=0; i&lt;eles.length; i++) &#123; </span><br><span class=\"line\">    if (eles\\[i\\].tagName == &#x27;INPUT&#x27; &amp;&amp; eles\\[i\\].type == &#x27;hidden&#x27; &amp;&amp; eles\\[i\\].checked &amp;&amp; eles\\[i\\].value != &#x27;on&#x27;) &#123; snArray.push(eles\\[i\\].value);</span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">  if (snArray.length == 0) &#123;</span><br><span class=\"line\">  \treturn false; </span><br><span class=\"line\">  &#125; else &#123; </span><br><span class=\"line\">  \teles\\[&#x27;order\\_id&#x27;\\].value = snArray.toString(); return true; </span><br><span class=\"line\">  &#125; </span><br><span class=\"line\">&#125; </span><br><span class=\"line\">&lt;/script&gt;</span><br><span class=\"line\">&lt;form action=&quot;order.php?act=operate&quot; method=&quot;post&quot; name=&quot;listForm&quot;  onsubmit=&quot;return check()&quot;&gt; </span><br><span class=\"line\">&lt;div class=&quot;div\\_excel&quot;&gt; </span><br><span class=\"line\">&lt;input type=&quot;hidden&quot; name=&quot;checkboxes&quot;checked=&quot;checked&quot;  value=&quot;&#123;$order.order\\_sn&#125;&quot; /&gt; </span><br><span class=\"line\">&lt;input name=&quot;export&quot; type=&quot;submit&quot; id=&quot;btnSubmit5&quot; value=&quot;导出&quot; class=&quot;button&quot;   onclick=&quot;this.form.target = &#x27;\\_blank&#x27;&quot; onclick=&quot;window.open(&#x27;order.php?act=operate&#x27;)&quot; onsubmit=&quot;return check()&quot;/&gt; &lt;input name=&quot;order\\_id&quot; type=&quot;hidden&quot; value=&quot;&#123;$order.order\\_sn&#125;&quot; /&gt; &lt;/div&gt; &lt;/form&gt; </span><br></pre></td></tr></table></figure><br>  php文件代码 /*******************excel导出*************/<br>  <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">elseif (isset($\\_POST\\[&#x27;export&#x27;\\])) &#123; /* 赋值公用信息 */ require\\_once ROOT\\_PATH.&#x27;salesmans/Classes/PHPExcel.php&#x27;; require\\_once ROOT\\_PATH.&#x27;salesmans/Classes/PHPExcel/IOFactory.php&#x27;; // Create new PHPExcel object $objPHPExcel = new PHPExcel(); // Set properties $objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;DizzyLion&quot;) -&gt;setLastModifiedBy(&quot;DizzyLion&quot;) -&gt;setSubject(&quot;Orders output Document&quot;); $filepaths= ROOT\\_PATH.&quot;data/&quot;.date(&quot;Y-m&quot;).&#x27;.xls&#x27;; $filename = date(&quot;Y-m&quot;).&#x27;.xls&#x27;; $rowix = 1; error\\_reporting(E\\_ALL); date\\_default\\_timezone\\_set(&#x27;Europe/London&#x27;); $objPHPExcel-&gt;getProperties()-&gt;setCreator(&quot;wdz&quot;)-&gt;setLastModifiedBy(&quot;wdz&quot;)-&gt;setTitle(&quot; 我的订单&quot;)-&gt;setSubject(&quot;我的订单&quot;)-&gt;setDescription(date(&#x27;Y/m/d H:i:s&#x27;) . &quot;导出的订单&quot;)-&gt;setKeywords(&quot;我的订单&quot;)-&gt;setCategory(&quot;Test result file&quot;); /*设置标题属性*/ //字体大小 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;A1&#x27;)-&gt;getFont()-&gt;setSize(16); //加粗 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;A1&#x27;)-&gt;getFont()-&gt;setBold(true); //表格宽度 $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(&#x27;A&#x27;)-&gt;setWidth(20); //垂直居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;A1&#x27;)-&gt;getAlignment()-&gt;setVertical(PHPExcel\\_Style\\_Alignment::VERTICAL\\_CENTER); //水平居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;A1&#x27;)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel\\_Style\\_Alignment::HORIZONTAL\\_CENTER); /////////////////////// //字体大小 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;B1&#x27;)-&gt;getFont()-&gt;setSize(16); //加粗 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;B1&#x27;)-&gt;getFont()-&gt;setBold(true); //表格宽度 $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(&#x27;B&#x27;)-&gt;setWidth(20); //垂直居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;B1&#x27;)-&gt;getAlignment()-&gt;setVertical(PHPExcel\\_Style\\_Alignment::VERTICAL\\_CENTER); //水平居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;B1&#x27;)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel\\_Style\\_Alignment::HORIZONTAL\\_CENTER); //////////////////// //字体大小 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;C1&#x27;)-&gt;getFont()-&gt;setSize(16); //加粗 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;C1&#x27;)-&gt;getFont()-&gt;setBold(true); //表格宽度 $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(&#x27;C&#x27;)-&gt;setWidth(30); //表格高度 $objPHPExcel-&gt;getActiveSheet()-&gt;getRowDimension(&#x27;2&#x27;)-&gt;setRowHeight(75); $objPHPExcel-&gt;getActiveSheet()-&gt;getRowDimension(&#x27;3&#x27;)-&gt;setRowHeight(75); $objPHPExcel-&gt;getActiveSheet()-&gt;getRowDimension(&#x27;4&#x27;)-&gt;setRowHeight(75); $objPHPExcel-&gt;getActiveSheet()-&gt;getRowDimension(&#x27;5&#x27;)-&gt;setRowHeight(75); $objPHPExcel-&gt;getActiveSheet()-&gt;getRowDimension(&#x27;6&#x27;)-&gt;setRowHeight(75); $objPHPExcel-&gt;getActiveSheet()-&gt;getRowDimension(&#x27;7&#x27;)-&gt;setRowHeight(75); $objPHPExcel-&gt;getActiveSheet()-&gt;getRowDimension(&#x27;8&#x27;)-&gt;setRowHeight(75); //垂直居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;C1&#x27;)-&gt;getAlignment()-&gt;setVertical(PHPExcel\\_Style\\_Alignment::VERTICAL\\_CENTER); //水平居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;C1&#x27;)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel\\_Style\\_Alignment::HORIZONTAL\\_CENTER); /////////////////////// //字体大小 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;D1&#x27;)-&gt;getFont()-&gt;setSize(16); //加粗 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;D1&#x27;)-&gt;getFont()-&gt;setBold(true); //表格宽度 $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(&#x27;D&#x27;)-&gt;setWidth(30); //垂直居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;D1&#x27;)-&gt;getAlignment()-&gt;setVertical(PHPExcel\\_Style\\_Alignment::VERTICAL\\_CENTER); //水平居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;D1&#x27;)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel\\_Style\\_Alignment::HORIZONTAL\\_CENTER); //////////////////// //字体大小 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;E1&#x27;)-&gt;getFont()-&gt;setSize(16); //加粗 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;E1&#x27;)-&gt;getFont()-&gt;setBold(true); //表格宽度 $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(&#x27;E&#x27;)-&gt;setWidth(30); //垂直居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;E1&#x27;)-&gt;getAlignment()-&gt;setVertical(PHPExcel\\_Style\\_Alignment::VERTICAL\\_CENTER); //水平居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;E1&#x27;)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel\\_Style\\_Alignment::HORIZONTAL\\_CENTER); //////////////////// //字体大小 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;F1&#x27;)-&gt;getFont()-&gt;setSize(16); //加粗 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;F1&#x27;)-&gt;getFont()-&gt;setBold(true); //表格宽度 $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(&#x27;F&#x27;)-&gt;setWidth(80); //垂直居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;F1&#x27;)-&gt;getAlignment()-&gt;setVertical(PHPExcel\\_Style\\_Alignment::VERTICAL\\_CENTER); //水平居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;F1&#x27;)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel\\_Style\\_Alignment::HORIZONTAL\\_CENTER); //////////////////// //字体大小 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;G1&#x27;)-&gt;getFont()-&gt;setSize(16); //加粗 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;G1&#x27;)-&gt;getFont()-&gt;setBold(true); //表格宽度 $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(&#x27;G&#x27;)-&gt;setWidth(10); //垂直居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;G1&#x27;)-&gt;getAlignment()-&gt;setVertical(PHPExcel\\_Style\\_Alignment::VERTICAL\\_CENTER); //水平居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;G1&#x27;)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel\\_Style\\_Alignment::HORIZONTAL\\_CENTER); //////////////////// //字体大小 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;H1&#x27;)-&gt;getFont()-&gt;setSize(16); //加粗 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;H1&#x27;)-&gt;getFont()-&gt;setBold(true); //表格宽度 $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(&#x27;H&#x27;)-&gt;setWidth(10); //垂直居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;H1&#x27;)-&gt;getAlignment()-&gt;setVertical(PHPExcel\\_Style\\_Alignment::VERTICAL\\_CENTER); //水平居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;H1&#x27;)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel\\_Style\\_Alignment::HORIZONTAL\\_CENTER); //////////////////// //字体大小 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;I1&#x27;)-&gt;getFont()-&gt;setSize(16); //加粗 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;I1&#x27;)-&gt;getFont()-&gt;setBold(true); //表格宽度 $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(&#x27;I&#x27;)-&gt;setWidth(10); //垂直居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;I1&#x27;)-&gt;getAlignment()-&gt;setVertical(PHPExcel\\_Style\\_Alignment::VERTICAL\\_CENTER); //水平居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;I1&#x27;)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel\\_Style\\_Alignment::HORIZONTAL\\_CENTER); //////////////////// //字体大小 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;J1&#x27;)-&gt;getFont()-&gt;setSize(16); //加粗 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;J1&#x27;)-&gt;getFont()-&gt;setBold(true); //表格宽度 $objPHPExcel-&gt;getActiveSheet()-&gt;getColumnDimension(&#x27;J&#x27;)-&gt;setWidth(15); //垂直居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;J1&#x27;)-&gt;getAlignment()-&gt;setVertical(PHPExcel\\_Style\\_Alignment::VERTICAL\\_CENTER); //水平居中 $objPHPExcel-&gt;getActiveSheet()-&gt;getStyle(&#x27;J1&#x27;)-&gt;getAlignment()-&gt;setHorizontal(PHPExcel\\_Style\\_Alignment::HORIZONTAL\\_CENTER); //////////////////// echo date(&#x27;H:i:s&#x27;) . &quot; Add some data\\\\n&quot;; $objPHPExcel-&gt;setActiveSheetIndex(0); $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&#x27;A1&#x27;, &#x27;订货日期&#x27;); $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&#x27;B1&#x27;, &#x27;订单号&#x27;); $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&#x27;C1&#x27;, &#x27;商品图&#x27;); $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&#x27;D1&#x27;, &#x27;款号&#x27;); $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&#x27;E1&#x27;, &#x27;商品名称&#x27;); $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&#x27;F1&#x27;, &#x27;属性&#x27;); $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&#x27;G1&#x27;, &#x27;数量&#x27;); $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&#x27;H1&#x27;, &#x27;价格&#x27;); $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&#x27;I1&#x27;, &#x27;合计&#x27;); $objPHPExcel-&gt;getActiveSheet()-&gt;setCellValue(&#x27;J1&#x27;, &#x27;应付金额&#x27;); $rowix++; $i=0; $list = array(); //         $order\\_id = intval($\\_REQUEST\\[&#x27;order\\_id&#x27;\\]); $order\\_sn\\_list = explode(&#x27;,&#x27;, $\\_POST\\[&#x27;order\\_id&#x27;\\]); foreach ($order\\_sn\\_list as $order\\_sn) &#123; /* 取得订单信息 */ $sql = &quot;select * from &quot;.$GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;order\\_info&#x27;).&quot; o  join &quot;.$GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;users&#x27;).&quot; u on o.user\\_id =u.user\\_id where order\\_sn=&#x27;$order\\_sn&#x27;&quot;; $row = $db-&gt;getRow($sql); $goods= $db-&gt;getAll(&quot;select goods\\_name,goods\\_id,goods\\_number,goods\\_price,goods\\_price,goods\\_attr\\_id,goods\\_attr \\*goods\\_number as je,goods\\_sn from &quot;.$GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;order\\_goods&#x27;).&quot; where order\\_id = &#x27;&quot;.$row\\[&#x27;order\\_id&#x27;\\].&quot;&#x27;&quot;); if($goods)&#123; foreach($goods as $k=&gt;$v)&#123; $temp    = array(); $v\\[&#x27;img&#x27;\\] = $db-&gt;getOne(&quot;select goods\\_thumb from &quot;.$GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;goods&#x27;).&quot; where goods\\_id=&#x27;&quot;.$v\\[&#x27;goods\\_id&#x27;\\].&quot;&#x27;&quot;); $temp\\[&#x27;goods&#x27;\\] = $v; $temp\\[&#x27;order\\_info&#x27;\\] = $row; $list\\[$row\\[&#x27;order\\_id&#x27;\\]\\]\\[\\] = $temp; &#125; &#125; &#125; foreach ($list as $key =&gt; $t) &#123; foreach($t as $k1=&gt;$value)&#123; $objPHPExcel-&gt;setActiveSheetIndex(0) -&gt;setCellValue(&#x27;B&#x27;.$rowix ,  $value\\[&#x27;order\\_info&#x27;\\]\\[&#x27;order\\_sn&#x27;\\]) -&gt;setCellValue(&#x27;D&#x27;.$rowix ,  $value\\[&#x27;goods&#x27;\\]\\[&#x27;img&#x27;\\]) -&gt;setCellValue(&#x27;D&#x27;.$rowix ,  $value\\[&#x27;goods&#x27;\\]\\[&#x27;goods\\_sn&#x27;\\]) -&gt;setCellValue(&#x27;E&#x27;.$rowix ,  $value\\[&#x27;goods&#x27;\\]\\[&#x27;goods\\_name&#x27;\\]) -&gt;setCellValue(&#x27;F&#x27;.$rowix ,  $value\\[&#x27;goods&#x27;\\]\\[&#x27;goods\\_attr\\_id&#x27;\\]) -&gt;setCellValue(&#x27;G&#x27;.$rowix ,  $value\\[&#x27;goods&#x27;\\]\\[&#x27;goods\\_number&#x27;\\]) -&gt;setCellValue(&#x27;H&#x27;.$rowix ,  $value\\[&#x27;goods&#x27;\\]\\[&#x27;goods\\_price&#x27;\\]) -&gt;setCellValue(&#x27;A&#x27;.$rowix ,  local\\_date(&quot;Y-m-d&quot;,$value\\[&#x27;order\\_info&#x27;\\]\\[&#x27;add\\_time&#x27;\\])) -&gt;setCellValue(&#x27;I&#x27;.$rowix ,  $value\\[&#x27;order\\_info&#x27;\\]\\[&#x27;goods\\_amount&#x27;\\]) -&gt;setCellValue(&#x27;J&#x27;.$rowix ,  $value\\[&#x27;order\\_info&#x27;\\]\\[&#x27;order\\_amount&#x27;\\]); $objDrawing = new PHPExcel\\_Worksheet\\_Drawing();</span><br><span class=\"line\">$objDrawing-&gt;setName(&#x27;ZealImg&#x27;); $objDrawing-&gt;setDescription(&#x27;Image&#x27;); </span><br><span class=\"line\">$objDrawing-&gt;setPath(&#x27;../images/img\\_excel/img10.jpg&#x27;); $objDrawing-&gt;setHeight(&#x27;92px&#x27;);//照片高度 $objDrawing-&gt;setWidth(&#x27;90px&#x27;); //照片宽度 $objDrawing-&gt;setCoordinates(&#x27;C&#x27;.$rowix); $objDrawing-&gt;setWorksheet($objPHPExcel-&gt;getActiveSheet()); $rowix++; &#125; &#125; $objPHPExcel-&gt;setActiveSheetIndex(0); $objWriter = PHPExcel\\_IOFactory::createWriter($objPHPExcel, &#x27;Excel5&#x27;); $objWriter-&gt;setTempDir(ROOT\\_PATH.&quot;data&quot;); $objWriter-&gt;save($filepaths); header(&quot;Location:../data/&quot;.$filename); exit; &#125; </span><br></pre></td></tr></table></figure></p>\n<p>*——————————-excel表格————end————————————————- */ 方法2 这种就比较简单，不需要导出图片代码也很少<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php define(&#x27;IN\\_ECS&#x27;, true); include (&#x27;includes/init.php&#x27;); $filename=&#x27;订单&#x27;; header(&quot;Content-type: application/vnd.ms-excel; charset=gbk&quot;); header(&quot;Content-Disposition: attachment; filename=$filename.xls&quot;); $order\\_id = intval($\\_REQUEST\\[&#x27;order\\_id&#x27;\\]); // $sql = &quot;select a.user\\_id from&quot; .$GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;users&#x27;).&quot; a join (select p.order\\_id, o.order\\_sn, o.user\\_id from &quot; . $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;order\\_goods&#x27;) . &quot; p join&quot; . $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;order\\_info&#x27;) .&quot; o on p.order\\_id=o.order\\_id where user\\_id in&quot;. //         &quot;(select user\\_id from&quot; .$GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;users&#x27;). &quot; a join &quot;.$GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;ex\\_user&#x27;).&quot; b on a.s\\_user=b.username &quot;. //         &quot;where 1=1 )) b on a.user\\_id=b.user\\_id&quot;; //$sql=&quot;select * from &quot; . $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;order\\_info&#x27;) .&quot; g join (select  o.*, g.goods\\_number   AS storage,  IFNULL(b.brand\\_name, &#x27;&#x27;) AS brand\\_name &quot; .&quot; from &quot; . $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;order\\_goods&#x27;) . &quot; AS o &quot; . &quot;LEFT JOIN &quot; . $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;goods&#x27;) . &quot; AS g ON o.goods\\_id = g.goods\\_id &quot; . &quot;LEFT JOIN &quot; . $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;brand&#x27;) . &quot; AS b ON g.brand\\_id = b.brand\\_id &quot; . &quot;WHERE o.order\\_id = &#x27;$order\\_id&#x27; )  p on g.order\\_id=p.order\\_id&quot;; $sql=&quot;select *, (g.goods\\_price*g.goods\\_number) as num\\_price, g.goods\\_attr from &quot; . $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;goods&#x27;) .&quot; gt, &quot; . $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;order\\_info&#x27;) .&quot; i, &quot; . $GLOBALS\\[&#x27;ecs&#x27;\\]-&gt;table(&#x27;order\\_goods&#x27;) .&quot; g where g.order\\_id=i.order\\_id and gt.goods\\_id = g.goods\\_id and i.order\\_id = &#x27;$order\\_id&#x27;&quot;; $res=$db-&gt;getAll($sql); //print\\_r($res);die; $data.=&#x27;订单号&#x27;.&quot;\\\\t&quot;; $data.=&#x27;商品图&#x27;.&quot;\\\\t&quot;; $data.=&#x27;商品名称&#x27;.&quot;\\\\t&quot;; $data.=&#x27;商品编号&#x27;.&quot;\\\\t&quot;; $data.=&#x27;商品单价&#x27;.&quot;\\\\t&quot;; $data.=&#x27;商品数量&#x27;.&quot;\\\\t&quot;; $data.=&#x27;合计价格&#x27;.&quot;\\\\t&quot;; $data.=&#x27;应付金额&#x27;.&quot;\\\\t&quot;; $data.=&#x27;属性备注&#x27;.&quot;\\\\t\\\\n&quot;; while (!empty($res)) &#123; foreach ($res as $key=&gt;$var) &#123; $a=$var\\[&#x27;goods\\_id&#x27;\\]; foreach ($res as $keys=&gt;$vars) &#123; if($a==$vars\\[&#x27;goods\\_id&#x27;\\]) &#123; $res1\\[0\\]\\[&#x27;order\\_sn&#x27;\\]=$vars\\[&#x27;order\\_sn&#x27;\\]; $res1\\[$key\\]\\[&#x27;goods\\_thumb&#x27;\\]=$vars\\[&#x27;goods\\_thumb&#x27;\\]; $res1\\[$key\\]\\[&#x27;goods\\_name&#x27;\\]=$vars\\[&#x27;goods\\_name&#x27;\\]; $res1\\[$key\\]\\[&#x27;goods\\_sn&#x27;\\]=$vars\\[&#x27;goods\\_sn&#x27;\\]; $res1\\[$key\\]\\[&#x27;goods\\_price&#x27;\\]=$vars\\[&#x27;goods\\_price&#x27;\\]; $res1\\[$key\\]\\[&#x27;goods\\_number&#x27;\\]=$vars\\[&#x27;goods\\_number&#x27;\\]; $res1\\[0\\]\\[&#x27;goods\\_amount&#x27;\\]=$vars\\[&#x27;goods\\_amount&#x27;\\]; $res1\\[0\\]\\[&#x27;order\\_amount&#x27;\\]=$vars\\[&#x27;order\\_amount&#x27;\\]; $res1\\[$key\\]\\[&#x27;goods\\_attr\\_id&#x27;\\]=$vars\\[&#x27;goods\\_attr\\_id&#x27;\\]; unset ($res\\[$keys\\]); &#125; &#125; &#125; &#125; foreach ($res1 as $key =&gt;$var) &#123; $data.=$var\\[&#x27;order\\_sn&#x27;\\].&quot;\\\\t&quot;; $data.=$var\\[&#x27;goods\\_thumb&#x27;\\].&quot;\\\\t&quot;; $data.=$var\\[&#x27;goods\\_name&#x27;\\].&quot;\\\\t&quot;; $data.=$var\\[&#x27;goods\\_sn&#x27;\\].&quot;\\\\t&quot;; $data.=$var\\[&#x27;goods\\_price&#x27;\\].&quot;\\\\t&quot;; $data.=$var\\[&#x27;goods\\_number&#x27;\\].&quot;\\\\t&quot;; $data.=$var\\[&#x27;goods\\_amount&#x27;\\].&quot;\\\\t&quot;; $data.=$var\\[&#x27;order\\_amount&#x27;\\].&quot;\\\\t&quot;; $data.=$var\\[&#x27;goods\\_attr\\_id&#x27;\\].&quot;\\\\t&quot;; $data.=&quot;\\\\t\\\\n&quot;; &#125; if (EC\\_CHARSET != &#x27;gbk&#x27;) &#123; echo $data.ecs\\_iconv(EC\\_CHARSET, &#x27;gbk&#x27;, $data) . &quot;\\\\t&quot;; &#125; else &#123; echo $data.$data. &quot;\\\\t&quot;; &#125; ?&gt; if (!empty(    $order\\_sn\\_list))&#123; $goods\\_thumb = $\\_POST\\[&#x27;goods\\_thumb&#x27;\\]; $img = grabImage($goods\\_thumb,&quot;&quot;); echo $img; echo &#x27;&lt;pre&gt;&lt;img src=&quot;&#x27;.$img.&#x27;&quot;&gt;&lt;/pre&gt;&#x27;; &#125; //下载图片函数 function grabImage($goods\\_thumb,$filename=&quot;&quot;)&#123; if ($goods\\_thumb == &quot;&quot;) return false; if($filename == &quot;&quot;) &#123; $ext=strrchr($goods\\_thumb,&quot;.&quot;); //获取扩展名 $ext\\_arr = array(&quot;.gif&quot;,&quot;.png&quot;,&quot;.jpg&quot;,&quot;.bmp&quot;); //判断扩展名是否为图片 if (!in\\_array($ext, $ext\\_arr)) return false; //将图片文件名保存为时间戳 $filename = time().$ext; &#125; ob\\_start(); //打开浏览器的缓冲区 readfile($goods\\_thumb); //将图片读入缓冲区 $img = ob\\_get\\_contents(); //获取缓冲区的内容复制给变量$img ob\\_end_clean(); //关闭并清空缓冲 $fp = @fopen($filename,&quot;a&quot;); //将文件绑定到流 fwrite($fp,$img); //写入文件 fclose($fp); //关闭文件之争 return $filename; &#125; ?&gt;</span><br></pre></td></tr></table></figure></p>\n",
            "tags": [
                "ecshop",
                "框架"
            ]
        },
        {
            "id": "https://erik.xyz/2014/10/29/shopex4-5-product-viewpic-xss-lou-dong-he-rao-guo-yan-zheng-ma-lou-dong-xiu-fu/",
            "url": "https://erik.xyz/2014/10/29/shopex4-5-product-viewpic-xss-lou-dong-he-rao-guo-yan-zheng-ma-lou-dong-xiu-fu/",
            "title": "shopex4.5 product viewpic XSS漏洞和绕过验证码漏洞修复",
            "date_published": "2014-10-29T03:21:00.000Z",
            "content_html": "<p>1.product viewpic XSS漏洞 原因： viewpic处未正确转义，形成漏洞，可以跨站脚本攻击 修复方法： 在core\\shop\\controller\\ctl.product.php，找到function viewpic($goodsid, $selected=’def’)，在其下面一行添加 $goodsid = intval($goodsid); 保存，问题解决 2.绕过验证码问题 原因： shopex后台登录的验证码在第一次检验未通过后，并没有清除第一次存在session中验证码，所以可以通过特定的程序来暴力重试破解。 修复方法： 在core/admin/controller/ctl.passport.php中找到</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_SESSION``[``&#x27;loginmsg&#x27;``] = __(“验证码输入错误!”);</span><br></pre></td></tr></table></figure>\n<p>在下面添加</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$_SESSION``[``&#x27;RANDOM_CODE&#x27;``] = ”;</span><br></pre></td></tr></table></figure>\n<p>保存，修复成功</p>\n",
            "tags": [
                "框架",
                "shopex"
            ]
        }
    ]
}