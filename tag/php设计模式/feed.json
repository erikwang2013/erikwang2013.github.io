{
    "version": "https://jsonfeed.org/version/1",
    "title": "艾瑞可erik • All posts by \"php设计模式\" tag • All posts by \"undefined\" categories",
    "description": "一只PHP开发的程序猿，偶尔做做运维、Goland、Python、Java、摄影、画画、写作、顺便睡觉，反正整站都搞过。",
    "home_page_url": "https://erik.xyz",
    "items": [
        {
            "id": "https://erik.xyz/2019/11/16/php-design-pattern/",
            "url": "https://erik.xyz/2019/11/16/php-design-pattern/",
            "title": "php设计模式",
            "date_published": "2019-11-16T13:42:00.000Z",
            "content_html": "<p>设计模式 一书介绍了很多此类概念。当时，我还在学习面向对象 (OO)，因此我发现那本书中有许多概念都很难领会。但是，随着越来越熟悉 OO 概念 —— 尤其是接口和继承的使用 —— 我开始看到设计模式中的实际价值。作为一名应用程序开发人员，即使从不了解任何模式或者如何及何时使用这些模式，对您的职业生涯也没有什么大的影响。但是，我发现了解这些模式以及 developerWorks 文章 “五种常见 PHP 设计模式” 中介绍的那些模式的优秀知识后（请参阅 参考资料），您可以完成两件事情：</p>\n<p>启用高带宽会话<br>如果了解设计模式，您将能够更快地构建可靠的 OO 应用程序。但当整个开发团队知道各种模式时，您可以突然拥有非常高的带宽会话。您不再需要讨论将到处使用的所有类。相反，您可以与其他人谈论模式。“我要在这里引用一个单例（singleton），然后使用迭代器遍历对象集合，然后……” 比遍历构成这些模式的类、方法和接口快很多。单是通信效率一项就值得花时间以团队的形式通过会话来研究模式。<span id=\"more\"></span><br>减少痛苦的教训<br>每个设计模式都描述了一种经过验证的解决常见问题的方法。因此，您无需担心设计是不是正确的，只要您已经选择了提供所需优点的模式。<br>缺陷<br>有句谚语说得好：“当您手中拿着一把锤子时，所有事物看上去都像钉子”。当您认为自己找到一个优秀模式时，您可能会尝试到处使用它，即使在不应当使用它的位置。记住您必须考虑正在学习的模式的使用目的，不要为了使用模式而把这些模式强行应用到应用程序的各个部分中。</p>\n<p>本文将介绍可用于改进 PHP 代码的五个模式。每个模式都将介绍一个特定场景。可以在 下载 部分中获得这些模式的 PHP 代码。</p>\n<p>要求<br>要发挥本文的最大功效并使用示例，需要在计算机中安装以下软件：</p>\n<p>PHP V5 或更高版本（本文是使用 PHP V5.2.4 撰写的）<br>压缩程序，例如 WinZIP（用于压缩可下载的代码归档）<br>注：虽然您也可以使用纯文本编辑器，但是我发现拥有语法高亮显示和语法纠错功能的编辑器真的很有帮助。本文中的示例是使用 Eclipse PHP Development Tools (PDT) 编写的。</p>\n<p>——摘自《另外五个PHP设计模式》</p>\n<ul>\n<li>命令链模式</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\"> * 艾瑞可erik</span><br><span class=\"line\"> * https://erik.xyz</span><br><span class=\"line\"> * 命令链模式</span><br><span class=\"line\"> * Interface ICommand</span><br><span class=\"line\"> */</span><br><span class=\"line\">interface ICommand</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    function onCommand($name, $args);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class CommandChain</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    private $_command = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    public static function load()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new CommandChain();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function addCommand($cmd)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;_command[] = $cmd;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function runCommand($name, $args)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        foreach ($this-&gt;_command as $cmd) &#123;</span><br><span class=\"line\">            if ($cmd-&gt;onCommand($name, $args)) &#123;</span><br><span class=\"line\">                return;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class UserCommand implements ICommand</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public static function load()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new UserCommand();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function OnCommand($name, $args)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        if ($name != &#x27;addUser&#x27;) return false;</span><br><span class=\"line\">        echo(&quot;UserCommand handling &#x27;addUser&#x27;\\n&quot;);</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class MailCommand implements ICommand</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public static function load()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new MailCommand();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function onCommand($name, $args)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        if ($name != &#x27;mail&#x27;) return false;</span><br><span class=\"line\">        echo(&quot;MailCommand handling &#x27;mail&#x27;\\n&quot;);</span><br><span class=\"line\">        return true;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$cc = CommandChain::load();</span><br><span class=\"line\">$cc-&gt;addCommand(UserCommand::load());</span><br><span class=\"line\">$cc-&gt;addCommand(MailCommand::load());</span><br><span class=\"line\">$cc-&gt;runCommand(&#x27;addUser&#x27;, null);</span><br><span class=\"line\">$cc-&gt;runCommand(&#x27;mail&#x27;, null);</span><br></pre></td></tr></table></figure>\n<ul>\n<li>委托模式</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\"> * 艾瑞可erik</span><br><span class=\"line\"> * https://erik.xyz</span><br><span class=\"line\"> * Class bank</span><br><span class=\"line\"> * 委托模式</span><br><span class=\"line\"> */</span><br><span class=\"line\">class bank</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    protected $info = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    public static function load()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new bank();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    /**</span><br><span class=\"line\">     * 传入参数，设置基本信息</span><br><span class=\"line\">     * @param $type</span><br><span class=\"line\">     * @param $money</span><br><span class=\"line\">     * 设置银行存款类型</span><br><span class=\"line\">     */</span><br><span class=\"line\">    public function updateBankInfo($type, $money)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;info[$type] = $money;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function bankWithdraw($bankType)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $obj = $bankType::load();</span><br><span class=\"line\">        return $obj-&gt;bankMain($this-&gt;info);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\"> * 存款操作</span><br><span class=\"line\"> * Class bankDeposit</span><br><span class=\"line\"> */</span><br><span class=\"line\">class bankDeposit</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public static function load()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new bankDeposit();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function bankMain($data)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return $data[&#x27;bankDeposit&#x27;];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\"> * 取款操作</span><br><span class=\"line\"> * Class bankWithdraw</span><br><span class=\"line\"> */</span><br><span class=\"line\">class bankWithdraw</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public static function load()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new bankWithdraw();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function bankMain($data)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return $data[&#x27;bankWithdraw&#x27;];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$bank = bank::load();</span><br><span class=\"line\"></span><br><span class=\"line\">//设置数据</span><br><span class=\"line\">$bank-&gt;updateBankInfo(&quot;bankWithdraw&quot;, 500);</span><br><span class=\"line\">$bank-&gt;updateBankInfo(&quot;bankDeposit&quot;, 100);</span><br><span class=\"line\"></span><br><span class=\"line\">//存款</span><br><span class=\"line\">$bankReturn = $bank-&gt;bankWithdraw(&quot;bankDeposit&quot;);</span><br><span class=\"line\">echo &quot;存款&quot; . $bankReturn . PHP_EOL;</span><br><span class=\"line\">//取款</span><br><span class=\"line\">$bankReturn = $bank-&gt;bankWithdraw(&quot;bankWithdraw&quot;);</span><br><span class=\"line\">echo &quot;取款&quot; . $bankReturn . PHP_EOL;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>工厂模式(1)</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">/**</span><br><span class=\"line\"> * 艾瑞可erik</span><br><span class=\"line\"> * https://erik.xyz</span><br><span class=\"line\"> * 工厂模式</span><br><span class=\"line\"> */</span><br><span class=\"line\"></span><br><span class=\"line\"> /**</span><br><span class=\"line\">  * 支付接口</span><br><span class=\"line\">  */</span><br><span class=\"line\">interface PayErik&#123;</span><br><span class=\"line\">    public function payMethodErik();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class AlipayErik implements PayErik&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function payMethodErik()&#123;</span><br><span class=\"line\">        echo &#x27;支付宝支付&#x27;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class WxpayErik implements PayErik</span><br><span class=\"line\">&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function payMethodErik()&#123;</span><br><span class=\"line\">        echo &#x27;微信支付&#x27;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">/**</span><br><span class=\"line\"> * 支付工厂类</span><br><span class=\"line\"> */</span><br><span class=\"line\">class PayFactoryErik&#123;</span><br><span class=\"line\">    public static function factoryErik($class_name)&#123;</span><br><span class=\"line\">        return new $class_name();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$obj=PayFactoryErik::factoryErik(&#x27;alipayErik&#x27;);</span><br><span class=\"line\">$pay=$obj-&gt;PayMethodErik();</span><br><span class=\"line\">echo PHP_EOL;</span><br><span class=\"line\">print_r($pay);</span><br><span class=\"line\">echo PHP_EOL;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>工厂模式(2)</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">/**</span><br><span class=\"line\"> * 艾瑞可erik</span><br><span class=\"line\"> * https://erik.xyz</span><br><span class=\"line\"> * 工厂模式</span><br><span class=\"line\"> */</span><br><span class=\"line\"></span><br><span class=\"line\"> /**</span><br><span class=\"line\">  * 支付接口</span><br><span class=\"line\">  */</span><br><span class=\"line\">interface PayErik&#123;</span><br><span class=\"line\">    public function payMethodErik();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class AlipayErik implements PayErik&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function load()&#123;</span><br><span class=\"line\">        return new alipayErik();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public function payMethodErik()&#123;</span><br><span class=\"line\">        echo &#x27;支付宝支付&#x27;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class WxpayErik implements PayErik</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public function load()&#123;</span><br><span class=\"line\">        return new wxpayErik();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    public function payMethodErik()&#123;</span><br><span class=\"line\">        echo &#x27;微信支付&#x27;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">$alipayErik=AlipayErik::load();</span><br><span class=\"line\">$payErik=$alipayErik-&gt;payMethodErik();</span><br><span class=\"line\">echo PHP_EOL;</span><br><span class=\"line\">print_r($payErik);</span><br><span class=\"line\">unset($alipayErik);</span><br><span class=\"line\">echo PHP_EOL;</span><br><span class=\"line\"></span><br><span class=\"line\">$wxpayErik=WxpayErik::load();</span><br><span class=\"line\">$payEriks=$wxpayErik-&gt;payMethodErik();</span><br><span class=\"line\">echo PHP_EOL;</span><br><span class=\"line\">print_r($payEriks);</span><br><span class=\"line\">unset($payEriks);</span><br><span class=\"line\">echo PHP_EOL;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>观察者模式</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">/**</span><br><span class=\"line\"> *艾瑞可erik</span><br><span class=\"line\"> *https://erik.xyz</span><br><span class=\"line\"> * 观察者模式</span><br><span class=\"line\"> * Interface PayLoggerErik</span><br><span class=\"line\"> */</span><br><span class=\"line\">//支付日志</span><br><span class=\"line\">interface PayLoggerErik</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public function onChangeErik($sender, $args);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">//支付选择</span><br><span class=\"line\">interface PayTypeErik</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public function addObserverErik($observer);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class PayListErik implements PayTypeErik</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    private $observers = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    public function load()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new PayListErik();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function addCustomerErik($method, $name)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        if (empty($method)) &#123;     </span><br><span class=\"line\">            return false;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        foreach ($this-&gt;observers as $obs) &#123;</span><br><span class=\"line\">            $obs-&gt;$method($this, $name);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function addObserverErik($observer)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;observers[] = $observer;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">/**  日志记录</span><br><span class=\"line\"> * Class PayListLoggerErik</span><br><span class=\"line\"> */</span><br><span class=\"line\">class PayListLoggerErik implements PayLoggerErik</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public function load()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new PayListLoggerErik();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function onChangeErik($sender, $args)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo &quot;选择成功！&quot; . $args . PHP_EOL;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function setLoggerErik($sender, $args)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        echo &quot;设置成功了！&quot; . $args. PHP_EOL;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$payList = PayListErik::load();</span><br><span class=\"line\">$payList-&gt;addObserverErik(PayListLoggerErik::load());</span><br><span class=\"line\">$payList-&gt;addCustomerErik(&#x27;onChangeErik&#x27;, &quot;艾瑞可erik(https://erik.xyz),新增日志记录引入&quot;);</span><br><span class=\"line\">$data = $payList-&gt;addCustomerErik(&#x27;setLoggerErik&#x27;, &quot;艾瑞可erik(https://erik.xyz)&quot;);</span><br></pre></td></tr></table></figure>\n<ul>\n<li>单例模式</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">/**</span><br><span class=\"line\"> * 艾瑞可erik</span><br><span class=\"line\"> * https://erik.xyz</span><br><span class=\"line\"> * </span><br><span class=\"line\"> * 单例模式</span><br><span class=\"line\"> */</span><br><span class=\"line\">class SingleErik</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">   private $props=[];</span><br><span class=\"line\">   private static $instanceErik;</span><br><span class=\"line\">   final private function __construct()&#123;&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   //单例方法</span><br><span class=\"line\">   public static function getInstanceErik()&#123;</span><br><span class=\"line\">      if(empty(self::$instanceErik))&#123;</span><br><span class=\"line\">         self::$instanceErik=new SingleErik();</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      return self::$instanceErik;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\">   </span><br><span class=\"line\">   //单例定义方法</span><br><span class=\"line\">   public function setPropertyErik($key,$val)&#123;</span><br><span class=\"line\">      $this-&gt;props[$key]=$val;</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   public function getPropertyErik($key)&#123;</span><br><span class=\"line\">      return $this-&gt;props[$key];</span><br><span class=\"line\">   &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">   final protected function __clone()&#123;&#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$perf=singleErik::getInstanceErik();</span><br><span class=\"line\">$perf-&gt;setPropertyErik(&quot;blog&quot;,[&quot;title&quot;=&gt;&quot;艾瑞可erik&quot;,&quot;url&quot;=&gt;&quot;https://erik.xyz&quot;]);</span><br><span class=\"line\">$getData=$perf-&gt;getPropertyErik(&quot;blog&quot;);</span><br><span class=\"line\">print_r($getData);</span><br><span class=\"line\">//销毁引用，释放空间</span><br><span class=\"line\">unset($perf);</span><br></pre></td></tr></table></figure>\n<ul>\n<li>策略模式</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">/**</span><br><span class=\"line\"> * 艾瑞可erik</span><br><span class=\"line\"> * https://erik.xyz</span><br><span class=\"line\"> * Interface IStrategy</span><br><span class=\"line\"> * 策略模式</span><br><span class=\"line\"> */</span><br><span class=\"line\"></span><br><span class=\"line\">interface IStrategyErik</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    function filter($record);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class FindAfterStrategyErik implements IStrategyErik</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    private $_name;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function __construct($name)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;_name = $name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static function load($name)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new FindAfterStrategyErik($name);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function filter($record)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return strcmp($this-&gt;_name, $record) &lt;= 0;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class RandomStrategyErik implements IStrategyErik</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    public static function load()</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new RandomStrategyErik();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function filter($record)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return rand(0, 1) &gt;= 0.5;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class UserListErik</span><br><span class=\"line\">&#123;</span><br><span class=\"line\">    private $_list = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    public static function load($arr = [])</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        return new UserListErik($arr);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function __construct($names)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        if ($names != null) &#123;</span><br><span class=\"line\">            foreach ($names as $name) &#123;</span><br><span class=\"line\">                $this-&gt;_list[] = $name;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function add($name)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\">        $this-&gt;_list[] = $name;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function find($filter)</span><br><span class=\"line\">    &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        $recs = [];</span><br><span class=\"line\">        foreach ($this-&gt;_list as $user) &#123;</span><br><span class=\"line\">            if ($filter-&gt;filter($user)) &#123;</span><br><span class=\"line\">                $recs[] = $user;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        return $recs;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$ul = UserListErik::load([&quot;Andy&quot;, &quot;Jack&quot;, &quot;Lori&quot;, &quot;Megan&quot;]);</span><br><span class=\"line\">$f1 = $ul-&gt;find(FindAfterStrategyErik::load(&quot;J&quot;));</span><br><span class=\"line\">print_r($f1);</span><br><span class=\"line\"></span><br><span class=\"line\">$f2 = $ul-&gt;find(RandomStrategyErik::load());</span><br><span class=\"line\">print_r($f2);</span><br></pre></td></tr></table></figure>\n<p>参考资料：</p>\n<p><a href=\"https://www.ibm.com/developerworks/cn/opensource/os-php-designpatterns/?mhsrc=ibmsearch_a&amp;mhq=php%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F\">另外五个 PHP 设计模式</a></p>\n<p><a href=\"https://www.kancloud.cn/digest/php-src/136249\">PHPer进阶</a></p>\n",
            "tags": [
                "php",
                "php设计模式"
            ]
        }
    ]
}