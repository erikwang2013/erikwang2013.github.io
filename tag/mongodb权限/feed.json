{
    "version": "https://jsonfeed.org/version/1",
    "title": "艾瑞可erik • All posts by \"mongodb权限\" tag • All posts by \"undefined\" categories",
    "description": "一只PHP开发的程序猿，偶尔做做运维、Goland、Python、Java、摄影、画画、写作、顺便睡觉，反正整站都搞过。",
    "home_page_url": "https://erik.xyz",
    "items": [
        {
            "id": "https://erik.xyz/2020/06/20/mongodb-user-rbc/",
            "url": "https://erik.xyz/2020/06/20/mongodb-user-rbc/",
            "title": "MongoDB权限说明",
            "date_published": "2020-06-20T07:31:00.000Z",
            "content_html": "<p>权限误区  并不是说下面的排序就证明权限越来越大除了readWrite权限用户外(root权限用户也包括)，其它用户都不具备对数据库的写入权限，除 read 权限外，其它用户都不具备对数据库中的读权限，每个权限的功能各不一样(除root外)</p>\n<span id=\"more\"></span>\n<h4 id=\"普通用户\"><a href=\"#普通用户\" class=\"headerlink\" title=\"普通用户\"></a>普通用户</h4><p>普通用户只是拥有下面的读写权限</p>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th>权限</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Read</td>\n<td>允许用户读取指定数据库</td>\n</tr>\n<tr>\n<td>readWrite</td>\n<td>允许用户读写指定数据库</td>\n</tr>\n</tbody>\n</table>\n</div>\n<h4 id=\"管理用户\"><a href=\"#管理用户\" class=\"headerlink\" title=\"管理用户\"></a>管理用户</h4><p>管理用户具备下面说明的一些操作权限</p>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th>权限</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>dbAdmin</td>\n<td>允许用户在指定数据库中指定管理函数，如(索引创建、删除、查看统计访问system.profile)</td>\n</tr>\n<tr>\n<td>userAdmin</td>\n<td>允许用户向system.users集合写入，可以找指定数据里面创建、删除和管理用户</td>\n</tr>\n<tr>\n<td>clusterAdmin</td>\n<td>只在admin数据库中可用，赋予用户所有分片和复制集相关函数的管理权限</td>\n</tr>\n</tbody>\n</table>\n</div>\n<h4 id=\"授权用户\"><a href=\"#授权用户\" class=\"headerlink\" title=\"授权用户\"></a>授权用户</h4><p>以下用户主要是为其它用户赋予相应的权限</p>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th>权限</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>readAnyDatabase</td>\n<td>只在admin数据库中可用，赋予用户所有数据库的读权限</td>\n</tr>\n<tr>\n<td>readWriteAnyDatabase</td>\n<td>只在admin数据库中可用，赋予用户所有数据库的读写权限</td>\n</tr>\n<tr>\n<td>userWriteAnyDatabase</td>\n<td>只在admin数据库中可用，赋予用户所有数据库的userAdmin权限</td>\n</tr>\n<tr>\n<td>dbAdminAnyDatabase</td>\n<td>只在admin数据库中可用，赋予用户所有数据库的dbAdmin权限</td>\n</tr>\n</tbody>\n</table>\n</div>\n<h4 id=\"超级管理员\"><a href=\"#超级管理员\" class=\"headerlink\" title=\"超级管理员\"></a>超级管理员</h4><p>可以无所不能，为所欲为</p>\n<div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th>权限</th>\n<th>说明</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>root</td>\n<td>只在admin数据库中可用，超级管理员</td>\n</tr>\n<tr>\n<td>mongodb</td>\n<td>安装好后第一次进入是不需要密码的，也没有任何用户，直接连接进入即可</td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>/usr/local/mongodb/bin/mongo —host 192.168.31.215 —port 27018</p>\n<h4 id=\"创建管理用户\"><a href=\"#创建管理用户\" class=\"headerlink\" title=\"创建管理用户\"></a>创建管理用户</h4><pre><code>    &gt; use admin\n    switched to db admin\n    &gt; db.createUser ( &#123;\n       user: &quot;manage&quot;,\n       pwd: &quot;123456&quot;,\n       roles: [ &#123; role: &quot;root&quot;, db: &quot;admin&quot; &#125; ]\n       &#125;\n    )\n\n    #返回以下信息代表创建成功\n    Successfully added user: &#123;\n        &quot;user&quot;: &quot;manage&quot;,\n        &quot;roles&quot;: [\n            &#123;\n                &quot;role&quot;: &quot;root&quot;,\n                &quot;db&quot;: &quot;admin&quot;\n            &#125;\n        ]\n    &#125;\n    退出登录，然后在mongodb配置文件中开启认证\n\n    vim /usr/local/mongodb/27018/conf/mongod.conf\n    security: \n      authorization: enabled\n      javascriptEnabled: true\n    重启mongodb\n\n    /usr/local/mongodb/bin/mongod --shutdown -f /usr/local/mongodb/27018/conf/mongod.conf \n    /usr/local/mongodb/bin/mongod -f /usr/local/mongodb/27018/conf/mongod.conf\n    连接mongodb\n\n    /usr/local/mongodb/bin/mongo --host 192.168.31.215 --port 27018\n    MongoDB shell version v4.2.0\n    connecting to: mongodb: //192.168.31.215: 27018/?compressors=disabled&amp;gssapiServiceName=mongodb\n    Implicit session: session &#123; &quot;id&quot;: UUID(&quot;fc77266a-b2ff-4eb0-b6ca-c493c7c29143&quot;) &#125;\n    MongoDB server version: 4.2.0\n    &gt; use admin                     #进入admin库中先进行账号认证\n    switched to db admin        \n    &gt; db.auth(&#39;manage&#39;,&#39;123456&#39;)    #认证账号，值返回1代表认证成功1\n</code></pre><h4 id=\"mongdb库创建读写用户\"><a href=\"#mongdb库创建读写用户\" class=\"headerlink\" title=\"mongdb库创建读写用户\"></a>mongdb库创建读写用户</h4><pre><code>    &gt; db.createUser( &#123;\n    ... user: &quot;zhangsan&quot;,\n    ... pwd: &quot;zhangsan&quot;,\n    ... roles: [ &#123; role: &quot;readWrite&quot;, db: &quot;mongdb&quot; &#125; ]\n    ...     &#125;\n    ... )\n    Successfully added user: &#123;\n        &quot;user&quot;: &quot;zhangsan&quot;,\n        &quot;roles&quot;: [\n            &#123;\n                &quot;role&quot;: &quot;readWrite&quot;,\n                &quot;db&quot;: &quot;mongdb&quot;\n            &#125;\n        ]\n    &#125;\n    验证创建的zhangsan用户(不需要退出登录)\n\n    &gt; use admin\n    switched to db admin\n    &gt; db.auth(&#39;zhangsan&#39;,&#39;zhangsan&#39;)\n    1\n    &gt; show dbs              #查看数据库，因为mongdb数据库存储数据，所以看不到\n    &gt; use mongdb            #直接 use 到mongdb数据库中\n    switched to db mongdb\n\n    #插入 json 格式文档到 coll 集合中\n    &gt; db.coll.insert(&#123;&quot;name&quot;: &quot;Zhangsan&quot;,&quot;url&quot;: &quot;http: //abcops.cn&quot;,&quot;age&quot;: 25,&quot;isNonProfit&quot;: true,&#125;)\n    WriteResult(&#123; &quot;nInserted&quot;: 1 &#125;)\n    &gt; show collections      #查看已存在集合\n    coll\n    &gt; db.coll.find()        #读取集合中的数据\n    &#123; &quot;_id&quot;: ObjectId(&quot;5d8b24c2f1c33f4950f2c5df&quot;), &quot;name&quot;: &quot;Zhangsan&quot;, &quot;url&quot;: &quot;http: //abcops.cn&quot;, &quot;age&quot;: 25, &quot;isNonProfit&quot;: true &#125;\n    以上完成了读写权限的验证\n\n    一个用户多个权限\n\n    为 lisi 用户授权 01db read权限 02db readWrite 03db dbAdmin权限 04db userAdmin权限\n    这次先把数据库创建出来\n\n    &gt; use admin\n    switched to db admin\n    &gt; db.auth(&#39;manage&#39;,&#39;123456&#39;)\n    1\n\n    &gt; use 01db\n    switched to db 01db\n    &gt; db.coll.insert(&#123;&quot;name&quot;: &quot;01db&quot;,&quot;url&quot;: &quot;http: //abcops.cn&quot;,&quot;age&quot;: 25,&quot;isNonProfit&quot;: true,&#125;)\n    WriteResult(&#123; &quot;nInserted&quot;: 1 &#125;)\n\n    &gt; use 02db\n    switched to db 02db\n    &gt; db.coll.insert(&#123;&quot;name&quot;: &quot;02db&quot;,&quot;url&quot;: &quot;http: //abcops.cn&quot;,&quot;age&quot;: 25,&quot;isNonProfit&quot;: true,&#125;)\n    WriteResult(&#123; &quot;nInserted&quot;: 1 &#125;)\n\n    &gt; use 03db\n    switched to db 03db\n    &gt; db.coll.insert(&#123;&quot;name&quot;: &quot;03db&quot;,&quot;url&quot;: &quot;http: //abcops.cn&quot;,&quot;age&quot;: 25,&quot;isNonProfit&quot;: true,&#125;)\n    WriteResult(&#123; &quot;nInserted&quot;: 1 &#125;)\n\n    &gt; use 04db\n    switched to db 04db\n    &gt; db.coll.insert(&#123;&quot;name&quot;: &quot;04db&quot;,&quot;url&quot;: &quot;http: //abcops.cn&quot;,&quot;age&quot;: 25,&quot;isNonProfit&quot;: true,&#125;)\n    WriteResult(&#123; &quot;nInserted&quot;: 1 &#125;)\n</code></pre><h4 id=\"创建用户并授权\"><a href=\"#创建用户并授权\" class=\"headerlink\" title=\"创建用户并授权\"></a>创建用户并授权</h4><pre><code>    &gt; db.createUser( &#123;\n    ... user: &quot;lisi&quot;,\n    ... pwd: &quot;123456&quot;,\n    ... roles: [ &#123; role: &quot;read&quot;,db: &quot;01db&quot; &#125;,\n    ... &#123; role: &quot;readWrite&quot;,db: &quot;02db&quot; &#125;,\n    ... &#123; role: &quot;dbAdmin&quot;,db: &quot;03db&quot; &#125;,\n    ... &#123; role: &quot;userAdmin&quot;,db: &quot;04db&quot; &#125; ]\n    ...     &#125;\n    ... )\n    Successfully added user: &#123;\n        &quot;user&quot;: &quot;lisi&quot;,\n        &quot;roles&quot;: [\n            &#123;\n                &quot;role&quot;: &quot;read&quot;,\n                &quot;db&quot;: &quot;01db&quot;\n            &#125;,\n            &#123;\n                &quot;role&quot;: &quot;readWrite&quot;,\n                &quot;db&quot;: &quot;02db&quot;\n            &#125;,\n            &#123;\n                &quot;role&quot;: &quot;dbAdmin&quot;,\n                &quot;db&quot;: &quot;03db&quot;\n            &#125;,\n            &#123;\n                &quot;role&quot;: &quot;userAdmin&quot;,\n                &quot;db&quot;: &quot;04db&quot;\n            &#125;\n        ]\n    &#125;\n</code></pre><h4 id=\"查看所有用户\"><a href=\"#查看所有用户\" class=\"headerlink\" title=\"查看所有用户\"></a>查看所有用户</h4><pre><code>    &gt; show users\n    &#123;\n        &quot;_id&quot;: &quot;admin.admin&quot;,\n        &quot;userId&quot;: UUID(&quot;9958faa5-7132-4146-8775-a001e47fe7f8&quot;),\n        &quot;user&quot;: &quot;admin&quot;,\n        &quot;db&quot;: &quot;admin&quot;,\n        &quot;roles&quot;: [\n            &#123;\n                &quot;role&quot;: &quot;root&quot;,\n                &quot;db&quot;: &quot;admin&quot;\n            &#125;\n        ],\n        &quot;mechanisms&quot;: [\n            &quot;SCRAM-SHA-1&quot;\n        ]\n    &#125;\n    &#123;\n        &quot;_id&quot;: &quot;admin.lisi&quot;,\n        &quot;userId&quot;: UUID(&quot;bc8e5dc7-2f8c-40c1-8190-cea4951ae4a1&quot;),\n        &quot;user&quot;: &quot;lisi&quot;,\n        &quot;db&quot;: &quot;admin&quot;,\n        &quot;roles&quot;: [\n            &#123;\n                &quot;role&quot;: &quot;read&quot;,\n                &quot;db&quot;: &quot;01db&quot;\n            &#125;,\n            &#123;\n                &quot;role&quot;: &quot;readWrite&quot;,\n                &quot;db&quot;: &quot;02db&quot;\n            &#125;,\n            &#123;\n                &quot;role&quot;: &quot;dbAdmin&quot;,\n                &quot;db&quot;: &quot;03db&quot;\n            &#125;,\n            &#123;\n                &quot;role&quot;: &quot;userAdmin&quot;,\n                &quot;db&quot;: &quot;04db&quot;\n            &#125;\n        ],\n        &quot;mechanisms&quot;: [\n            &quot;SCRAM-SHA-1&quot;\n        ]\n    &#125;\n    &#123;\n        &quot;_id&quot;: &quot;admin.manage&quot;,\n        &quot;userId&quot;: UUID(&quot;e1b34f57-06f2-4ef1-b23a-2d46a3964fbf&quot;),\n        &quot;user&quot;: &quot;manage&quot;,\n        &quot;db&quot;: &quot;admin&quot;,\n        &quot;roles&quot;: [\n            &#123;\n                &quot;role&quot;: &quot;root&quot;,\n                &quot;db&quot;: &quot;admin&quot;\n            &#125;\n        ],\n        &quot;mechanisms&quot;: [\n            &quot;SCRAM-SHA-1&quot;\n        ]\n    &#125;\n    &#123;\n        &quot;_id&quot;: &quot;admin.micvs&quot;,\n        &quot;userId&quot;: UUID(&quot;1f4837c7-8c14-40d4-8a21-d621e0bcc278&quot;),\n        &quot;user&quot;: &quot;micvs&quot;,\n        &quot;db&quot;: &quot;admin&quot;,\n        &quot;roles&quot;: [\n            &#123;\n                &quot;role&quot;: &quot;dbAdminAnyDatabase&quot;,\n                &quot;db&quot;: &quot;admin&quot;\n            &#125;\n        ],\n        &quot;mechanisms&quot;: [\n            &quot;SCRAM-SHA-1&quot;,\n            &quot;SCRAM-SHA-256&quot;\n        ]\n    &#125;\n    &#123;\n        &quot;_id&quot;: &quot;admin.zhangsan&quot;,\n        &quot;userId&quot;: UUID(&quot;1003726b-c7fc-44e6-b001-b5c828bfb40d&quot;),\n        &quot;user&quot;: &quot;zhangsan&quot;,\n        &quot;db&quot;: &quot;admin&quot;,\n        &quot;roles&quot;: [\n            &#123;\n                &quot;role&quot;: &quot;readWrite&quot;,\n                &quot;db&quot;: &quot;mongdb&quot;\n            &#125;\n        ],\n        &quot;mechanisms&quot;: [\n            &quot;SCRAM-SHA-1&quot;\n        ]\n    &#125;\n</code></pre><p>原创地址:<a href=\"https://mp.weixin.qq.com/s/YWcwaPIQDP6ln_6qtvnsOA\">https://mp.weixin.qq.com/s/YWcwaPIQDP6ln_6qtvnsOA</a></p>\n",
            "tags": [
                "mongodb",
                "mongodb权限"
            ]
        }
    ]
}