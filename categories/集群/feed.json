{
    "version": "https://jsonfeed.org/version/1",
    "title": "艾瑞可erik • All posts by \"集群\" categories",
    "description": "一只PHP开发的程序猿，偶尔做做运维、Goland、Python、Java、摄影、画画、写作、顺便睡觉，反正整站都搞过。",
    "home_page_url": "https://erik.xyz",
    "items": [
        {
            "id": "https://erik.xyz/2019/09/10/hadoop2-8-and-3-1-change-version/",
            "url": "https://erik.xyz/2019/09/10/hadoop2-8-and-3-1-change-version/",
            "title": "hadoop2.8和3.1版本配置变化",
            "date_published": "2019-09-10T02:22:00.000Z",
            "content_html": "<p>新版hadoop3.1相较于老版hadoop2.8在配置文件这块有了变化。</p>\n<p>这个是我早些时候配置的</p>\n<p><a href=\"https://jingyan.baidu.com/article/2d5afd69d5969585a2e28eaf.html\">hadoop2.8安装教程</a></p>\n<p>在hadoop2.8中配置java路径和项目路径统一在/path/etc/hadoop/yarn-env.sh中。而hadoop3.1中则是在hadoop-env.sh中开启配置</p>\n<p>原来slaves的节点配置改成works文件。</p>\n<p>昨晚一不留神掉坑里了。这里附上配置。<span id=\"more\"></span><br>java版本：1.8.221<br>用户hadoop<br>hadoop放置在/opt/目录下</p>\n<ul>\n<li><h5 id=\"core-site-xml配置\"><a href=\"#core-site-xml配置\" class=\"headerlink\" title=\"core-site.xml配置\"></a>core-site.xml配置</h5><pre><code>  &lt;configuration&gt;\n    &lt;property&gt;\n        &lt;name&gt;fs.defaultFS&lt;/name&gt;\n        &lt;value&gt;hdfs://ec1069fcab62&lt;/value&gt;\n    &lt;/property&gt;\n      &lt;property&gt;\n            &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;\n            &lt;value&gt;file:/home/hadoop/tmp&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property&gt;\n            &lt;name&gt;io.file.buffer.size&lt;/name&gt;\n            &lt;value&gt;131702&lt;/value&gt;\n    &lt;/property&gt;\n    &lt;property&gt;\n            &lt;name&gt;hadoop.proxyuser.hadoop.hosts&lt;/name&gt;\n            &lt;value&gt;*&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property&gt;\n            &lt;name&gt;hadoop.proxyuser.hadoop.groups&lt;/name&gt;\n            &lt;value&gt;*&lt;/value&gt;\n        &lt;/property&gt;\n  &lt;/configuration&gt;\n</code></pre><p><br /></p>\n</li>\n<li><h5 id=\"hadoop-env-sh配置\"><a href=\"#hadoop-env-sh配置\" class=\"headerlink\" title=\"hadoop-env.sh配置\"></a>hadoop-env.sh配置</h5></li>\n</ul>\n<pre><code>   export JAVA_HOME=/usr/local/java/jdk1.8.0_221\n\n\n   export HADOOP_HOME=/opt/hadoop\n\n\n   export HADOOP_CONF_DIR=$&#123;HADOOP_HOME&#125;/etc/hadoop\n\n\n   export HADOOP_HEAPSIZE_MAX=1024m\n\n\n   export HADOOP_HEAPSIZE_MIN=512m\n\n\n  # export HADOOP_JAAS_DEBUG=true\n\n\n  # export HADOOP_OPTS=&quot;-Djava.net.preferIPv4Stack=true&quot;\n\n  # export HADOOP_OPTS=&quot;-Djava.net.preferIPv4Stack=true -Dsun.security.krb5.debug=true -Dsun.security.spnego.debug&quot;\n\n\n  export HADOOP_OS_TYPE=$&#123;HADOOP_OS_TYPE:-$(uname -s)&#125;\n\n\n  # export HADOOP_CLIENT_OPTS=&quot;&quot;\n\n\n  # export HADOOP_CLASSPATH=&quot;/some/cool/path/on/your/machine&quot;\n\n\n  # export HADOOP_USER_CLASSPATH_FIRST=&quot;yes&quot;\n\n\n  # export HADOOP_USE_CLIENT_CLASSLOADER=true\n\n\n  # export HADOOP_CLIENT_CLASSLOADER_SYSTEM_CLASSES=&quot;-org.apache.hadoop.UserClass,java.,javax.,org.apache.hadoop.&quot;\n\n\n  # export HADOOP_OPTIONAL_TOOLS=&quot;hadoop-aliyun,hadoop-aws,hadoop-azure-datalake,hadoop-azure,hadoop-kafka,hadoop-openstack&quot;\n\n\n  # export HADOOP_SSH_OPTS=&quot;-o BatchMode=yes -o StrictHostKeyChecking=no -o ConnectTimeout=10s&quot;\n\n\n  # export HADOOP_SSH_PARALLEL=10\n\n\n  # export HADOOP_WORKERS=&quot;$&#123;HADOOP_CONF_DIR&#125;/workers&quot;\n\n\n   export HADOOP_LOG_DIR=$&#123;HADOOP_HOME&#125;/logs\n\n\n   export HADOOP_IDENT_STRING=$USER\n\n\n  # export HADOOP_STOP_TIMEOUT=5\n\n\n   export HADOOP_PID_DIR=/home/hadoop/tmp\n\n\n   export HADOOP_ROOT_LOGGER=INFO,console\n\n\n   export HADOOP_DAEMON_ROOT_LOGGER=INFO,RFA\n\n\n  # export HADOOP_SECURITY_LOGGER=INFO,NullAppender\n\n\n  # export HADOOP_NICENESS=0\n\n\n  # export HADOOP_POLICYFILE=&quot;hadoop-policy.xml&quot;\n\n\n  # export HADOOP_GC_SETTINGS=&quot;-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintGCDateStamps&quot;\n\n  # export JSVC_HOME=/usr/bin\n\n\n  #export HADOOP_SECURE_PID_DIR=$&#123;HADOOP_PID_DIR&#125;\n\n\n   export HADOOP_SECURE_LOG=$&#123;HADOOP_LOG_DIR&#125;\n\n\n  # export HADOOP_SECURE_IDENT_PRESERVE=&quot;true&quot;\n\n\n   export HDFS_AUDIT_LOGGER=INFO,NullAppender\n\n\n  # a) Set JMX options\n  # export HDFS_NAMENODE_OPTS=&quot;-Dcom.sun.management.jmxremote=true -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.port=1026&quot;\n  #\n  # b) Set garbage collection logs\n   export HDFS_NAMENODE_OPTS=&quot;$&#123;HADOOP_GC_SETTINGS&#125; -Xloggc:$&#123;HADOOP_LOG_DIR&#125;/gc-rm.log-$(date +&#39;%Y%m%d%H%M&#39;)&quot;\n  #\n  # c) ... or set them directly\n  # export HDFS_NAMENODE_OPTS=&quot;-verbose:gc -XX:+PrintGCDetails -XX:+PrintGCTimeStamps -XX:+PrintGCDateStamps -Xloggc:$&#123;HADOOP_LOG_DIR&#125;/gc-rm.log-$(date +&#39;%Y%m%d%H%M&#39;)&quot;\n\n  # this is the default:\n  # export HDFS_NAMENODE_OPTS=&quot;-Dhadoop.security.logger=INFO,RFAS&quot;\n\n\n  # export HDFS_SECONDARYNAMENODE_OPTS=&quot;-Dhadoop.security.logger=INFO,RFAS&quot;\n\n\n   export HDFS_DATANODE_OPTS=&quot;-Dhadoop.security.logger=ERROR,RFAS&quot;\n\n\n  # export HDFS_DATANODE_SECURE_USER=hdfs\n\n  # Supplemental options for secure datanodes\n  # By default, Hadoop uses jsvc which needs to know to launch a\n  # server jvm.\n   export HDFS_DATANODE_SECURE_EXTRA_OPTS=&quot;-jvm server&quot;\n\n\n  # export HDFS_NFS3_OPTS=&quot;&quot;\n\n\n  # export HDFS_PORTMAP_OPTS=&quot;-Xmx512m&quot;\n\n\n  # export HDFS_NFS3_SECURE_EXTRA_OPTS=&quot;-jvm server&quot;\n\n  # On privileged gateways, user to run the gateway as after dropping privileges\n  # This will replace the hadoop.id.str Java property in secure mode.\n  # export HDFS_NFS3_SECURE_USER=nfsserver\n\n  ###\n\n  # export HDFS_ZKFC_OPTS=&quot;&quot;\n\n\n  # export HDFS_JOURNALNODE_OPTS=&quot;&quot;\n\n\n  # export HDFS_BALANCER_OPTS=&quot;&quot;\n\n\n  # export HDFS_MOVER_OPTS=&quot;&quot;\n\n\n  # export HDFS_DFSROUTER_OPTS=&quot;&quot;\n  ###\n\n  # export HADOOP_ENABLE_BUILD_PATHS=&quot;true&quot;\n\n\n   export HDFS_NAMENODE_USER=hadoop\n</code></pre><p><br /></p>\n<ul>\n<li><h5 id=\"hdfs-site-xml配置\"><a href=\"#hdfs-site-xml配置\" class=\"headerlink\" title=\"hdfs-site.xml配置\"></a>hdfs-site.xml配置</h5></li>\n</ul>\n<pre><code>    &lt;configuration&gt;\n        &lt;property&gt;\n            &lt;name&gt;dfs.namenode.name.dir&lt;/name&gt;\n            &lt;value&gt;file:/home/hadoop/hdfs/name&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property&gt;\n            &lt;name&gt;dfs.datanode.data.dir&lt;/name&gt;\n            &lt;value&gt;file:/home/hadoop/hdfs/data&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property&gt;\n            &lt;name&gt;dfs.replication&lt;/name&gt;\n            &lt;value&gt;3&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property&gt;\n            &lt;name&gt;dfs.namenode.http-address&lt;/name&gt;\n            &lt;value&gt;ec1069fcab62:9070&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property&gt;\n            &lt;name&gt;dfs.namenode.secondary.http-address&lt;/name&gt;\n            &lt;value&gt;ec1069fcab62:9001&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property&gt;\n        &lt;name&gt;dfs.webhdfs.enabled&lt;/name&gt;\n        &lt;value&gt;true&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/configuration&gt;\n</code></pre><p><br /> </p>\n<ul>\n<li><h5 id=\"mapred-site-xml配置\"><a href=\"#mapred-site-xml配置\" class=\"headerlink\" title=\"mapred-site.xml配置\"></a>mapred-site.xml配置</h5></li>\n</ul>\n<pre><code>    &lt;configuration&gt;\n         &lt;property&gt;\n            &lt;name&gt;mapreduce.framework.name&lt;/name&gt;\n            &lt;value&gt;yarn&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property&gt;\n            &lt;name&gt;mapreduce.jobhistory.address&lt;/name&gt;\n            &lt;value&gt;ec1069fcab62:10020&lt;/value&gt;\n        &lt;/property&gt;\n        &lt;property&gt;\n            &lt;name&gt;mapreduce.jobhistory.webapp.address&lt;/name&gt;\n            &lt;value&gt;ec1069fcab62:19888&lt;/value&gt;\n        &lt;/property&gt;\n    &lt;/configuration&gt;\n</code></pre><p><br /></p>\n<ul>\n<li><h5 id=\"yarn-site-xml配置\"><a href=\"#yarn-site-xml配置\" class=\"headerlink\" title=\"yarn-site.xml配置\"></a>yarn-site.xml配置</h5><pre><code>  &lt;configuration&gt;\n\n  &lt;!-- Site specific YARN configuration properties --&gt;\n       &lt;property&gt;\n          &lt;name&gt;yarn.nodemanager.aux-services&lt;/name&gt;\n          &lt;value&gt;mapreduce_shuffle&lt;/value&gt;\n      &lt;/property&gt;\n      &lt;property&gt;\n          &lt;name&gt;yarn.nodemanager.auxservices.mapreduce.shuffle.class&lt;/name&gt;\n          &lt;value&gt;org.apache.hadoop.mapred.ShuffleHandler&lt;/value&gt;\n      &lt;/property&gt;\n      &lt;property&gt;\n          &lt;name&gt;yarn.resourcemanager.hostname&lt;/name&gt;\n          &lt;value&gt;ec1069fcab62&lt;/value&gt;\n      &lt;/property&gt;\n          &lt;property&gt;\n          &lt;name&gt;yarn.resourcemanager.address&lt;/name&gt;\n          &lt;value&gt;ec1069fcab62:8032&lt;/value&gt;\n      &lt;/property&gt;\n      &lt;property&gt;\n          &lt;name&gt;yarn.resourcemanager.scheduler.address&lt;/name&gt;\n          &lt;value&gt;ec1069fcab62:8030&lt;/value&gt;\n      &lt;/property&gt;\n      &lt;property&gt;\n          &lt;name&gt;yarn.resourcemanager.resource-tracker.address&lt;/name&gt;\n          &lt;value&gt;ec1069fcab62:8031&lt;/value&gt;\n      &lt;/property&gt;\n      &lt;property&gt;\n          &lt;name&gt;yarn.resourcemanager.admin.address&lt;/name&gt;\n          &lt;value&gt;ec1069fcab62:8033&lt;/value&gt;\n      &lt;/property&gt;\n      &lt;property&gt;\n          &lt;name&gt;yarn.resourcemanager.webapp.address&lt;/name&gt;\n          &lt;value&gt;ec1069fcab62:8088&lt;/value&gt;\n      &lt;/property&gt;\n      &lt;property&gt;\n          &lt;name&gt;yarn.nodemanager.resource.memory-mb&lt;/name&gt;\n          &lt;value&gt;6078&lt;/value&gt;\n      &lt;/property&gt;\n  &lt;/configuration&gt;\n</code></pre></li>\n</ul>\n<ul>\n<li><h5 id=\"yarn-env-sh配置\"><a href=\"#yarn-env-sh配置\" class=\"headerlink\" title=\"yarn-env.sh配置\"></a>yarn-env.sh配置</h5><pre><code>export YARN_RESOURCE_MANAGER_OPTS=&quot;$&#123;HADOOP_GC_SETTINGS&#125; -Xloggc:$&#123;HADOOP_LOG_DIR&#125;/gc-rm.log-$(date +&#39;%Y%m%d%H%M&#39;)&quot;\n\n export YARN_REGISTRYDNS_SECURE_USER=yarn\n</code></pre></li>\n</ul>\n",
            "tags": [
                "hadoop3",
                "hadoop配置"
            ]
        }
    ]
}