{
    "version": "https://jsonfeed.org/version/1",
    "title": "è‰¾ç‘å¯erik â€¢ All posts by \"undefined\" categories",
    "description": "ä¸€åªPHPå¼€å‘çš„ç¨‹åºçŒ¿ï¼Œå¶å°”åšåšè¿ç»´ã€Golandã€Pythonã€Javaã€æ‘„å½±ã€ç”»ç”»ã€å†™ä½œã€é¡ºä¾¿ç¡è§‰ï¼Œåæ­£æ•´ç«™éƒ½æè¿‡ã€‚",
    "home_page_url": "https://erik.xyz",
    "items": [
        {
            "id": "https://erik.xyz/2025/07/11/plc-concepts-application-scenarios/",
            "url": "https://erik.xyz/2025/07/11/plc-concepts-application-scenarios/",
            "title": "PLCåŸºç¡€æ¦‚å¿µä¸åº”ç”¨åœºæ™¯è¯¦è§£",
            "date_published": "2025-07-11T14:12:00.000Z",
            "content_html": "<p>è‡ªå­¦PLCæ˜¯å®Œå…¨å¯è¡Œçš„ï¼å…³é”®åœ¨äº<strong>ç³»ç»ŸåŒ–çš„å­¦ä¹ è·¯å¾„+åŠ¨æ‰‹å®è·µ</strong>ã€‚ä»¥ä¸‹æ˜¯ä¸ºä½ æ•´ç†çš„ <strong>ã€Œé›¶åŸºç¡€è‡ªå­¦PLCå…¨æ”»ç•¥ã€</strong>ï¼Œç»“åˆå¤šå¹´å·¥ä¸šè‡ªåŠ¨åŒ–ç»éªŒæ€»ç»“ï¼Œå¸®ä½ å°‘èµ°å¼¯è·¯ï¼š</p>\n<hr>\n<h2 id=\"ä¸€ã€è‡ªå­¦å¿…å¤‡åŸºç¡€å‡†å¤‡\"><a href=\"#ä¸€ã€è‡ªå­¦å¿…å¤‡åŸºç¡€å‡†å¤‡\" class=\"headerlink\" title=\"ä¸€ã€è‡ªå­¦å¿…å¤‡åŸºç¡€å‡†å¤‡\"></a><strong>ä¸€ã€è‡ªå­¦å¿…å¤‡åŸºç¡€å‡†å¤‡</strong></h2><ol>\n<li><strong>ç”µå·¥çŸ¥è¯†</strong>ï¼ˆå¿…é¡»æŒæ¡ï¼‰  <ul>\n<li>çœ‹æ‡‚ç”µè·¯å›¾ã€ç»§ç”µå™¨æ§åˆ¶åŸç†ï¼ˆå¯ä¿åœ/æ­£åè½¬ï¼‰</li>\n<li>äº†è§£ä¼ æ„Ÿå™¨ï¼ˆNPN/PNPæ¥çº¿ï¼‰ã€æ¥è§¦å™¨ã€å¼€å…³ç”µæºç­‰å…ƒä»¶</li>\n</ul>\n</li>\n<li><strong>è®¡ç®—æœºæ“ä½œ</strong>  <ul>\n<li>æ–‡ä»¶ç®¡ç†ã€è½¯ä»¶å®‰è£…ã€åŸºç¡€è°ƒè¯•èƒ½åŠ›</li>\n</ul>\n</li>\n<li><strong>é€»è¾‘æ€ç»´èƒ½åŠ›</strong>  <ul>\n<li>èƒ½åˆ†æâ€œIFâ€¦THENâ€¦â€æ¡ä»¶é€»è¾‘</li>\n</ul>\n</li>\n</ol>\n<blockquote>\n<p>ğŸ’¡ <strong>é‡è¦æç¤º</strong>ï¼šè‹¥ç”µå·¥åŸºç¡€è–„å¼±ï¼Œå…ˆå­¦ä¹  <strong>ã€Šç”µå·¥ä¸Šå²—è¯ã€‹</strong> å†…å®¹ï¼ˆæ¨èbç«™â€œç”µå·¥å¤§å´â€ç³»åˆ—è§†é¢‘ï¼‰</p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><span id=\"more\"></span></h2></blockquote>\n<h2 id=\"ğŸ“š-äºŒã€åˆ†é˜¶æ®µå­¦ä¹ è·¯çº¿ï¼ˆé™„èµ„æºï¼‰\"><a href=\"#ğŸ“š-äºŒã€åˆ†é˜¶æ®µå­¦ä¹ è·¯çº¿ï¼ˆé™„èµ„æºï¼‰\" class=\"headerlink\" title=\"ğŸ“š äºŒã€åˆ†é˜¶æ®µå­¦ä¹ è·¯çº¿ï¼ˆé™„èµ„æºï¼‰\"></a>ğŸ“š <strong>äºŒã€åˆ†é˜¶æ®µå­¦ä¹ è·¯çº¿ï¼ˆé™„èµ„æºï¼‰</strong></h2><h3 id=\"â–¶-é˜¶æ®µ1ï¼šPLCæ ¸å¿ƒæ¦‚å¿µç­‘åŸºï¼ˆ1-2å‘¨ï¼‰\"><a href=\"#â–¶-é˜¶æ®µ1ï¼šPLCæ ¸å¿ƒæ¦‚å¿µç­‘åŸºï¼ˆ1-2å‘¨ï¼‰\" class=\"headerlink\" title=\"â–¶ é˜¶æ®µ1ï¼šPLCæ ¸å¿ƒæ¦‚å¿µç­‘åŸºï¼ˆ1-2å‘¨ï¼‰\"></a>â–¶ <strong>é˜¶æ®µ1ï¼šPLCæ ¸å¿ƒæ¦‚å¿µç­‘åŸºï¼ˆ1-2å‘¨ï¼‰</strong></h3><ul>\n<li><strong>å­¦ä¹ é‡ç‚¹</strong>ï¼š<ul>\n<li>PLCå·¥ä½œåŸç†ï¼ˆè¾“å…¥-å¤„ç†-è¾“å‡ºå¾ªç¯ï¼‰</li>\n<li>ç¡¬ä»¶ç»„æˆï¼ˆCPU/IOæ¨¡å—/ç”µæº/æ€»çº¿ï¼‰</li>\n<li>è¿›åˆ¶è½¬æ¢ï¼ˆäºŒè¿›åˆ¶/åå…­è¿›åˆ¶ï¼‰</li>\n</ul>\n</li>\n<li><strong>æ¨èèµ„æº</strong>ï¼š<ul>\n<li>ä¹¦ç±ï¼šã€ŠPLCç¼–ç¨‹ä»å…¥é—¨åˆ°ç²¾é€šã€‹ï¼ˆå»–å¸¸åˆè‘—ï¼‰</li>\n<li>è§†é¢‘ï¼šBç«™â€œå·¥æ§è‡ªä¹ å®¤â€ã€ŠPLCåŸç†10è®²ã€‹ï¼ˆå…è´¹ï¼‰</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"â–¶-é˜¶æ®µ2ï¼šç¼–ç¨‹è¯­è¨€å®æˆ˜ï¼ˆé‡ç‚¹ï¼3-6å‘¨ï¼‰\"><a href=\"#â–¶-é˜¶æ®µ2ï¼šç¼–ç¨‹è¯­è¨€å®æˆ˜ï¼ˆé‡ç‚¹ï¼3-6å‘¨ï¼‰\" class=\"headerlink\" title=\"â–¶ é˜¶æ®µ2ï¼šç¼–ç¨‹è¯­è¨€å®æˆ˜ï¼ˆé‡ç‚¹ï¼3-6å‘¨ï¼‰\"></a>â–¶ <strong>é˜¶æ®µ2ï¼šç¼–ç¨‹è¯­è¨€å®æˆ˜ï¼ˆé‡ç‚¹ï¼3-6å‘¨ï¼‰</strong></h3><div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th><strong>è¯­è¨€</strong></th>\n<th><strong>å­¦ä¹ å»ºè®®</strong></th>\n<th><strong>ä»¿çœŸè½¯ä»¶</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>æ¢¯å½¢å›¾(LD)</strong></td>\n<td>å…ˆæŒæ¡ï¼80%åŸºç¡€é¡¹ç›®ç”¨æ­¤è¯­è¨€</td>\n<td>è¥¿é—¨å­TIA Portalï¼ˆåšé€”ï¼‰å­¦ä¹ ç‰ˆ</td>\n</tr>\n<tr>\n<td><strong>åŠŸèƒ½å—(FBD)</strong></td>\n<td>å­¦ä¹ æ ‡å‡†åŠŸèƒ½å—ï¼ˆå®šæ—¶å™¨/è®¡æ•°å™¨ï¼‰</td>\n<td>ä¸‰è±GX Works2 æ¨¡æ‹Ÿå™¨</td>\n</tr>\n<tr>\n<td><strong>ç»“æ„åŒ–æ–‡æœ¬(ST)</strong></td>\n<td>æœ‰Cè¯­è¨€åŸºç¡€å†å­¦</td>\n<td>Codesys V3.5ï¼ˆå…è´¹ï¼‰</td>\n</tr>\n</tbody>\n</table>\n</div>\n<blockquote>\n<p>âœ¨ <strong>å…³é”®ç»ƒä¹ </strong>ï¼š<br>â‘  ç”µæœºæ­£åè½¬æ§åˆ¶<br>â‘¡ ä¸‰çº§ä¼ é€å¸¦è”åŠ¨<br>â‘¢ æ°´ç®±æ¶²ä½PIDè°ƒèŠ‚ï¼ˆæ¨¡æ‹Ÿé‡ï¼‰</p>\n</blockquote>\n<h3 id=\"â–¶-é˜¶æ®µ3ï¼šç¡¬ä»¶å®æ“ï¼ˆæ ¸å¿ƒç¯èŠ‚ï¼ï¼‰\"><a href=\"#â–¶-é˜¶æ®µ3ï¼šç¡¬ä»¶å®æ“ï¼ˆæ ¸å¿ƒç¯èŠ‚ï¼ï¼‰\" class=\"headerlink\" title=\"â–¶ é˜¶æ®µ3ï¼šç¡¬ä»¶å®æ“ï¼ˆæ ¸å¿ƒç¯èŠ‚ï¼ï¼‰\"></a>â–¶ <strong>é˜¶æ®µ3ï¼šç¡¬ä»¶å®æ“ï¼ˆæ ¸å¿ƒç¯èŠ‚ï¼ï¼‰</strong></h3><ul>\n<li><strong>ä½æˆæœ¬æ–¹æ¡ˆ</strong>ï¼ˆæ€»é¢„ç®—ï¼œ500å…ƒï¼‰ï¼š<pre class=\"mermaid\">  graph LR\n  A[æ·˜å®äºŒæ‰‹PLC] --> B[ä¸‰è±FX1S-20MR â‰ˆ200å…ƒ]\n  B --> C[æŒ‰é’®å¼€å…³å¥—è£… 50å…ƒ]\n  C --> D[ç»§ç”µå™¨æ¨¡å— 30å…ƒ]\n  D --> E[USBç¼–ç¨‹çº¿ 40å…ƒ]</pre></li>\n<li><strong>è™šæ‹Ÿæ–¹æ¡ˆ</strong>ï¼ˆé›¶ç¡¬ä»¶ï¼‰ï¼š<ul>\n<li><strong>Factory IO</strong>ï¼ˆ3Dä»¿çœŸè½¯ä»¶ï¼‰+ <strong>TIA Portal</strong> è”åŠ¨å®éªŒ</li>\n<li>æ¨¡æ‹ŸçœŸå®åœºæ™¯ï¼šä¼ é€å¸¦åˆ†æ‹£/æ™ºèƒ½ä»“å‚¨/ç”µæ¢¯æ§åˆ¶</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"â–¶-é˜¶æ®µ4ï¼šå·¥ä¸šé€šä¿¡ä¸é«˜çº§åº”ç”¨ï¼ˆ2-3ä¸ªæœˆï¼‰\"><a href=\"#â–¶-é˜¶æ®µ4ï¼šå·¥ä¸šé€šä¿¡ä¸é«˜çº§åº”ç”¨ï¼ˆ2-3ä¸ªæœˆï¼‰\" class=\"headerlink\" title=\"â–¶ é˜¶æ®µ4ï¼šå·¥ä¸šé€šä¿¡ä¸é«˜çº§åº”ç”¨ï¼ˆ2-3ä¸ªæœˆï¼‰\"></a>â–¶ <strong>é˜¶æ®µ4ï¼šå·¥ä¸šé€šä¿¡ä¸é«˜çº§åº”ç”¨ï¼ˆ2-3ä¸ªæœˆï¼‰</strong></h3><ol>\n<li><strong>é€šä¿¡åè®®</strong>ï¼šModbus RTUï¼ˆå¿…å­¦ï¼‰ã€CANopen</li>\n<li><strong>HMIå…¥é—¨</strong>ï¼šç”¨å¨çº¶é€šMT8071IEåšç®€æ˜“æ§åˆ¶ç•Œé¢</li>\n<li><strong>SCADAåŸºç¡€</strong>ï¼šç»„æ€ç‹/åŠ›æ§ç»„æ€è½¯ä»¶æ•°æ®é‡‡é›†</li>\n</ol>\n<hr>\n<h2 id=\"ğŸ”§-ä¸‰ã€é¿å‘æŒ‡å—ï¼ˆè¡€æ³ªç»éªŒï¼ï¼‰\"><a href=\"#ğŸ”§-ä¸‰ã€é¿å‘æŒ‡å—ï¼ˆè¡€æ³ªç»éªŒï¼ï¼‰\" class=\"headerlink\" title=\"ğŸ”§ ä¸‰ã€é¿å‘æŒ‡å—ï¼ˆè¡€æ³ªç»éªŒï¼ï¼‰\"></a>ğŸ”§ <strong>ä¸‰ã€é¿å‘æŒ‡å—ï¼ˆè¡€æ³ªç»éªŒï¼ï¼‰</strong></h2><ul>\n<li>âŒ <strong>é”™è¯¯è·¯çº¿</strong>ï¼šä¸€å¼€å§‹å°±é’»ç ”è¥¿é—¨å­S7-1500ï¼ˆå¤æ‚åº¦é«˜æ‰“å‡»ä¿¡å¿ƒï¼‰</li>\n<li>âœ… <strong>æ­£ç¡®è·¯çº¿</strong>ï¼š<strong>å›½äº§PLCå…¥é—¨ï¼ˆä¿¡æ·/æ±‡å·ï¼‰â†’ ä¸‰è±FXç³»åˆ— â†’ è¥¿é—¨å­S7-1200</strong></li>\n<li>ğŸš« <strong>å‹¿è¸©çš„å‘</strong>ï¼š<ol>\n<li>ä¸ç»ƒæ¡ˆä¾‹ç›´æ¥çœ‹æ‰‹å†Œ â†’ æ•ˆç‡æä½</li>\n<li>å¿½è§†PLCæ¥åœ° â†’ çƒ§æ¯æ¨¡å—é£é™©</li>\n<li>æœªå¤‡ä»½ç¨‹åºç›´æ¥ä¿®æ”¹ â†’ å¯¼è‡´è®¾å¤‡åœæœº</li>\n</ol>\n</li>\n</ul>\n<hr>\n<h2 id=\"ğŸŒ-å››ã€æŒç»­è¿›é˜¶èµ„æº\"><a href=\"#ğŸŒ-å››ã€æŒç»­è¿›é˜¶èµ„æº\" class=\"headerlink\" title=\"ğŸŒ å››ã€æŒç»­è¿›é˜¶èµ„æº\"></a>ğŸŒ <strong>å››ã€æŒç»­è¿›é˜¶èµ„æº</strong></h2><div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th><strong>ç±»å‹</strong></th>\n<th><strong>æ¨èèµ„æº</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>æ•…éšœæ’æŸ¥</strong></td>\n<td>ã€ŠPLCæ•…éšœè¯Šæ–­ä¸ç»´æŠ¤ã€‹PDF + æŠ–éŸ³â€œå·¥æ§è€å¼ è¯´ç»´ä¿®â€</td>\n</tr>\n<tr>\n<td><strong>è¡Œä¸šæ¡ˆä¾‹</strong></td>\n<td>ä¸­åå·¥æ§ç½‘è®ºå›æ¡ˆä¾‹åŒºï¼ˆçœŸå®é¡¹ç›®ç¨‹åºä¸‹è½½ï¼‰</td>\n</tr>\n<tr>\n<td><strong>è®¤è¯ä½“ç³»</strong></td>\n<td>è¥¿é—¨å­S7-1200è®¤è¯å·¥ç¨‹å¸ˆï¼ˆå¯åœ¨çº¿è€ƒï¼‰</td>\n</tr>\n<tr>\n<td><strong>å¼€æºé¡¹ç›®</strong></td>\n<td>GitHubæœç´¢â€œPLC Projectâ€å­¦ä¹ äº§çº¿æ§åˆ¶æºç </td>\n</tr>\n</tbody>\n</table>\n</div>\n<hr>\n<h2 id=\"ğŸš€-äº”ã€å°±ä¸šèƒ½åŠ›è½¬åŒ–å»ºè®®\"><a href=\"#ğŸš€-äº”ã€å°±ä¸šèƒ½åŠ›è½¬åŒ–å»ºè®®\" class=\"headerlink\" title=\"ğŸš€ äº”ã€å°±ä¸šèƒ½åŠ›è½¬åŒ–å»ºè®®\"></a>ğŸš€ <strong>äº”ã€å°±ä¸šèƒ½åŠ›è½¬åŒ–å»ºè®®</strong></h2><ol>\n<li><strong>æ‰“é€ ä½œå“é›†</strong>ï¼š<ul>\n<li>ç”¨Factory IOå½•åˆ¶æ§åˆ¶ä»¿çœŸè§†é¢‘</li>\n<li>è‡ªåˆ¶PLCæ§åˆ¶å°ï¼ˆæ·˜å®é’£é‡‘ç®±+å…ƒå™¨ä»¶ç»„è£…ï¼‰</li>\n</ul>\n</li>\n<li><strong>å‚ä¸é¡¹ç›®</strong>ï¼š<ul>\n<li>æ¥ç®€å•å¤–åŒ…ï¼šè®¾å¤‡æ”¹é€ /å°å‹éæ ‡è‡ªåŠ¨åŒ–ï¼ˆæ™ºé€ å®¶å¹³å°ï¼‰</li>\n<li>åŠ å…¥å·¥æ§ä¾ å®¢è¡Œç­‰ç¤¾ç¾¤åšå¿—æ„¿è€…é¡¹ç›®</li>\n</ul>\n</li>\n</ol>\n",
            "tags": [
                "å¼€å‘",
                "plc"
            ]
        },
        {
            "id": "https://erik.xyz/2025/07/09/php-architecture03/",
            "url": "https://erik.xyz/2025/07/09/php-architecture03/",
            "title": "phpæ¶æ„æ–¹é¢çš„è®¾è®¡ä¸æ€è€ƒï¼ˆä¸‰ï¼‰",
            "date_published": "2025-07-08T17:37:00.000Z",
            "content_html": "<p>PHPå¾®æœåŠ¡æ¶æ„ç»ˆææ•´åˆæ–¹æ¡ˆ:<br><span id=\"more\"></span></p>\n  <pre class=\"mermaid\">  graph TD\n      A[å®¢æˆ·ç«¯] --> B{Kongç½‘å…³}\n      B -->|è·¯ç”±| C[ç”¨æˆ·æœåŠ¡]\n      B -->|è·¯ç”±| D[è®¢å•æœåŠ¡]\n      B -->|è·¯ç”±| E[æ”¯ä»˜æœåŠ¡]\n\n      C -->|æ³¨å†Œ| F[Consulé›†ç¾¤]\n      D -->|æ³¨å†Œ| F\n      E -->|æ³¨å†Œ| F\n\n      C -->|é…ç½®| G[Apollo]\n      D -->|é…ç½®| G\n      E -->|é…ç½®| G\n\n      D -->|æ¶ˆæ¯| H[RabbitMQé›†ç¾¤]\n      H --> E\n      H --> I[é€šçŸ¥æœåŠ¡]\n\n      F --> J[Prometheus]\n      G --> J\n      H --> J\n      J --> K[Grafana]\n\n      L[Jaeger] --> M[æœåŠ¡è¿½è¸ª]</pre>\n\n<ol>\n<li><p>åŸºç¡€è®¾æ–½å¿«é€Ÿéƒ¨ç½²<br>Docker Compose å…¨æ ˆé…ç½®</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">version: &#x27;3.8&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  # æ³¨å†Œä¸­å¿ƒ</span><br><span class=\"line\">  consul-server:</span><br><span class=\"line\">    image: consul:1.15</span><br><span class=\"line\">    ports: [&quot;8500:8500&quot;]</span><br><span class=\"line\">    command: &quot;agent -server -bootstrap-expect=1 -ui -client 0.0.0.0&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">  # APIç½‘å…³</span><br><span class=\"line\">  kong:</span><br><span class=\"line\">    image: kong:3.4</span><br><span class=\"line\">    depends_on: [consul-server]</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      KONG_DATABASE: &quot;off&quot;</span><br><span class=\"line\">      KONG_DECLARATIVE_CONFIG: &quot;/etc/kong/kong.yml&quot;</span><br><span class=\"line\">      KONG_PROXY_ACCESS_LOG: &quot;/dev/stdout&quot;</span><br><span class=\"line\">      KONG_ADMIN_ACCESS_LOG: &quot;/dev/stdout&quot;</span><br><span class=\"line\">      KONG_PROXY_ERROR_LOG: &quot;/dev/stderr&quot;</span><br><span class=\"line\">    ports: [&quot;8000:8000&quot;, &quot;8001:8001&quot;]</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./kong:/etc/kong</span><br><span class=\"line\"></span><br><span class=\"line\">  # é…ç½®ä¸­å¿ƒ</span><br><span class=\"line\">  apollo:</span><br><span class=\"line\">    image: apolloconfig/apollo-portal:2.1.0</span><br><span class=\"line\">    ports: [&quot;8070:8070&quot;]</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      SPRING_DATASOURCE_URL: &quot;jdbc:mysql://apollo-db:3306/ApolloPortalDB&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">  # æ¶ˆæ¯é˜Ÿåˆ—</span><br><span class=\"line\">  rabbitmq:</span><br><span class=\"line\">    image: rabbitmq:3.11-management</span><br><span class=\"line\">    ports: [&quot;5672:5672&quot;, &quot;15672:15672&quot;]</span><br><span class=\"line\">    environment:</span><br><span class=\"line\">      RABBITMQ_DEFAULT_USER: &quot;admin&quot;</span><br><span class=\"line\">      RABBITMQ_DEFAULT_PASS: &quot;secret&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">  # ç›‘æ§ç³»ç»Ÿ</span><br><span class=\"line\">  prometheus:</span><br><span class=\"line\">    image: prom/prometheus:v2.47</span><br><span class=\"line\">    ports: [&quot;9090:9090&quot;]</span><br><span class=\"line\">    volumes:</span><br><span class=\"line\">      - ./prometheus.yml:/etc/prometheus/prometheus.yml</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>æ ¸å¿ƒæœåŠ¡PHPå®ç°åŒ…</p>\n<p> composer.json å…³é”®ä¾èµ–</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">  &quot;require&quot;: &#123;</span><br><span class=\"line\">    &quot;php&quot;: &quot;&gt;=8.2&quot;,</span><br><span class=\"line\">    &quot;ext-swoole&quot;: &quot;*&quot;,</span><br><span class=\"line\">    &quot;ext-redis&quot;: &quot;*&quot;,</span><br><span class=\"line\">    &quot;ext-amqp&quot;: &quot;*&quot;,</span><br><span class=\"line\"></span><br><span class=\"line\">    &quot;sensiolabs/consul-php-sdk&quot;: &quot;^2.0&quot;,</span><br><span class=\"line\">    &quot;guzzlehttp/guzzle&quot;: &quot;^7.8&quot;,</span><br><span class=\"line\">    &quot;php-amqplib/php-amqplib&quot;: &quot;^3.2&quot;,</span><br><span class=\"line\">    &quot;resilience-php/resilience-php&quot;: &quot;^1.3&quot;,</span><br><span class=\"line\">    &quot;apolloconfig/apollo-client&quot;: &quot;^2.0&quot;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></li>\n<li><p>æœåŠ¡æ³¨å†Œä¸å‘ç°å®Œæ•´å®ç°</p>\n<p> æœåŠ¡æ³¨å†Œï¼ˆbootstrap.phpï¼‰</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use SensioLabs\\Consul\\ServiceFactory;</span><br><span class=\"line\"></span><br><span class=\"line\">$consul = new ServiceFactory([&#x27;base_uri&#x27; =&gt; &#x27;http://consul-server:8500&#x27;]);</span><br><span class=\"line\"></span><br><span class=\"line\">// è‡ªåŠ¨è·å–æœ¬æœºIP</span><br><span class=\"line\">$ip = trim(shell_exec(&quot;hostname -i&quot;));</span><br><span class=\"line\"></span><br><span class=\"line\">// æ³¨å†ŒæœåŠ¡</span><br><span class=\"line\">$consul-&gt;get(AgentInterface::class)-&gt;registerService([</span><br><span class=\"line\">    &#x27;ID&#x27; =&gt; &#x27;order-service-&#x27;.gethostname(),</span><br><span class=\"line\">    &#x27;Name&#x27; =&gt; &#x27;order-service&#x27;,</span><br><span class=\"line\">    &#x27;Address&#x27; =&gt; $ip,</span><br><span class=\"line\">    &#x27;Port&#x27; =&gt; 8000,</span><br><span class=\"line\">    &#x27;Check&#x27; =&gt; [</span><br><span class=\"line\">        &#x27;HTTP&#x27; =&gt; &quot;http://&#123;$ip&#125;:8000/health&quot;,</span><br><span class=\"line\">        &#x27;Interval&#x27; =&gt; &#x27;5s&#x27;,</span><br><span class=\"line\">        &#x27;Timeout&#x27; =&gt; &#x27;2s&#x27;,</span><br><span class=\"line\">        &#x27;DeregisterCriticalServiceAfter&#x27; =&gt; &#x27;30s&#x27;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &#x27;Tags&#x27; =&gt; [&#x27;v2&#x27;, &#x27;primary&#x27;]</span><br><span class=\"line\">]);</span><br><span class=\"line\"></span><br><span class=\"line\">// å¥åº·æ£€æŸ¥ç«¯ç‚¹</span><br><span class=\"line\">$app-&gt;get(&#x27;/health&#x27;, function() &#123;</span><br><span class=\"line\">    check_database();</span><br><span class=\"line\">    check_redis();</span><br><span class=\"line\">    return json_response([&#x27;status&#x27; =&gt; &#x27;UP&#x27;]);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<p>æœåŠ¡å‘ç°ä¸è´Ÿè½½å‡è¡¡</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class ServiceDiscovery &#123;</span><br><span class=\"line\">    private static $cache = [];</span><br><span class=\"line\">    private static $ttl = 5; // ç¼“å­˜5ç§’</span><br><span class=\"line\"></span><br><span class=\"line\">    public static function getInstance(string $service): string &#123;</span><br><span class=\"line\">        $now = time();</span><br><span class=\"line\"></span><br><span class=\"line\">        // ç¼“å­˜æœ‰æ•ˆæœŸå†…ç›´æ¥è¿”å›</span><br><span class=\"line\">        if (isset(self::$cache[$service]) &amp;&amp; </span><br><span class=\"line\">            $now - self::$cache[$service][&#x27;timestamp&#x27;] &lt; self::$ttl) &#123;</span><br><span class=\"line\">            return self::selectInstance(self::$cache[$service][&#x27;instances&#x27;]);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        // ä»Consulè·å–æ–°å®ä¾‹</span><br><span class=\"line\">        $instances = $consul-&gt;getCatalog()-&gt;service($service)-&gt;json();</span><br><span class=\"line\">        self::$cache[$service] = [</span><br><span class=\"line\">            &#x27;instances&#x27; =&gt; $instances,</span><br><span class=\"line\">            &#x27;timestamp&#x27; =&gt; $now</span><br><span class=\"line\">        ];</span><br><span class=\"line\"></span><br><span class=\"line\">        return self::selectInstance($instances);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private static function selectInstance(array $instances): string &#123;</span><br><span class=\"line\">        // åŠ æƒéšæœºç®—æ³•</span><br><span class=\"line\">        $total = array_sum(array_column($instances, &#x27;Weight&#x27;));</span><br><span class=\"line\">        $rand = mt_rand(1, $total);</span><br><span class=\"line\">        $current = 0;</span><br><span class=\"line\"></span><br><span class=\"line\">        foreach ($instances as $instance) &#123;</span><br><span class=\"line\">            $current += $instance[&#x27;Weight&#x27;];</span><br><span class=\"line\">            if ($rand &lt;= $current) &#123;</span><br><span class=\"line\">                return &quot;http://&#123;$instance[&#x27;ServiceAddress&#x27;]&#125;:&#123;$instance[&#x27;ServicePort&#x27;]&#125;&quot;;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ç»Ÿä¸€é…ç½®ä¸­å¿ƒæ¥å…¥</p>\n<p>Apolloé…ç½®ç›‘å¬</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">$apollo = new \\ApolloClient\\Client([</span><br><span class=\"line\">    &#x27;config_server&#x27; =&gt; &#x27;http://apollo:8070&#x27;,</span><br><span class=\"line\">    &#x27;app_id&#x27; =&gt; &#x27;order-service&#x27;,</span><br><span class=\"line\">    &#x27;cluster&#x27; =&gt; &#x27;default&#x27;</span><br><span class=\"line\">]);</span><br><span class=\"line\"></span><br><span class=\"line\">// åˆå§‹åŒ–é…ç½®</span><br><span class=\"line\">$mysqlConfig = $apollo-&gt;get(&#x27;mysql&#x27;);</span><br><span class=\"line\">DB::connect($mysqlConfig);</span><br><span class=\"line\"></span><br><span class=\"line\">// åŠ¨æ€ç›‘å¬</span><br><span class=\"line\">$apollo-&gt;listen([&#x27;mysql&#x27;, &#x27;redis&#x27;], function($namespace, $config) &#123;</span><br><span class=\"line\">    switch ($namespace) &#123;</span><br><span class=\"line\">        case &#x27;mysql&#x27;:</span><br><span class=\"line\">            DB::reconnect($config);</span><br><span class=\"line\">            break;</span><br><span class=\"line\">        case &#x27;redis&#x27;:</span><br><span class=\"line\">            Redis::setConfig($config);</span><br><span class=\"line\">            break;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    Logger::info(&quot;Config updated: $namespace&quot;);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></li>\n<li><p>æœåŠ¡é€šä¿¡å®Œæ•´æ–¹æ¡ˆ</p>\n<p>åŒæ­¥è°ƒç”¨ï¼ˆHTTPï¼‰</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class HttpServiceClient &#123;</span><br><span class=\"line\">    use CircuitBreaker;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function call(string $service, string $endpoint, array $data) &#123;</span><br><span class=\"line\">        return $this-&gt;protect(function() use ($service, $endpoint, $data) &#123;</span><br><span class=\"line\">            $baseUrl = ServiceDiscovery::getInstance($service);</span><br><span class=\"line\">            $client = new GuzzleHttp\\Client([</span><br><span class=\"line\">                &#x27;base_uri&#x27; =&gt; $baseUrl,</span><br><span class=\"line\">                &#x27;timeout&#x27; =&gt; 2.0</span><br><span class=\"line\">            ]);</span><br><span class=\"line\"></span><br><span class=\"line\">            return $client-&gt;post($endpoint, [</span><br><span class=\"line\">                &#x27;json&#x27; =&gt; $data,</span><br><span class=\"line\">                &#x27;headers&#x27; =&gt; [</span><br><span class=\"line\">                    &#x27;X-Trace-Id&#x27; =&gt; Trace::getId()</span><br><span class=\"line\">                ]</span><br><span class=\"line\">            ]);</span><br><span class=\"line\">        &#125;, function() &#123; // é™çº§å¤„ç†</span><br><span class=\"line\">            return [&#x27;status&#x27; =&gt; &#x27;degraded&#x27;];</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>å¼‚æ­¥é€šä¿¡ï¼ˆRabbitMQï¼‰</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class EventPublisher &#123;</span><br><span class=\"line\">    private $channel;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function __construct() &#123;</span><br><span class=\"line\">        $conn = new AMQPStreamConnection(&#x27;rabbitmq&#x27;, 5672, &#x27;admin&#x27;, &#x27;secret&#x27;);</span><br><span class=\"line\">        $this-&gt;channel = $conn-&gt;channel();</span><br><span class=\"line\"></span><br><span class=\"line\">        // å£°æ˜æ­»ä¿¡äº¤æ¢å™¨</span><br><span class=\"line\">        $this-&gt;channel-&gt;exchange_declare(&#x27;dlx&#x27;, &#x27;direct&#x27;, false, true);</span><br><span class=\"line\">        $this-&gt;channel-&gt;queue_declare(&#x27;dlq&#x27;, false, true);</span><br><span class=\"line\">        $this-&gt;channel-&gt;queue_bind(&#x27;dlq&#x27;, &#x27;dlx&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function publish(string $event, array $data) &#123;</span><br><span class=\"line\">        $this-&gt;channel-&gt;tx_select();</span><br><span class=\"line\"></span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            $message = new AMQPMessage(json_encode($data), [</span><br><span class=\"line\">                &#x27;delivery_mode&#x27; =&gt; AMQPMessage::DELIVERY_MODE_PERSISTENT,</span><br><span class=\"line\">                &#x27;message_id&#x27; =&gt; Uuid::uuid4(),</span><br><span class=\"line\">                &#x27;timestamp&#x27; =&gt; time()</span><br><span class=\"line\">            ]);</span><br><span class=\"line\"></span><br><span class=\"line\">            $this-&gt;channel-&gt;basic_publish($message, &#x27;events&#x27;, $event);</span><br><span class=\"line\">            DB::table(&#x27;outbox&#x27;)-&gt;insert([&#x27;message_id&#x27; =&gt; $message-&gt;get(&#x27;message_id&#x27;)]);</span><br><span class=\"line\">            $this-&gt;channel-&gt;tx_commit();</span><br><span class=\"line\">        &#125; catch (Exception $e) &#123;</span><br><span class=\"line\">            $this-&gt;channel-&gt;tx_rollback();</span><br><span class=\"line\">            throw $e;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>æœåŠ¡é™çº§ç†”æ–­ç­–ç•¥</p>\n<p>å¤šçº§é™çº§é…ç½®</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class DegradeManager &#123;</span><br><span class=\"line\">    private static $levels = [</span><br><span class=\"line\">        &#x27;order-service&#x27; =&gt; [</span><br><span class=\"line\">            &#x27;full&#x27; =&gt; [&#x27;threshold&#x27; =&gt; 0.95, &#x27;fallback&#x27; =&gt; &#x27;cache&#x27;],</span><br><span class=\"line\">            &#x27;cache&#x27; =&gt; [&#x27;threshold&#x27; =&gt; 0.8, &#x27;fallback&#x27; =&gt; &#x27;readonly&#x27;],</span><br><span class=\"line\">            &#x27;readonly&#x27; =&gt; [&#x27;threshold&#x27; =&gt; 0.5, &#x27;fallback&#x27; =&gt; &#x27;static&#x27;]</span><br><span class=\"line\">        ]</span><br><span class=\"line\">    ];</span><br><span class=\"line\"></span><br><span class=\"line\">    public static function handle(string $service, callable $func) &#123;</span><br><span class=\"line\">        $status = self::getServiceStatus($service);</span><br><span class=\"line\"></span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            switch ($status) &#123;</span><br><span class=\"line\">                case &#x27;full&#x27;:</span><br><span class=\"line\">                    return $func();</span><br><span class=\"line\">                case &#x27;cache&#x27;:</span><br><span class=\"line\">                    return Cache::remember(&quot;fallback:$service&quot;, 60, $func);</span><br><span class=\"line\">                case &#x27;readonly&#x27;:</span><br><span class=\"line\">                    if ($_SERVER[&#x27;REQUEST_METHOD&#x27;] === &#x27;GET&#x27;) &#123;</span><br><span class=\"line\">                        return $func();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    throw new DegradeException(&#x27;åªè¯»æ¨¡å¼&#x27;);</span><br><span class=\"line\">                case &#x27;static&#x27;:</span><br><span class=\"line\">                    return [&#x27;status&#x27; =&gt; &#x27;degraded&#x27;];</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; catch (Exception $e) &#123;</span><br><span class=\"line\">            self::recordFailure($service);</span><br><span class=\"line\">            return self::handle($service, $func); // è‡ªåŠ¨é™çº§</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private static function getServiceStatus(string $service): string &#123;</span><br><span class=\"line\">        $failureRate = Prometheus::getFailureRate($service);</span><br><span class=\"line\"></span><br><span class=\"line\">        foreach (self::$levels[$service] as $level =&gt; $config) &#123;</span><br><span class=\"line\">            if ($failureRate &lt;= $config[&#x27;threshold&#x27;]) &#123;</span><br><span class=\"line\">                return $level;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        return &#x27;static&#x27;;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ç›‘æ§ä¸å‘Šè­¦é…ç½®</p>\n<p>PrometheusæŒ‡æ ‡æ”¶é›†</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class Metrics &#123;</span><br><span class=\"line\">    private static $counter;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static function init() &#123;</span><br><span class=\"line\">        $registry = new CollectorRegistry(new InMemory());</span><br><span class=\"line\"></span><br><span class=\"line\">        self::$counter = $registry-&gt;registerCounter(</span><br><span class=\"line\">            &#x27;php&#x27;, </span><br><span class=\"line\">            &#x27;http_requests_total&#x27;, </span><br><span class=\"line\">            &#x27;Total HTTP requests&#x27;,</span><br><span class=\"line\">            [&#x27;method&#x27;, &#x27;endpoint&#x27;, &#x27;status&#x27;]</span><br><span class=\"line\">        );</span><br><span class=\"line\"></span><br><span class=\"line\">        // æš´éœ²æŒ‡æ ‡ç«¯ç‚¹</span><br><span class=\"line\">        $app-&gt;get(&#x27;/metrics&#x27;, function() use ($registry) &#123;</span><br><span class=\"line\">            $renderer = new RenderTextFormat();</span><br><span class=\"line\">            return $renderer-&gt;render($registry-&gt;getMetricFamilySamples());</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public static function countRequest($method, $path, $status) &#123;</span><br><span class=\"line\">        self::$counter-&gt;inc([</span><br><span class=\"line\">            $method, </span><br><span class=\"line\">            preg_replace(&#x27;/\\d+/&#x27;, &#x27;&#123;id&#125;&#x27;, $path),</span><br><span class=\"line\">            $status</span><br><span class=\"line\">        ]);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// åœ¨ä¸­é—´ä»¶ä¸­è°ƒç”¨</span><br><span class=\"line\">$app-&gt;addMiddleware(function($req, $handler) &#123;</span><br><span class=\"line\">    $start = microtime(true);</span><br><span class=\"line\">    $response = $handler-&gt;handle($req);</span><br><span class=\"line\">    $duration = microtime(true) - $start;</span><br><span class=\"line\"></span><br><span class=\"line\">    Metrics::countRequest(</span><br><span class=\"line\">        $req-&gt;getMethod(),</span><br><span class=\"line\">        $req-&gt;getUri()-&gt;getPath(),</span><br><span class=\"line\">        $response-&gt;getStatusCode()</span><br><span class=\"line\">    );</span><br><span class=\"line\"></span><br><span class=\"line\">    return $response;</span><br><span class=\"line\">&#125;);</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²å»ºè®®</p>\n</li>\n</ol>\n<ol>\n<li><p>æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼š</p>\n<ul>\n<li><p>éƒ¨ç½²3èŠ‚ç‚¹Consulé›†ç¾¤</p>\n</li>\n<li><p>å¯ç”¨ACLå’ŒTLSåŠ å¯†</p>\n</li>\n<li><p>è®¾ç½®è‡ªåŠ¨å¤‡ä»½ç­–ç•¥</p>\n</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li><p>APIç½‘å…³ï¼š</p>\n<ul>\n<li><p>Kongé›†ç¾¤ + Nginxè´Ÿè½½å‡è¡¡</p>\n</li>\n<li><p>å¯ç”¨JWTæ’ä»¶å’Œé€Ÿç‡é™åˆ¶</p>\n</li>\n<li><p>é…ç½®WAFè§„åˆ™é˜²æ­¢æ”»å‡»</p>\n</li>\n</ul>\n</li>\n<li><p>é…ç½®ä¸­å¿ƒï¼š</p>\n<ul>\n<li><p>Apolloå¤šç¯å¢ƒéš”ç¦»ï¼ˆDEV/TEST/PRODï¼‰</p>\n</li>\n<li><p>æ•æ„Ÿé…ç½®åŠ å¯†å­˜å‚¨</p>\n</li>\n<li><p>è®¾ç½®é…ç½®å˜æ›´å®¡æ‰¹æµç¨‹</p>\n</li>\n</ul>\n</li>\n<li><p>æ¶ˆæ¯é˜Ÿåˆ—ï¼š</p>\n<ul>\n<li><p>RabbitMQé•œåƒé˜Ÿåˆ—</p>\n</li>\n<li><p>è®¾ç½®åˆç†çš„TTLå’Œæ­»ä¿¡ç­–ç•¥</p>\n</li>\n<li><p>ç›‘æ§é˜Ÿåˆ—ç§¯å‹æƒ…å†µ</p>\n</li>\n</ul>\n</li>\n<li><p>ç›‘æ§ç³»ç»Ÿï¼š</p>\n<ul>\n<li><p>Prometheusè”é‚¦é›†ç¾¤</p>\n</li>\n<li><p>Grafanaç»Ÿä¸€çœ‹æ¿</p>\n</li>\n<li><p>å…³é”®æŒ‡æ ‡å‘Šè­¦ï¼ˆP99å»¶è¿Ÿ&gt;500msï¼Œé”™è¯¯ç‡&gt;1%ï¼‰</p>\n</li>\n</ul>\n</li>\n</ul>\n<h5 id=\"å®Œæ•´æ¶æ„è°ƒç”¨æµç¨‹ç¤ºä¾‹\"><a href=\"#å®Œæ•´æ¶æ„è°ƒç”¨æµç¨‹ç¤ºä¾‹\" class=\"headerlink\" title=\"å®Œæ•´æ¶æ„è°ƒç”¨æµç¨‹ç¤ºä¾‹\"></a>å®Œæ•´æ¶æ„è°ƒç”¨æµç¨‹ç¤ºä¾‹</h5><ol>\n<li>å®¢æˆ·ç«¯è¯·æ±‚ â†’ Kongç½‘å…³ï¼ˆè®¤è¯+é™æµï¼‰</li>\n</ol>\n<ul>\n<li><p>ç½‘å…³æŸ¥è¯¢Consulè·å–è®¢å•æœåŠ¡å®ä¾‹</p>\n</li>\n<li><p>è®¢å•æœåŠ¡å¤„ç†æ—¶ï¼š</p>\n<ul>\n<li><p>ä»Apolloè·å–å½“å‰é…ç½®</p>\n</li>\n<li><p>é€šè¿‡HTTPè°ƒç”¨æ”¯ä»˜æœåŠ¡ï¼ˆå¸¦ç†”æ–­ï¼‰</p>\n</li>\n<li><p>å‘é€æ¶ˆæ¯åˆ°RabbitMQ</p>\n</li>\n</ul>\n</li>\n<li><p>æ”¯ä»˜æœåŠ¡æ¶ˆè´¹æ¶ˆæ¯åï¼š</p>\n<ul>\n<li><p>æ›´æ–°æ•°æ®åº“</p>\n</li>\n<li><p>è®°å½•PrometheusæŒ‡æ ‡</p>\n</li>\n<li><p>æ¨é€ç»“æœåˆ°é€šçŸ¥æœåŠ¡</p>\n</li>\n</ul>\n</li>\n<li><p>å…¨é“¾è·¯è¿½è¸ªæ•°æ®ä¸ŠæŠ¥Jaeger</p>\n</li>\n</ul>\n",
            "tags": [
                "phpæ¶æ„",
                "phpé¡¹ç›®",
                "phpæ¶æ„è®¾è®¡"
            ]
        },
        {
            "id": "https://erik.xyz/2025/07/06/php-architecture02/",
            "url": "https://erik.xyz/2025/07/06/php-architecture02/",
            "title": "php æ¶æ„æ–¹é¢çš„è®¾è®¡ä¸æ€è€ƒï¼ˆäºŒï¼‰",
            "date_published": "2025-07-06T15:45:22.000Z",
            "content_html": "<p>åŸºäºä¹‹å‰çš„æ¶æ„è®¾è®¡ï¼Œè¿›ä¸€æ­¥æä¾›å®Œæ•´çš„å¯è½åœ°æ–¹æ¡ˆï¼š</p>\n<h4 id=\"ä¸€ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒå¢å¼ºå®ç°ï¼ˆConsul-PHPï¼‰\"><a href=\"#ä¸€ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒå¢å¼ºå®ç°ï¼ˆConsul-PHPï¼‰\" class=\"headerlink\" title=\"ä¸€ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒå¢å¼ºå®ç°ï¼ˆConsul + PHPï¼‰\"></a>ä¸€ã€æœåŠ¡æ³¨å†Œä¸­å¿ƒå¢å¼ºå®ç°ï¼ˆConsul + PHPï¼‰</h4><ol>\n<li>å¥åº·æ£€æŸ¥ä¸è‡ªåŠ¨æ³¨é”€</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// æœåŠ¡æ³¨å†Œæ—¶å¢åŠ å¥åº·æ£€æŸ¥ç«¯ç‚¹</span><br><span class=\"line\">$consul-&gt;get(AgentInterface::class)-&gt;registerService([</span><br><span class=\"line\">    &#x27;ID&#x27; =&gt; &#x27;payment-service-&#x27;.uniqid(),</span><br><span class=\"line\">    &#x27;Name&#x27; =&gt; &#x27;payment-service&#x27;,</span><br><span class=\"line\">    &#x27;Tags&#x27; =&gt; [&#x27;primary&#x27;, &#x27;v2&#x27;],</span><br><span class=\"line\">    &#x27;Address&#x27; =&gt; get_current_ip(),</span><br><span class=\"line\">    &#x27;Port&#x27; =&gt; 8000,</span><br><span class=\"line\">    &#x27;Check&#x27; =&gt; [</span><br><span class=\"line\">        &#x27;HTTP&#x27; =&gt; &#x27;http://&#x27;.get_current_ip().&#x27;:8000/health&#x27;,</span><br><span class=\"line\">        &#x27;Interval&#x27; =&gt; &#x27;5s&#x27;,</span><br><span class=\"line\">        &#x27;Timeout&#x27; =&gt; &#x27;2s&#x27;,</span><br><span class=\"line\">        &#x27;DeregisterCriticalServiceAfter&#x27; =&gt; &#x27;30s&#x27;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">]);</span><br><span class=\"line\"></span><br><span class=\"line\">// PHPå¥åº·æ£€æŸ¥ç«¯ç‚¹å®ç°</span><br><span class=\"line\">$app-&gt;get(&#x27;/health&#x27;, function() &#123;</span><br><span class=\"line\">    return json_encode([</span><br><span class=\"line\">        &#x27;status&#x27; =&gt; &#x27;UP&#x27;,</span><br><span class=\"line\">        &#x27;db_connected&#x27; =&gt; DB::connection()-&gt;getPdo() ? true : false,</span><br><span class=\"line\">        &#x27;redis_connected&#x27; =&gt; Redis::ping() ? true : false,</span><br><span class=\"line\">        &#x27;load&#x27; =&gt; sys_getloadavg()[0]</span><br><span class=\"line\">    ]);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<span id=\"more\"></span>\n<ol>\n<li>æœåŠ¡å‘ç°è´Ÿè½½å‡è¡¡</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class ServiceLocator &#123;</span><br><span class=\"line\">    private static $services = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    public static function getInstance($serviceName) &#123;</span><br><span class=\"line\">        if (!isset(self::$services[$serviceName]) || count(self::$services[$serviceName]) == 0) &#123;</span><br><span class=\"line\">            $instances = $consul-&gt;getCatalog()-&gt;service($serviceName)-&gt;json();</span><br><span class=\"line\">            self::$services[$serviceName] = array_map(</span><br><span class=\"line\">                fn($s) =&gt; new Instance($s[&#x27;ServiceAddress&#x27;], $s[&#x27;ServicePort&#x27;]),</span><br><span class=\"line\">                $instances</span><br><span class=\"line\">            );</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">        // ä½¿ç”¨åŠ æƒéšæœºç®—æ³•é€‰æ‹©å®ä¾‹</span><br><span class=\"line\">        $totalWeight = array_sum(array_map(fn($i) =&gt; $i-&gt;weight, self::$services[$serviceName]));</span><br><span class=\"line\">        $rand = mt_rand(1, $totalWeight);</span><br><span class=\"line\"></span><br><span class=\"line\">        foreach (self::$services[$serviceName] as $instance) &#123;</span><br><span class=\"line\">            $rand -= $instance-&gt;weight;</span><br><span class=\"line\">            if ($rand &lt;= 0) &#123;</span><br><span class=\"line\">                return $instance;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    // å®šæ—¶åˆ·æ–°æœåŠ¡åˆ—è¡¨</span><br><span class=\"line\">    public static function refresh() &#123;</span><br><span class=\"line\">        swoole_timer_tick(30000, function() &#123;</span><br><span class=\"line\">            foreach (array_keys(self::$services) as $name) &#123;</span><br><span class=\"line\">                $instances = $consul-&gt;getCatalog()-&gt;service($name)-&gt;json();</span><br><span class=\"line\">                self::$services[$name] = $instances;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h3 id=\"äºŒã€API-ç½‘å…³æ·±åº¦é›†æˆï¼ˆKong-OpenRestyï¼‰\"><a href=\"#äºŒã€API-ç½‘å…³æ·±åº¦é›†æˆï¼ˆKong-OpenRestyï¼‰\" class=\"headerlink\" title=\"äºŒã€API ç½‘å…³æ·±åº¦é›†æˆï¼ˆKong + OpenRestyï¼‰\"></a>äºŒã€API ç½‘å…³æ·±åº¦é›†æˆï¼ˆKong + OpenRestyï¼‰</h3><ol>\n<li>åŠ¨æ€è·¯ç”±é…ç½®</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#lua</span><br><span class=\"line\">-- kong/plugins/dynamic-router/handler.lua</span><br><span class=\"line\">local DynamicRouterHandler = &#123;</span><br><span class=\"line\">    PRIORITY = 1000,</span><br><span class=\"line\">    VERSION = &quot;1.0&quot;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">function DynamicRouterHandler:access(conf)</span><br><span class=\"line\">    -- ä»Consulè·å–æœ€æ–°æœåŠ¡å®ä¾‹</span><br><span class=\"line\">    local res, err = kong.request.make(&#123;</span><br><span class=\"line\">        method = &quot;GET&quot;,</span><br><span class=\"line\">        url = &quot;http://consul:8500/v1/catalog/service/&quot; .. kong.request.get_header(&quot;X-Service-Name&quot;)</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\"></span><br><span class=\"line\">    if not res then</span><br><span class=\"line\">        kong.log.err(&quot;Consul request failed: &quot;, err)</span><br><span class=\"line\">        return kong.response.exit(503)</span><br><span class=\"line\">    end</span><br><span class=\"line\"></span><br><span class=\"line\">    local instances = cjson.decode(res.body)</span><br><span class=\"line\">    if #instances == 0 then</span><br><span class=\"line\">        return kong.response.exit(404, &#123; message = &quot;Service unavailable&quot; &#125;)</span><br><span class=\"line\">    end</span><br><span class=\"line\"></span><br><span class=\"line\">    -- æ›´æ–°ä¸Šæ¸¸ç›®æ ‡</span><br><span class=\"line\">    local ok, err = kong.admin_api.post(&quot;/upstreams/service-&quot;..conf.service_name..&quot;/targets&quot;, &#123;</span><br><span class=\"line\">        target = instances[1].ServiceAddress..&quot;:&quot;..instances[1].ServicePort,</span><br><span class=\"line\">        weight = 100</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">end</span><br><span class=\"line\"></span><br><span class=\"line\">return DynamicRouterHandler</span><br></pre></td></tr></table></figure>\n<ol>\n<li>PHP æ’ä»¶å¼€å‘ç¤ºä¾‹ï¼ˆJWT éªŒè¯ï¼‰</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// kong/plugins/jwt-validator/validate.php</span><br><span class=\"line\">&lt;?php</span><br><span class=\"line\"></span><br><span class=\"line\">$token = $_SERVER[&#x27;HTTP_AUTHORIZATION&#x27;] ?? &#x27;&#x27;;</span><br><span class=\"line\">if (!preg_match(&#x27;/Bearer\\s+(.*)$/i&#x27;, $token, $matches)) &#123;</span><br><span class=\"line\">    header(&#x27;HTTP/1.1 401 Unauthorized&#x27;);</span><br><span class=\"line\">    exit;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">$jwt = $matches[1];</span><br><span class=\"line\">$userInfo = AuthService::validateJWT($jwt);</span><br><span class=\"line\"></span><br><span class=\"line\">if (!$userInfo) &#123;</span><br><span class=\"line\">    header(&#x27;HTTP/1.1 403 Forbidden&#x27;);</span><br><span class=\"line\">    exit;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// å°†ç”¨æˆ·ä¿¡æ¯ä¼ é€’ç»™ä¸Šæ¸¸æœåŠ¡</span><br><span class=\"line\">header(&#x27;X-User-Id: &#x27; . $userInfo[&#x27;id&#x27;]);</span><br><span class=\"line\">header(&#x27;X-User-Roles: &#x27; . implode(&#x27;,&#x27;, $userInfo[&#x27;roles&#x27;]));</span><br></pre></td></tr></table></figure>\n<h4 id=\"ä¸‰ã€é…ç½®ä¸­å¿ƒå®Œæ•´æ–¹æ¡ˆï¼ˆApollo-PHPï¼‰\"><a href=\"#ä¸‰ã€é…ç½®ä¸­å¿ƒå®Œæ•´æ–¹æ¡ˆï¼ˆApollo-PHPï¼‰\" class=\"headerlink\" title=\"ä¸‰ã€é…ç½®ä¸­å¿ƒå®Œæ•´æ–¹æ¡ˆï¼ˆApollo + PHPï¼‰\"></a>ä¸‰ã€é…ç½®ä¸­å¿ƒå®Œæ•´æ–¹æ¡ˆï¼ˆApollo + PHPï¼‰</h4><ol>\n<li>é…ç½®ç›‘å¬é•¿è½®è¯¢</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class ApolloWatcher &#123;</span><br><span class=\"line\">    private $client;</span><br><span class=\"line\">    private $callbacks = [];</span><br><span class=\"line\"></span><br><span class=\"line\">    public function __construct() &#123;</span><br><span class=\"line\">        $this-&gt;client = new \\ApolloClient\\Client([...]);</span><br><span class=\"line\">        $this-&gt;startWatch();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function watch($namespace, callable $callback) &#123;</span><br><span class=\"line\">        $this-&gt;callbacks[$namespace][] = $callback;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    private function startWatch() &#123;</span><br><span class=\"line\">        swoole_timer_tick(1000, function() &#123;</span><br><span class=\"line\">            foreach ($this-&gt;callbacks as $namespace =&gt; $cbs) &#123;</span><br><span class=\"line\">                $notifications = $this-&gt;client-&gt;getNotifications([$namespace]);</span><br><span class=\"line\"></span><br><span class=\"line\">                if ($notifications[$namespace] &gt; $this-&gt;versions[$namespace] ?? 0) &#123;</span><br><span class=\"line\">                    $config = $this-&gt;client-&gt;getConfig($namespace);</span><br><span class=\"line\"></span><br><span class=\"line\">                    foreach ($cbs as $cb) &#123;</span><br><span class=\"line\">                        $cb($config);</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">                    $this-&gt;versions[$namespace] = $notifications[$namespace];</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// ä½¿ç”¨ç¤ºä¾‹</span><br><span class=\"line\">$watcher = new ApolloWatcher();</span><br><span class=\"line\">$watcher-&gt;watch(&#x27;application&#x27;, function($config) &#123;</span><br><span class=\"line\">    Redis::set(&#x27;app_config&#x27;, json_encode($config));</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n<ol>\n<li>é…ç½®åŠ å¯†å­˜å‚¨</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class SecureConfig &#123;</span><br><span class=\"line\">    private $key;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function __construct() &#123;</span><br><span class=\"line\">        $this-&gt;key = file_get_contents(&#x27;/etc/apollo/key.pem&#x27;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    public function get($key) &#123;</span><br><span class=\"line\">        $encrypted = Apollo::get($key);</span><br><span class=\"line\">        return openssl_decrypt(</span><br><span class=\"line\">            base64_decode($encrypted),</span><br><span class=\"line\">            &#x27;aes-256-cbc&#x27;,</span><br><span class=\"line\">            $this-&gt;key,</span><br><span class=\"line\">            0,</span><br><span class=\"line\">            substr($this-&gt;key, 0, 16)</span><br><span class=\"line\">        );</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<h4 id=\"å››ã€æœåŠ¡æ€»çº¿å¯é æ¶ˆæ¯æ–¹æ¡ˆï¼ˆRabbitMQï¼‰\"><a href=\"#å››ã€æœåŠ¡æ€»çº¿å¯é æ¶ˆæ¯æ–¹æ¡ˆï¼ˆRabbitMQï¼‰\" class=\"headerlink\" title=\"å››ã€æœåŠ¡æ€»çº¿å¯é æ¶ˆæ¯æ–¹æ¡ˆï¼ˆRabbitMQï¼‰\"></a>å››ã€æœåŠ¡æ€»çº¿å¯é æ¶ˆæ¯æ–¹æ¡ˆï¼ˆRabbitMQï¼‰</h4><ol>\n<li>æ¶ˆæ¯äº‹åŠ¡ä¸ç¡®è®¤</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ç”Ÿäº§è€…ç«¯</span><br><span class=\"line\">$channel-&gt;tx_select();</span><br><span class=\"line\">try &#123;</span><br><span class=\"line\">    $msg = new AMQPMessage($data, [</span><br><span class=\"line\">        &#x27;delivery_mode&#x27; =&gt; AMQPMessage::DELIVERY_MODE_PERSISTENT,</span><br><span class=\"line\">        &#x27;message_id&#x27; =&gt; uniqid()</span><br><span class=\"line\">    ]);</span><br><span class=\"line\"></span><br><span class=\"line\">    $channel-&gt;basic_publish($msg, &#x27;orders&#x27;);</span><br><span class=\"line\">    DB::table(&#x27;outbox&#x27;)-&gt;insert([&#x27;message_id&#x27; =&gt; $msg-&gt;get(&#x27;message_id&#x27;)]);</span><br><span class=\"line\">    $channel-&gt;tx_commit();</span><br><span class=\"line\">&#125; catch (Exception $e) &#123;</span><br><span class=\"line\">    $channel-&gt;tx_rollback();</span><br><span class=\"line\">    Metrics::counter(&#x27;publish_failed&#x27;)-&gt;inc();</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// æ¶ˆè´¹è€…ç«¯</span><br><span class=\"line\">$channel-&gt;basic_consume(&#x27;orders&#x27;, &#x27;&#x27;, false, false, false, false,</span><br><span class=\"line\">    function($msg) &#123;</span><br><span class=\"line\">        try &#123;</span><br><span class=\"line\">            processOrder($msg-&gt;body);</span><br><span class=\"line\">            $msg-&gt;ack();</span><br><span class=\"line\"></span><br><span class=\"line\">            // å¹‚ç­‰å¤„ç†</span><br><span class=\"line\">            if (!DB::table(&#x27;processed_messages&#x27;)-&gt;where(&#x27;msg_id&#x27;, $msg-&gt;get(&#x27;message_id&#x27;))-&gt;exists()) &#123;</span><br><span class=\"line\">                DB::table(&#x27;processed_messages&#x27;)-&gt;insert([</span><br><span class=\"line\">                    &#x27;msg_id&#x27; =&gt; $msg-&gt;get(&#x27;message_id&#x27;),</span><br><span class=\"line\">                    &#x27;processed_at&#x27; =&gt; now()</span><br><span class=\"line\">                ]);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; catch (Exception $e) &#123;</span><br><span class=\"line\">            $msg-&gt;nack(true); // é‡æ–°å…¥é˜Ÿ</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n<ol>\n<li>æ­»ä¿¡é˜Ÿåˆ—é…ç½®</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å£°æ˜æ­»ä¿¡äº¤æ¢å™¨</span><br><span class=\"line\">$channel-&gt;exchange_declare(&#x27;dlx&#x27;, &#x27;direct&#x27;, false, true, false);</span><br><span class=\"line\">$channel-&gt;queue_declare(&#x27;dlq&#x27;, false, true, false, false);</span><br><span class=\"line\">$channel-&gt;queue_bind(&#x27;dlq&#x27;, &#x27;dlx&#x27;, &#x27;dead&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">// ä¸»é˜Ÿåˆ—é…ç½®</span><br><span class=\"line\">$channel-&gt;queue_declare(&#x27;orders&#x27;, false, true, false, false, false, [</span><br><span class=\"line\">    &#x27;x-dead-letter-exchange&#x27; =&gt; &#x27;dlx&#x27;,</span><br><span class=\"line\">    &#x27;x-dead-letter-routing-key&#x27; =&gt; &#x27;dead&#x27;,</span><br><span class=\"line\">    &#x27;x-message-ttl&#x27; =&gt; 600000 // 10åˆ†é’Ÿåè¿›å…¥DLQ</span><br><span class=\"line\">]);</span><br></pre></td></tr></table></figure>\n<h4 id=\"äº”ã€æœåŠ¡é™çº§å®Œæ•´ç­–ç•¥\"><a href=\"#äº”ã€æœåŠ¡é™çº§å®Œæ•´ç­–ç•¥\" class=\"headerlink\" title=\"äº”ã€æœåŠ¡é™çº§å®Œæ•´ç­–ç•¥\"></a>äº”ã€æœåŠ¡é™çº§å®Œæ•´ç­–ç•¥</h4><ol>\n<li><p>å¤šçº§é™çº§æ–¹æ¡ˆ</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">class OrderService &#123;</span><br><span class=\"line\">    const DEGRADE_LEVELS = [</span><br><span class=\"line\">        &#x27;full&#x27; =&gt; 0,    // æ­£å¸¸æœåŠ¡</span><br><span class=\"line\">        &#x27;readonly&#x27; =&gt; 1, // åªè¯»æ¨¡å¼</span><br><span class=\"line\">        &#x27;cache&#x27; =&gt; 2,    // è¿”å›ç¼“å­˜æ•°æ®</span><br><span class=\"line\">        &#x27;static&#x27; =&gt; 3    // è¿”å›é™æ€é¡µé¢</span><br><span class=\"line\">    ];</span><br><span class=\"line\"></span><br><span class=\"line\">    public function getOrder($id) &#123;</span><br><span class=\"line\">        $level = CircuitBreaker::getStatus(&#x27;order-service&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">        switch ($level) &#123;</span><br><span class=\"line\">            case self::DEGRADE_LEVELS[&#x27;full&#x27;]:</span><br><span class=\"line\">                return DB::table(&#x27;orders&#x27;)-&gt;find($id);</span><br><span class=\"line\"></span><br><span class=\"line\">            case self::DEGRADE_LEVELS[&#x27;readonly&#x27;]:</span><br><span class=\"line\">                if (request()-&gt;isMethod(&#x27;GET&#x27;)) &#123;</span><br><span class=\"line\">                    return DB::table(&#x27;orders&#x27;)-&gt;find($id);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                throw new DegradeException(&#x27;åªè¯»æ¨¡å¼&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">            case self::DEGRADE_LEVELS[&#x27;cache&#x27;]:</span><br><span class=\"line\">                return Cache::remember(&quot;order:$id&quot;, 60, function() use ($id) &#123;</span><br><span class=\"line\">                    return DB::table(&#x27;orders&#x27;)-&gt;find($id) ?? [];</span><br><span class=\"line\">                &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            case self::DEGRADE_LEVELS[&#x27;static&#x27;]:</span><br><span class=\"line\">                return [</span><br><span class=\"line\">                    &#x27;id&#x27; =&gt; $id,</span><br><span class=\"line\">                    &#x27;status&#x27; =&gt; &#x27;degraded&#x27;,</span><br><span class=\"line\">                    &#x27;message&#x27; =&gt; &#x27;ç³»ç»Ÿç¹å¿™ï¼Œè¯·ç¨åæŸ¥çœ‹è®¢å•çŠ¶æ€&#x27;</span><br><span class=\"line\">                ];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>è‡ªåŠ¨é™çº§è§„åˆ™é…ç½®</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># degradation-rules.yaml</span><br><span class=\"line\">services:</span><br><span class=\"line\">  order-service:</span><br><span class=\"line\">    failure_threshold: 50%  # å¤±è´¥ç‡é˜ˆå€¼</span><br><span class=\"line\">    slow_call_threshold: 2000ms  # æ…¢è°ƒç”¨é˜ˆå€¼</span><br><span class=\"line\">    minimum_calls: 20  # æœ€å°è°ƒç”¨é‡</span><br><span class=\"line\">    sliding_window: 60s  # ç»Ÿè®¡çª—å£</span><br><span class=\"line\">    wait_duration: 300s  # åŠå¼€çŠ¶æ€ç­‰å¾…æ—¶é—´</span><br><span class=\"line\"></span><br><span class=\"line\">    fallbacks:</span><br><span class=\"line\">      - condition: &quot;error instanceof TimeoutException&quot;</span><br><span class=\"line\">        action: &quot;return cachedData()&quot;</span><br><span class=\"line\">      - condition: &quot;error instanceof DBException&quot;</span><br><span class=\"line\">        action: &quot;switchToReadonlyMode()&quot;</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h4 id=\"å…­ã€éƒ¨ç½²æ¶æ„ä¼˜åŒ–æ–¹æ¡ˆ\"><a href=\"#å…­ã€éƒ¨ç½²æ¶æ„ä¼˜åŒ–æ–¹æ¡ˆ\" class=\"headerlink\" title=\"å…­ã€éƒ¨ç½²æ¶æ„ä¼˜åŒ–æ–¹æ¡ˆ\"></a>å…­ã€éƒ¨ç½²æ¶æ„ä¼˜åŒ–æ–¹æ¡ˆ</h4><ol>\n<li><p>Kubernetes éƒ¨ç½²æ¨¡æ¿</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># deployment.yaml</span><br><span class=\"line\">apiVersion: apps/v1</span><br><span class=\"line\">kind: Deployment</span><br><span class=\"line\">metadata:</span><br><span class=\"line\">  name: order-service</span><br><span class=\"line\">spec:</span><br><span class=\"line\">  replicas: 3</span><br><span class=\"line\">  strategy:</span><br><span class=\"line\">    rollingUpdate:</span><br><span class=\"line\">      maxSurge: 1</span><br><span class=\"line\">      maxUnavailable: 0</span><br><span class=\"line\">  template:</span><br><span class=\"line\">    spec:</span><br><span class=\"line\">      containers:</span><br><span class=\"line\">      - name: php</span><br><span class=\"line\">        image: my-registry/order-service:v1.2</span><br><span class=\"line\">        ports:</span><br><span class=\"line\">        - containerPort: 8000</span><br><span class=\"line\">        livenessProbe:</span><br><span class=\"line\">          httpGet:</span><br><span class=\"line\">            path: /health</span><br><span class=\"line\">            port: 8000</span><br><span class=\"line\">          initialDelaySeconds: 30</span><br><span class=\"line\">          periodSeconds: 10</span><br><span class=\"line\">        readinessProbe:</span><br><span class=\"line\">          httpGet:</span><br><span class=\"line\">            path: /ready</span><br><span class=\"line\">            port: 8000</span><br><span class=\"line\">          initialDelaySeconds: 5</span><br><span class=\"line\">          periodSeconds: 5</span><br><span class=\"line\">        envFrom:</span><br><span class=\"line\">        - configMapRef:</span><br><span class=\"line\">            name: apollo-config</span><br><span class=\"line\">---</span><br><span class=\"line\"># service.yaml</span><br><span class=\"line\">apiVersion: v1</span><br><span class=\"line\">kind: Service</span><br><span class=\"line\">metadata:</span><br><span class=\"line\">  name: order-service</span><br><span class=\"line\">  annotations:</span><br><span class=\"line\">    consul.hashicorp.com/service-name: order-service</span><br><span class=\"line\">spec:</span><br><span class=\"line\">  ports:</span><br><span class=\"line\">  - port: 8000</span><br><span class=\"line\">    targetPort: 8000</span><br><span class=\"line\">  selector:</span><br><span class=\"line\">    app: order-service</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>ç›‘æ§å‘Šè­¦é…ç½®</p>\n</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># prometheus-rules.yml</span><br><span class=\"line\">groups:</span><br><span class=\"line\">- name: php-services</span><br><span class=\"line\">  rules:</span><br><span class=\"line\">  - alert: HighErrorRate</span><br><span class=\"line\">    expr: sum(rate(http_requests_total&#123;status=~&quot;5..&quot;&#125;[1m])) by (service) / sum(rate(http_requests_total[1m])) by (service) &gt; 0.05</span><br><span class=\"line\">    for: 5m</span><br><span class=\"line\">    labels:</span><br><span class=\"line\">      severity: critical</span><br><span class=\"line\">    annotations:</span><br><span class=\"line\">      summary: &quot;High error rate on &#123;&#123; $labels.service &#125;&#125;&quot;</span><br><span class=\"line\">      description: &quot;Error rate is &#123;&#123; $value &#125;&#125;&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">  - alert: ServiceDown</span><br><span class=\"line\">    expr: up&#123;job=&quot;php-services&quot;&#125; == 0</span><br><span class=\"line\">    for: 1m</span><br><span class=\"line\">    labels:</span><br><span class=\"line\">      severity: critical</span><br><span class=\"line\">    annotations:</span><br><span class=\"line\">      summary: &quot;&#123;&#123; $labels.instance &#125;&#125; is down&quot;</span><br></pre></td></tr></table></figure>\n<p>ä¸ƒã€å¼€å‘ç¯å¢ƒå·¥å…·é“¾</p>\n<ol>\n<li>æœ¬åœ°è°ƒè¯•æ–¹æ¡ˆï¼š</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># ä½¿ç”¨docker-composeå¯åŠ¨ä¾èµ–æœåŠ¡</span><br><span class=\"line\">docker-compose -f dev-env.yml up consul rabbitmq apollo</span><br><span class=\"line\"></span><br><span class=\"line\"># ä½¿ç”¨Xdebugè¿œç¨‹è°ƒè¯•</span><br><span class=\"line\">PHP_IDE_CONFIG=&quot;serverName=my-service&quot; php -dxdebug.mode=debug \\</span><br><span class=\"line\">-dxdebug.client_host=host.docker.internal \\</span><br><span class=\"line\">-dxdebug.client_port=9003 \\</span><br><span class=\"line\">-dxdebug.start_with_request=yes \\</span><br><span class=\"line\">artisan serve</span><br></pre></td></tr></table></figure>\n<ol>\n<li>API æ–‡æ¡£ç”Ÿæˆï¼š</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">/**</span><br><span class=\"line\"> * @OA\\Post(</span><br><span class=\"line\"> *     path=&quot;/orders&quot;,</span><br><span class=\"line\"> *     tags=&#123;&quot;Orders&quot;&#125;,</span><br><span class=\"line\"> *     @OA\\RequestBody(</span><br><span class=\"line\"> *         @OA\\JsonContent(ref=&quot;#/components/schemas/OrderRequest&quot;)</span><br><span class=\"line\"> *     ),</span><br><span class=\"line\"> *     @OA\\Response(</span><br><span class=\"line\"> *         response=201,</span><br><span class=\"line\"> *         description=&quot;Order created&quot;,</span><br><span class=\"line\"> *         @OA\\JsonContent(ref=&quot;#/components/schemas/Order&quot;)</span><br><span class=\"line\"> *     ),</span><br><span class=\"line\"> *     @OA\\Response(</span><br><span class=\"line\"> *         response=503,</span><br><span class=\"line\"> *         description=&quot;Service degraded&quot;,</span><br><span class=\"line\"> *         @OA\\JsonContent(ref=&quot;#/components/schemas/Error&quot;)</span><br><span class=\"line\"> *     )</span><br><span class=\"line\"> * )</span><br><span class=\"line\"> */</span><br><span class=\"line\">public function createOrder(Request $request) &#123;</span><br><span class=\"line\">    // ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ol>\n<li>æ€§èƒ½æµ‹è¯•å·¥å…·ï¼š</li>\n</ol>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># ä½¿ç”¨wrkè¿›è¡Œå‹åŠ›æµ‹è¯•</span><br><span class=\"line\">wrk -t4 -c100 -d60s --latency http://localhost:8000/api/orders</span><br><span class=\"line\"></span><br><span class=\"line\"># ç”Ÿæˆç«ç„°å›¾</span><br><span class=\"line\">php -dxdebug.profiler_enable=1 -dxdebug.profiler_output_dir=/tmp \\</span><br><span class=\"line\">-dxdebug.profiler_output_name=cachegrind.out.%p artisan serve</span><br></pre></td></tr></table></figure>\n<p>å…³é”®ä¼˜åŒ–ç‚¹æ€»ç»“</p>\n<ol>\n<li>æœåŠ¡å‘ç°ï¼šé‡‡ç”¨ Consul é›†ç¾¤+å¥åº·æ£€æŸ¥+å®¢æˆ·ç«¯ç¼“å­˜ï¼Œå®ç°ç§’çº§æœåŠ¡çŠ¶æ€æ›´æ–°</li>\n</ol>\n<ul>\n<li><p>æ¶ˆæ¯å¯é ï¼šé€šè¿‡äº‹åŠ¡æ¶ˆæ¯+æ­»ä¿¡é˜Ÿåˆ—+å¹‚ç­‰å¤„ç†ä¿éšœæ¶ˆæ¯ä¸ä¸¢å¤±</p>\n</li>\n<li><p>é…ç½®ç®¡ç†ï¼šApollo é•¿è½®è¯¢+åŠ å¯†å­˜å‚¨+ç‰ˆæœ¬å›æº¯å®ç°å®‰å…¨é…ç½®ä¸­å¿ƒ</p>\n</li>\n<li><p>é™çº§ç­–ç•¥ï¼šå¤šçº§é™çº§ï¼ˆå…¨åŠŸèƒ½ â†’ åªè¯» â†’ ç¼“å­˜ â†’ é™æ€ï¼‰ä¿éšœæ ¸å¿ƒé“¾è·¯</p>\n</li>\n<li><p>å¯è§‚æµ‹æ€§ï¼šPrometheus æŒ‡æ ‡+Jaeger è¿½è¸ª+ELK æ—¥å¿—ä¸‰ä½ä¸€ä½“ç›‘æ§</p>\n</li>\n</ul>\n",
            "tags": [
                "phpæ¶æ„",
                "phpé¡¹ç›®",
                "phpæ¶æ„è®¾è®¡"
            ]
        },
        {
            "id": "https://erik.xyz/2025/07/05/php-architecture01/",
            "url": "https://erik.xyz/2025/07/05/php-architecture01/",
            "title": "phpæ¶æ„æ–¹é¢çš„è®¾è®¡ä¸æ€è€ƒï¼ˆä¸€ï¼‰",
            "date_published": "2025-07-05T03:00:00.000Z",
            "content_html": "<p>PHPçš„å¾®æœåŠ¡æ¶æ„è®¾è®¡ï¼Œæ¶µç›–æœåŠ¡æ³¨å†Œä¸­å¿ƒã€æœåŠ¡è°ƒåº¦ã€æœåŠ¡é™çº§ã€æœåŠ¡ç½‘å…³ã€æœåŠ¡é…ç½®ã€æœåŠ¡æ€»çº¿ç­‰æ ¸å¿ƒæ¨¡å—çš„å®Œæ•´æ¢³ç†å’Œå®ç°æ–¹æ¡ˆï¼š</p>\n<pre class=\"mermaid\">graph TD\n    A[æœåŠ¡ç½‘å…³] --> B[æœåŠ¡æ³¨å†Œä¸­å¿ƒ]\n    A --> C[æœåŠ¡é…ç½®ä¸­å¿ƒ]\n    D[æœåŠ¡æä¾›è€…] --> B\n    E[æœåŠ¡æ¶ˆè´¹è€…] --> B\n    F[æœåŠ¡æ€»çº¿] --> D\n    F --> E\n    G[æœåŠ¡è°ƒåº¦å™¨] --> F\n    H[é™çº§ç®¡ç†å™¨] --> C</pre>\n\n<span id=\"more\"></span>\n<h4 id=\"ä¸€ã€æ¶æ„æ ¸å¿ƒæ¨¡å—ä¸å®ç°æŠ€æœ¯é€‰å‹\"><a href=\"#ä¸€ã€æ¶æ„æ ¸å¿ƒæ¨¡å—ä¸å®ç°æŠ€æœ¯é€‰å‹\" class=\"headerlink\" title=\"ä¸€ã€æ¶æ„æ ¸å¿ƒæ¨¡å—ä¸å®ç°æŠ€æœ¯é€‰å‹\"></a>ä¸€ã€æ¶æ„æ ¸å¿ƒæ¨¡å—ä¸å®ç°æŠ€æœ¯é€‰å‹</h4><div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">æ¨¡å—</th>\n<th style=\"text-align:left\">æ¨èæŠ€æœ¯</th>\n<th style=\"text-align:left\">PHPå¯¹æ¥æ–¹å¼</th>\n<th style=\"text-align:left\">ç‰¹ç‚¹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">æœåŠ¡æ³¨å†Œä¸­å¿ƒ</td>\n<td style=\"text-align:left\">Consulã€Nacos</td>\n<td style=\"text-align:left\">HTTP API/PHPå®¢æˆ·ç«¯åº“</td>\n<td style=\"text-align:left\">æ”¯æŒå¥åº·æ£€æŸ¥ã€æœåŠ¡å‘ç°</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æœåŠ¡ç½‘å…³</td>\n<td style=\"text-align:left\">Kongã€APISIX</td>\n<td style=\"text-align:left\">Nginxä»£ç†/PHPæ’ä»¶</td>\n<td style=\"text-align:left\">åŠ¨æ€è·¯ç”±ã€é™æµã€è®¤è¯</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æœåŠ¡é…ç½®ä¸­å¿ƒ</td>\n<td style=\"text-align:left\">Apolloã€Nacos</td>\n<td style=\"text-align:left\">HTTPé•¿è½®è¯¢/PHP SDK</td>\n<td style=\"text-align:left\">é…ç½®çƒ­æ›´æ–°ã€ç‰ˆæœ¬ç®¡ç†</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æœåŠ¡æ€»çº¿</td>\n<td style=\"text-align:left\">RabbitMQã€Kafka</td>\n<td style=\"text-align:left\">PHPæ‰©å±•(php-amqplib/rdkafka)</td>\n<td style=\"text-align:left\">å¼‚æ­¥è§£è€¦ã€å¯é æ¶ˆæ¯</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æœåŠ¡è°ƒåº¦</td>\n<td style=\"text-align:left\">Workerman/Swoole</td>\n<td style=\"text-align:left\">åŸç”ŸPHPæ”¯æŒ</td>\n<td style=\"text-align:left\">åç¨‹è°ƒåº¦ã€é«˜æ€§èƒ½</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">æœåŠ¡é™çº§</td>\n<td style=\"text-align:left\">ResiliencePHP</td>\n<td style=\"text-align:left\">Composeråº“</td>\n<td style=\"text-align:left\">ç†”æ–­ã€é™æµã€é™çº§</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">åˆ†å¸ƒå¼è¿½è¸ª</td>\n<td style=\"text-align:left\">Jaegerã€Zipkin</td>\n<td style=\"text-align:left\">OpenTracing-PHP</td>\n<td style=\"text-align:left\">å…¨é“¾è·¯ç›‘æ§</td>\n</tr>\n</tbody>\n</table>\n</div>\n<h4 id=\"äºŒã€å„æ¨¡å—å…·ä½“å®ç°æ–¹æ¡ˆ\"><a href=\"#äºŒã€å„æ¨¡å—å…·ä½“å®ç°æ–¹æ¡ˆ\" class=\"headerlink\" title=\"äºŒã€å„æ¨¡å—å…·ä½“å®ç°æ–¹æ¡ˆ\"></a>äºŒã€å„æ¨¡å—å…·ä½“å®ç°æ–¹æ¡ˆ</h4><ol>\n<li><p>æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ˆConsul + PHPï¼‰</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// å®‰è£…Consul PHPå®¢æˆ·ç«¯ï¼šcomposer require sensiolabs/consul-php-sdk</span><br><span class=\"line\">use SensioLabs\\Consul\\ServiceFactory;</span><br><span class=\"line\">use SensioLabs\\Consul\\Services\\AgentInterface;</span><br><span class=\"line\"></span><br><span class=\"line\">$consul = new ServiceFactory([</span><br><span class=\"line\">    &#x27;base_uri&#x27; =&gt; &#x27;http://consul-server:8500&#x27;,</span><br><span class=\"line\">]);</span><br><span class=\"line\"></span><br><span class=\"line\">// æœåŠ¡æ³¨å†Œ</span><br><span class=\"line\">$consul-&gt;get(AgentInterface::class)-&gt;registerService([</span><br><span class=\"line\">    &#x27;ID&#x27; =&gt; &#x27;order-service-001&#x27;,</span><br><span class=\"line\">    &#x27;Name&#x27; =&gt; &#x27;order-service&#x27;,</span><br><span class=\"line\">    &#x27;Address&#x27; =&gt; &#x27;192.168.1.101&#x27;,</span><br><span class=\"line\">    &#x27;Port&#x27; =&gt; 8000,</span><br><span class=\"line\">    &#x27;Check&#x27; =&gt; [</span><br><span class=\"line\">        &#x27;HTTP&#x27; =&gt; &#x27;http://192.168.1.101:8000/health&#x27;,</span><br><span class=\"line\">        &#x27;Interval&#x27; =&gt; &#x27;10s&#x27;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">]);</span><br><span class=\"line\"></span><br><span class=\"line\">// æœåŠ¡å‘ç°</span><br><span class=\"line\">$services = $consul-&gt;getCatalog()-&gt;service(&#x27;order-service&#x27;)-&gt;json();</span><br><span class=\"line\">$instances = array_map(fn($s) =&gt; &quot;&#123;$s[&#x27;ServiceAddress&#x27;]&#125;:&#123;$s[&#x27;ServicePort&#x27;]&#125;&quot;, $services);</span><br></pre></td></tr></table></figure></li>\n<li><p>APIç½‘å…³ï¼ˆKong + PHPï¼‰</p>\n <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># Kongé…ç½®ç¤ºä¾‹</span><br><span class=\"line\">  location /api/ &#123;</span><br><span class=\"line\">    access_by_lua_block &#123;</span><br><span class=\"line\">      -- PHPè®¤è¯æ’ä»¶</span><br><span class=\"line\">      local res = ngx.location.capture(&quot;/auth.php?token=&quot;..ngx.var.arg_token)</span><br><span class=\"line\">      if res.status ~= 200 then</span><br><span class=\"line\">        ngx.exit(401)</span><br><span class=\"line\">      end</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    proxy_pass http://php-upstream;</span><br><span class=\"line\">    proxy_set_header X-Service-Name $route_name;</span><br><span class=\"line\">  &#125;</span><br></pre></td></tr></table></figure></li>\n<li>é…ç½®ä¸­å¿ƒï¼ˆApollo + PHPï¼‰ <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ä½¿ç”¨apollo-client-php</span><br><span class=\"line\">$client = new \\ApolloClient\\Client([</span><br><span class=\"line\">    &#x27;config_server&#x27; =&gt; &#x27;http://apollo-config:8080&#x27;,</span><br><span class=\"line\">    &#x27;app_id&#x27; =&gt; &#x27;user-service&#x27;,</span><br><span class=\"line\">    &#x27;cluster&#x27; =&gt; &#x27;default&#x27;,</span><br><span class=\"line\">]);</span><br><span class=\"line\"></span><br><span class=\"line\">// è·å–é…ç½®</span><br><span class=\"line\">$mysqlConfig = $client-&gt;get(&#x27;mysql.connection&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">// ç›‘å¬é…ç½®å˜æ›´</span><br><span class=\"line\">$client-&gt;listen(function($key, $value) &#123;</span><br><span class=\"line\">    if ($key === &#x27;feature_toggle&#x27;) &#123;</span><br><span class=\"line\">        FeatureToggle::update($value);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure></li>\n<li>æœåŠ¡æ€»çº¿ï¼ˆRabbitMQ + PHPï¼‰ <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ç”Ÿäº§è€…</span><br><span class=\"line\">$connection = new AMQPStreamConnection(&#x27;rabbitmq&#x27;, 5672, &#x27;guest&#x27;, &#x27;guest&#x27;);</span><br><span class=\"line\">$channel = $connection-&gt;channel();</span><br><span class=\"line\">$channel-&gt;queue_declare(&#x27;order_events&#x27;, false, true, false, false);</span><br><span class=\"line\"></span><br><span class=\"line\">$msg = new AMQPMessage(json_encode([</span><br><span class=\"line\">    &#x27;event&#x27; =&gt; &#x27;ORDER_CREATED&#x27;,</span><br><span class=\"line\">    &#x27;data&#x27; =&gt; [&#x27;id&#x27; =&gt; 123]</span><br><span class=\"line\">]), [&#x27;delivery_mode&#x27; =&gt; 2]);</span><br><span class=\"line\"></span><br><span class=\"line\">$channel-&gt;basic_publish($msg, &#x27;&#x27;, &#x27;order_events&#x27;);</span><br><span class=\"line\"></span><br><span class=\"line\">// æ¶ˆè´¹è€…</span><br><span class=\"line\">$channel-&gt;basic_consume(&#x27;order_events&#x27;, &#x27;&#x27;, false, false, false, false, </span><br><span class=\"line\">    function($msg) &#123;</span><br><span class=\"line\">        $event = json_decode($msg-&gt;body, true);</span><br><span class=\"line\">        EventDispatcher::dispatch($event);</span><br><span class=\"line\">        $msg-&gt;ack();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure></li>\n<li>æœåŠ¡é™çº§ï¼ˆResiliencePHPï¼‰ <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use Resilience\\Retry;</span><br><span class=\"line\">use Resilience\\CircuitBreaker;</span><br><span class=\"line\"></span><br><span class=\"line\">// ç†”æ–­å™¨é…ç½®</span><br><span class=\"line\">$circuitBreaker = CircuitBreaker::builder()</span><br><span class=\"line\">    -&gt;withFailureRateThreshold(50)</span><br><span class=\"line\">    -&gt;withWaitDuration(10000)</span><br><span class=\"line\">    -&gt;build();</span><br><span class=\"line\"></span><br><span class=\"line\">// å¸¦ç†”æ–­çš„é‡è¯•æœºåˆ¶</span><br><span class=\"line\">$result = Retry::with(Retry::maxAttempts(3))</span><br><span class=\"line\">    -&gt;decorate($circuitBreaker)</span><br><span class=\"line\">    -&gt;run(function() use ($service) &#123;</span><br><span class=\"line\">        return $service-&gt;callApi();</span><br><span class=\"line\">    &#125;, function($e) &#123;</span><br><span class=\"line\">        // é™çº§å¤„ç†</span><br><span class=\"line\">        return [&#x27;status&#x27; =&gt; &#x27;degraded&#x27;, &#x27;data&#x27; =&gt; cached_data()];</span><br><span class=\"line\">    &#125;);</span><br></pre></td></tr></table></figure></li>\n<li>åˆ†å¸ƒå¼è°ƒåº¦ï¼ˆSwooleåç¨‹ï¼‰ <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">use Swoole\\Coroutine;</span><br><span class=\"line\"></span><br><span class=\"line\">// å¹¶å‘è°ƒç”¨å¤šä¸ªæœåŠ¡</span><br><span class=\"line\">Coroutine\\run(function() &#123;</span><br><span class=\"line\">    $results = [];</span><br><span class=\"line\">    $wg = new Coroutine\\WaitGroup();</span><br><span class=\"line\"></span><br><span class=\"line\">    $services = [&#x27;inventory&#x27;, &#x27;payment&#x27;, &#x27;notification&#x27;];</span><br><span class=\"line\"></span><br><span class=\"line\">    foreach ($services as $service) &#123;</span><br><span class=\"line\">        $wg-&gt;add();</span><br><span class=\"line\">        go(function() use ($service, &amp;$results, $wg) &#123;</span><br><span class=\"line\">            $results[$service] = callService($service);</span><br><span class=\"line\">            $wg-&gt;done();</span><br><span class=\"line\">        &#125;);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    $wg-&gt;wait();</span><br><span class=\"line\"></span><br><span class=\"line\">    // å¤„ç†èšåˆç»“æœ</span><br><span class=\"line\">    processResults($results);</span><br><span class=\"line\">&#125;);</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h4 id=\"ä¸‰ã€å®Œæ•´æ¶æ„éƒ¨ç½²æ–¹æ¡ˆ\"><a href=\"#ä¸‰ã€å®Œæ•´æ¶æ„éƒ¨ç½²æ–¹æ¡ˆ\" class=\"headerlink\" title=\"ä¸‰ã€å®Œæ•´æ¶æ„éƒ¨ç½²æ–¹æ¡ˆ\"></a>ä¸‰ã€å®Œæ•´æ¶æ„éƒ¨ç½²æ–¹æ¡ˆ</h4><pre class=\"mermaid\">graph LR\n    A[å®¢æˆ·ç«¯] --> B[Kongç½‘å…³]\n    B --> C[è®¤è¯æœåŠ¡]\n    B --> D[ç”¨æˆ·æœåŠ¡]\n    B --> E[è®¢å•æœåŠ¡]\n    B --> F[æ”¯ä»˜æœåŠ¡]\n\n    subgraph å¾®æœåŠ¡é›†ç¾¤\n        C -->|æ³¨å†Œ| H[Consul]\n        D -->|æ³¨å†Œ| H\n        E -->|æ³¨å†Œ| H\n        F -->|æ³¨å†Œ| H\n\n        C -->|é…ç½®| I[Apollo]\n        D -->|é…ç½®| I\n        E -->|é…ç½®| I\n        F -->|é…ç½®| I\n\n        E -->|æ¶ˆæ¯| J[RabbitMQ]\n        J --> F\n        J --> K[é€šçŸ¥æœåŠ¡]\n    end\n\n    H --> L[Prometheusç›‘æ§]\n    I --> L\n    J --> L\n    L --> M[Grafana]</pre>\n\n<h4 id=\"å››ã€å…³é”®ç»„ä»¶å®‰è£…ä¸é…ç½®\"><a href=\"#å››ã€å…³é”®ç»„ä»¶å®‰è£…ä¸é…ç½®\" class=\"headerlink\" title=\"å››ã€å…³é”®ç»„ä»¶å®‰è£…ä¸é…ç½®\"></a>å››ã€å…³é”®ç»„ä»¶å®‰è£…ä¸é…ç½®</h4><ol>\n<li>åŸºç¡€è®¾æ–½éƒ¨ç½²ï¼ˆDockerç¤ºä¾‹ï¼‰ <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"># docker-compose.yml</span><br><span class=\"line\">version: &#x27;3&#x27;</span><br><span class=\"line\"></span><br><span class=\"line\">services:</span><br><span class=\"line\">  consul:</span><br><span class=\"line\">    image: consul:latest</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - &quot;8500:8500&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">  kong:</span><br><span class=\"line\">    image: kong:latest</span><br><span class=\"line\">    depends_on:</span><br><span class=\"line\">      - postgres</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - &quot;8000:8000&quot;</span><br><span class=\"line\">      - &quot;8001:8001&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">  apollo:</span><br><span class=\"line\">    image: apolloconfig/apollo-portal</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - &quot;8070:8070&quot;</span><br><span class=\"line\"></span><br><span class=\"line\">  rabbitmq:</span><br><span class=\"line\">    image: rabbitmq:management</span><br><span class=\"line\">    ports:</span><br><span class=\"line\">      - &quot;5672:5672&quot;</span><br><span class=\"line\">      - &quot;15672:15672&quot;</span><br></pre></td></tr></table></figure></li>\n<li><p>PHPæœåŠ¡Dockerfile</p>\n <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">FROM php:8.2-fpm</span><br><span class=\"line\"></span><br><span class=\"line\"># å®‰è£…å¿…è¦æ‰©å±•</span><br><span class=\"line\">RUN apt-get update &amp;&amp; apt-get install -y \\</span><br><span class=\"line\">    libzip-dev \\</span><br><span class=\"line\">    librabbitmq-dev \\</span><br><span class=\"line\">    &amp;&amp; docker-php-ext-install zip pdo_mysql \\</span><br><span class=\"line\">    &amp;&amp; pecl install amqp \\</span><br><span class=\"line\">    &amp;&amp; docker-php-ext-enable amqp</span><br><span class=\"line\"></span><br><span class=\"line\"># å®‰è£…Composer</span><br><span class=\"line\">COPY --from=composer:latest /usr/bin/composer /usr/bin/composer</span><br><span class=\"line\"></span><br><span class=\"line\">WORKDIR /var/www</span><br><span class=\"line\">COPY . .</span><br><span class=\"line\">RUN composer install --no-dev --optimize-autoloader</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n<h4 id=\"äº”ã€ç”Ÿäº§ç¯å¢ƒå»ºè®®\"><a href=\"#äº”ã€ç”Ÿäº§ç¯å¢ƒå»ºè®®\" class=\"headerlink\" title=\"äº”ã€ç”Ÿäº§ç¯å¢ƒå»ºè®®\"></a>äº”ã€ç”Ÿäº§ç¯å¢ƒå»ºè®®</h4><ol>\n<li><p>æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼š</p>\n<ul>\n<li><p>ä½¿ç”¨Consulé›†ç¾¤ï¼ˆè‡³å°‘3èŠ‚ç‚¹ï¼‰</p>\n</li>\n<li><p>å¼€å¯ACLå®‰å…¨æ§åˆ¶</p>\n</li>\n<li><p>é›†æˆPrometheusç›‘æ§</p>\n</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li><p>ç½‘å…³å±‚ï¼š</p>\n<ul>\n<li><p>Kongé›†ç¾¤ + Nginxè´Ÿè½½å‡è¡¡</p>\n</li>\n<li><p>å¯ç”¨JWTè®¤è¯æ’ä»¶</p>\n</li>\n<li><p>é…ç½®é€Ÿç‡é™åˆ¶ï¼ˆ1000rps/æœåŠ¡ï¼‰</p>\n</li>\n</ul>\n</li>\n<li><p>é…ç½®ç®¡ç†ï¼š</p>\n<ul>\n<li><p>Apolloå¤šç¯å¢ƒé…ç½®ï¼ˆDEV/TEST/PRODï¼‰</p>\n</li>\n<li><p>æ•æ„Ÿé…ç½®åŠ å¯†å­˜å‚¨</p>\n</li>\n<li><p>é…ç½®å˜æ›´å®¡è®¡æ—¥å¿—</p>\n</li>\n</ul>\n</li>\n<li><p>æœåŠ¡é€šä¿¡ï¼š</p>\n<ul>\n<li><p>åŒæ­¥è°ƒç”¨ï¼šHTTP/2 + Protobuf</p>\n</li>\n<li><p>å¼‚æ­¥æ¶ˆæ¯ï¼šRabbitMQé•œåƒé˜Ÿåˆ—</p>\n</li>\n<li><p>æœåŠ¡ç½‘æ ¼ï¼šIstioï¼ˆå¯é€‰ï¼‰</p>\n</li>\n</ul>\n</li>\n<li><p>å¯è§‚æµ‹æ€§ï¼š</p>\n<ul>\n<li><p>æ—¥å¿—ï¼šELKæ”¶é›†Nginx/PHPæ—¥å¿—</p>\n</li>\n<li><p>æŒ‡æ ‡ï¼šPrometheusæ”¶é›†æœåŠ¡æŒ‡æ ‡</p>\n</li>\n<li><p>è¿½è¸ªï¼šJaegerå®ç°å…¨é“¾è·¯è¿½è¸ª</p>\n</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"å…­ã€PHPå¾®æœåŠ¡å¼€å‘å·¥å…·åŒ…\"><a href=\"#å…­ã€PHPå¾®æœåŠ¡å¼€å‘å·¥å…·åŒ…\" class=\"headerlink\" title=\"å…­ã€PHPå¾®æœåŠ¡å¼€å‘å·¥å…·åŒ…\"></a>å…­ã€PHPå¾®æœåŠ¡å¼€å‘å·¥å…·åŒ…</h4><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer require:</span><br><span class=\"line\">  sensiolabs/consul-php-sdk     # Consulå®¢æˆ·ç«¯</span><br><span class=\"line\">  guzzlehttp/guzzle             # HTTPå®¢æˆ·ç«¯</span><br><span class=\"line\">  php-amqplib/php-amqplib       # RabbitMQ</span><br><span class=\"line\">  kwn/php-jaeger-client         # Jaegerè¿½è¸ª</span><br><span class=\"line\">  resilience-php/resilience-php # ç†”æ–­é™çº§</span><br><span class=\"line\">  ext-swoole                    # åç¨‹è°ƒåº¦</span><br></pre></td></tr></table></figure>",
            "tags": [
                "phpæ¶æ„",
                "phpæœåŠ¡",
                "phpæœåŠ¡è®¾è®¡"
            ]
        },
        {
            "id": "https://erik.xyz/2025/06/27/emm-mdm-systems/",
            "url": "https://erik.xyz/2025/06/27/emm-mdm-systems/",
            "title": "EMMä¸MDMç³»ç»Ÿè¯¦è§£",
            "date_published": "2025-06-27T02:12:00.000Z",
            "content_html": "<p>EMMï¼ˆEnterprise Mobility Managementï¼Œä¼ä¸šç§»åŠ¨åŒ–ç®¡ç†ï¼‰å’ŒMDMï¼ˆMobile Device Managementï¼Œç§»åŠ¨è®¾å¤‡ç®¡ç†ï¼‰æ˜¯ä¼ä¸šç”¨äºå®‰å…¨ç®¡ç†ç§»åŠ¨è®¾å¤‡ã€åº”ç”¨åŠæ•°æ®çš„æ ¸å¿ƒæŠ€æœ¯ä½“ç³»ã€‚ä¸‹é¢ä»å®šä¹‰ã€åŠŸèƒ½ã€æ¼”è¿›å’Œåº”ç”¨åœºæ™¯ç­‰æ–¹é¢è¿›è¡Œç³»ç»Ÿè¯´æ˜ï¼š</p>\n<p>ğŸ“± ä¸€ã€æ ¸å¿ƒæ¦‚å¿µ<br>MDMï¼ˆç§»åŠ¨è®¾å¤‡ç®¡ç†ï¼‰<br><span id=\"more\"></span></p>\n<p>å®šä¹‰ï¼šä¸“æ³¨äºç§»åŠ¨è®¾å¤‡ï¼ˆå¦‚æ‰‹æœºã€å¹³æ¿ï¼‰çš„å…¨ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒåŒ…æ‹¬æ³¨å†Œã€é…ç½®ã€ç›‘æ§ã€è¿œç¨‹æ§åˆ¶ï¼ˆå¦‚é”å®š/æ“¦é™¤ï¼‰åŠåœç”¨146ã€‚</p>\n<p>é€‚ç”¨åœºæ™¯ï¼šé€‚ç”¨äºä¼ä¸šç»Ÿä¸€é…å‘çš„è®¾å¤‡ï¼ˆå¦‚ç‰©æµæ‰‹æŒç»ˆç«¯ã€å…¬å¸æ‰‹æœºï¼‰ï¼Œéœ€å®Œå…¨æ§åˆ¶ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿ39ã€‚</p>\n<p>EMMï¼ˆä¼ä¸šç§»åŠ¨åŒ–ç®¡ç†ï¼‰</p>\n<p>å®šä¹‰ï¼šMDMçš„æ‰©å±•ï¼Œæ˜¯ä¸€å¥—ç»¼åˆè§£å†³æ–¹æ¡ˆï¼Œé™¤è®¾å¤‡ç®¡ç†å¤–ï¼Œè¿˜åŒ…å«ç§»åŠ¨åº”ç”¨ç®¡ç†ï¼ˆMAMï¼‰ã€ç§»åŠ¨å†…å®¹ç®¡ç†ï¼ˆMCMï¼‰ã€ç§»åŠ¨èº«ä»½ç®¡ç†ï¼ˆMIMï¼‰ç­‰ç»„ä»¶ï¼Œç›®æ ‡æ˜¯åœ¨ä¿éšœå®‰å…¨çš„å‰æä¸‹æå‡ç§»åŠ¨åŠå…¬æ•ˆç‡189ã€‚</p>\n<p>æ ¸å¿ƒèƒ½åŠ›ï¼šæ”¯æŒBYODï¼ˆè‡ªå¸¦è®¾å¤‡åŠå…¬ï¼‰ï¼Œé€šè¿‡â€œå®¹å™¨åŒ–â€æŠ€æœ¯éš”ç¦»ä¼ä¸šæ•°æ®ä¸ä¸ªäººæ•°æ®ï¼Œå®ç°ç»†ç²’åº¦æ§åˆ¶ï¼ˆå¦‚ä»…æ“¦é™¤ä¼ä¸šåº”ç”¨æ•°æ®ï¼‰59ã€‚</p>\n<p>âš™ï¸ äºŒã€æ ¸å¿ƒåŠŸèƒ½ç»„ä»¶<br>EMMé€šè¿‡ä»¥ä¸‹æ¨¡å—ååŒå·¥ä½œï¼š</p>\n<p>MDMï¼šè®¾å¤‡æ³¨å†Œã€ç­–ç•¥é…ç½®ï¼ˆå¯†ç å¤æ‚åº¦ã€åŠ å¯†ï¼‰ã€è¿œç¨‹æ“¦é™¤16ã€‚</p>\n<p>MAMï¼ˆç§»åŠ¨åº”ç”¨ç®¡ç†ï¼‰ï¼š</p>\n<p>ä¼ä¸šåº”ç”¨å•†åº—åˆ†å‘ã€é™é»˜å®‰è£…/æ›´æ–°ï¼›</p>\n<p>æ§åˆ¶åº”ç”¨æƒé™ï¼ˆå¦‚ç¦æ­¢æˆªå±/ç²˜è´´ï¼‰19ã€‚</p>\n<p>MCMï¼ˆç§»åŠ¨å†…å®¹ç®¡ç†ï¼‰ï¼š</p>\n<p>å®‰å…¨åˆ†å‘ä¼ä¸šæ–‡ä»¶ï¼ˆå¦‚åˆåŒã€æŠ¥è¡¨ï¼‰ï¼›</p>\n<p>æ•°æ®åŠ å¯†å­˜å‚¨ï¼Œé™åˆ¶åˆ†äº«è‡³éæˆæƒåº”ç”¨18ã€‚</p>\n<p>MIMï¼ˆç§»åŠ¨èº«ä»½ç®¡ç†ï¼‰ï¼š</p>\n<p>å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰ã€å¤šå› ç´ è®¤è¯ï¼›</p>\n<p>åŸºäºè§’è‰²/è®¾å¤‡çŠ¶æ€åŠ¨æ€è°ƒæ•´è®¿é—®æƒé™18ã€‚</p>\n<p>ğŸ“Š ä¸‰ã€MDMä¸EMMçš„åŒºåˆ«<br>ç»´åº¦    MDM    EMM<br>ç®¡ç†å¯¹è±¡    è®¾å¤‡ç¡¬ä»¶åŠæ“ä½œç³»ç»Ÿ    è®¾å¤‡+åº”ç”¨+æ•°æ®+èº«ä»½<br>æ§åˆ¶ç²’åº¦    è®¾å¤‡çº§ï¼ˆå…¨ç›˜æ§åˆ¶ï¼‰    åº”ç”¨/æ•°æ®çº§ï¼ˆå¦‚ä»…ç®¡ç†ä¼ä¸šå®¹å™¨ï¼‰<br>é€‚ç”¨åœºæ™¯    ä¼ä¸šç»Ÿä¸€é…å‘è®¾å¤‡ï¼ˆCOBO/COPEï¼‰    BYODï¼ˆå‘˜å·¥ä¸ªäººè®¾å¤‡ï¼‰ä¸ºä¸»<br>éšç§å…¼å®¹æ€§    ä½ï¼ˆéœ€å®Œå…¨æ§åˆ¶è®¾å¤‡ï¼‰    é«˜ï¼ˆéš”ç¦»ä¼ä¸šæ•°æ®ï¼Œä¿æŠ¤ä¸ªäººéšç§ï¼‰<br>æ¼”è¿›å…³ç³»    EMMçš„åŸºç¡€ç»„ä»¶    MDMçš„æ‰©å±•ä¸å‡çº§<br>ç¤ºä¾‹ï¼šåœ¨BYODåœºæ™¯ä¸­ï¼ŒEMMå…è®¸å‘˜å·¥ç”¨ä¸ªäººæ‰‹æœºè®¿é—®ä¼ä¸šé‚®ç®±ï¼Œä½†ä»…å¯¹ä¼ä¸šé‚®ç®±Appå†…çš„æ•°æ®åŠ å¯†å¹¶è¿œç¨‹æ“¦é™¤ï¼Œä¸å½±å“ä¸ªäººç…§ç‰‡ç­‰éšç§å†…å®¹59ã€‚</p>\n<p>â³ å››ã€æŠ€æœ¯æ¼”è¿›ï¼šä»MDMåˆ°EMM<br>ç§»åŠ¨ç®¡ç†æŠ€æœ¯ç»å†äº†ä¸‰ä¸ªé˜¶æ®µï¼š</p>\n<p>è®¾å¤‡é©±åŠ¨é˜¶æ®µï¼ˆ2007-2012ï¼‰ï¼šMDMä¸»å¯¼ï¼ŒåŠŸèƒ½é™äºè®¾å¤‡æ³¨å†Œã€å¯†ç ç­–ç•¥ã€è¿œç¨‹æ“¦é™¤210ã€‚</p>\n<p>åº”ç”¨ç®¡ç†é˜¶æ®µï¼ˆ2011-2013ï¼‰ï¼šMAMå…´èµ·ï¼Œå¼•å…¥æ²™ç®±/å®¹å™¨éš”ç¦»ä¼ä¸šåº”ç”¨æ•°æ®ï¼Œé€‚åº”BYODéœ€æ±‚25ã€‚</p>\n<p>å†…å®¹ä¸èº«ä»½èåˆé˜¶æ®µï¼ˆ2013è‡³ä»Šï¼‰ï¼š</p>\n<p>EMMæ•´åˆMCM/MIMï¼Œå®ç°åŸºäºè§’è‰²ã€ä½ç½®ã€è®¾å¤‡çŠ¶æ€çš„åŠ¨æ€ç­–ç•¥ï¼ˆå¦‚â€œå‡ºå·®æ—¶ç¦æ­¢è®¿é—®è´¢åŠ¡ç³»ç»Ÿâ€ï¼‰10ï¼›</p>\n<p>å‘UEMï¼ˆç»Ÿä¸€ç«¯ç‚¹ç®¡ç†ï¼‰æ¼”è¿›ï¼Œè¦†ç›–PCã€IoTç­‰æ›´å¤šç»ˆç«¯35ã€‚</p>\n<p>ğŸ¢ äº”ã€ä¼ä¸šåº”ç”¨ä»·å€¼<br>å®‰å…¨æå‡ï¼šé˜²æ­¢æ•°æ®æ³„éœ²ï¼ˆå¦‚é˜»æ–­ä¼ä¸šæ–‡ä»¶ä¿å­˜è‡³ä¸ªäººäº‘ç›˜ï¼‰ã€æŠµå¾¡è¶Šç‹±/rootè®¾å¤‡é£é™©16ã€‚</p>\n<p>æ•ˆç‡ä¼˜åŒ–ï¼š</p>\n<p>è‡ªåŠ¨åˆ†å‘åº”ç”¨ï¼ˆå¦‚é”€å”®å›¢é˜Ÿç»Ÿä¸€å®‰è£…CRMå·¥å…·ï¼‰ï¼›</p>\n<p>è¿œç¨‹æ•…éšœæ’æŸ¥ï¼Œå‡å°‘ç°åœºæ”¯æŒæˆæœ¬9ã€‚</p>\n<p>åˆè§„æ”¯æŒï¼šæ»¡è¶³GDPRç­‰æ³•è§„è¦æ±‚ï¼Œå®¡è®¡æ—¥å¿—è®°å½•æ•æ„Ÿæ“ä½œ68ã€‚</p>\n<p>ğŸ’ æ€»ç»“<br>MDMæ˜¯ç§»åŠ¨ç®¡ç†çš„èµ·ç‚¹ï¼Œèšç„¦è®¾å¤‡æ§åˆ¶ï¼›EMMæ˜¯æ›´æˆç†Ÿçš„è§£å†³æ–¹æ¡ˆï¼Œé€šè¿‡åº”ç”¨/æ•°æ®/èº«ä»½çš„ç²¾ç»†ç®¡ç†ï¼Œåœ¨å®‰å…¨ä¸å‘˜å·¥ä½“éªŒé—´å–å¾—å¹³è¡¡ã€‚éšç€è¿œç¨‹åŠå…¬æ™®åŠï¼ŒEMMå·²æˆä¸ºä¼ä¸šç§»åŠ¨åŒ–è½¬å‹çš„æ ¸å¿ƒåŸºç¡€è®¾æ–½ï¼Œå¹¶æŒç»­å‘è·¨ç»ˆç«¯ã€æ™ºèƒ½åŒ–çš„UEMæ–¹å‘æ¼”è¿›358ã€‚</p>\n",
            "tags": [
                "ç³»ç»Ÿ",
                "emm",
                "mdm"
            ]
        },
        {
            "id": "https://erik.xyz/2025/06/10/php-game-fish/",
            "url": "https://erik.xyz/2025/06/10/php-game-fish/",
            "title": "phpå¼€å‘æ•é±¼æ¸¸æˆçš„æ„æ€",
            "date_published": "2025-06-10T15:09:00.000Z",
            "content_html": "<p>ä½¿ç”¨PHPå¼€å‘æ•é±¼æ¸¸æˆæ¶‰åŠå‰åç«¯åä½œï¼Œä»¥ä¸‹æ˜¯æ ¸å¿ƒå®ç°æ€è·¯å’Œä»£ç ç¤ºä¾‹ï¼š</p>\n<h3 id=\"ä¸€ã€ç³»ç»Ÿè®¾è®¡\"><a href=\"#ä¸€ã€ç³»ç»Ÿè®¾è®¡\" class=\"headerlink\" title=\"ä¸€ã€ç³»ç»Ÿè®¾è®¡\"></a>ä¸€ã€ç³»ç»Ÿè®¾è®¡</h3><ol>\n<li><strong>å‰ç«¯</strong>ï¼šHTML5 Canvas + JavaScript ç»˜åˆ¶æ¸¸æˆåœºæ™¯</li>\n<li><strong>åç«¯</strong>ï¼šPHP å¤„ç†æ¸¸æˆé€»è¾‘å’Œæ•°æ®åº“æ“ä½œ</li>\n<li><strong>æ•°æ®åº“</strong>ï¼šMySQL å­˜å‚¨ç©å®¶æ•°æ®</li>\n<li><strong>é€šä¿¡</strong>ï¼šAJAX å®ç°å‰åç«¯äº¤äº’</li>\n</ol>\n<h3 id=\"äºŒã€æ ¸å¿ƒåŠŸèƒ½å®ç°\"><a href=\"#äºŒã€æ ¸å¿ƒåŠŸèƒ½å®ç°\" class=\"headerlink\" title=\"äºŒã€æ ¸å¿ƒåŠŸèƒ½å®ç°\"></a>äºŒã€æ ¸å¿ƒåŠŸèƒ½å®ç°</h3><span id=\"more\"></span>\n<h4 id=\"1-æ•°æ®åº“è®¾è®¡ï¼ˆMySQLï¼‰\"><a href=\"#1-æ•°æ®åº“è®¾è®¡ï¼ˆMySQLï¼‰\" class=\"headerlink\" title=\"1. æ•°æ®åº“è®¾è®¡ï¼ˆMySQLï¼‰\"></a>1. æ•°æ®åº“è®¾è®¡ï¼ˆMySQLï¼‰</h4><figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">CREATE TABLE</span> players (</span><br><span class=\"line\">    id <span class=\"type\">INT</span> AUTO_INCREMENT <span class=\"keyword\">PRIMARY KEY</span>,</span><br><span class=\"line\">    username <span class=\"type\">VARCHAR</span>(<span class=\"number\">50</span>) <span class=\"keyword\">UNIQUE</span>,</span><br><span class=\"line\">    password <span class=\"type\">VARCHAR</span>(<span class=\"number\">255</span>),</span><br><span class=\"line\">    gold <span class=\"type\">INT</span> <span class=\"keyword\">DEFAULT</span> <span class=\"number\">1000</span>,</span><br><span class=\"line\">    score <span class=\"type\">INT</span> <span class=\"keyword\">DEFAULT</span> <span class=\"number\">0</span></span><br><span class=\"line\">);</span><br></pre></td></tr></table></figure>\n<h4 id=\"2-PHPåç«¯é€»è¾‘ï¼ˆç»“åˆå‰ç«¯äº¤äº’ï¼‰\"><a href=\"#2-PHPåç«¯é€»è¾‘ï¼ˆç»“åˆå‰ç«¯äº¤äº’ï¼‰\" class=\"headerlink\" title=\"2. PHPåç«¯é€»è¾‘ï¼ˆç»“åˆå‰ç«¯äº¤äº’ï¼‰\"></a>2. PHPåç«¯é€»è¾‘ï¼ˆç»“åˆå‰ç«¯äº¤äº’ï¼‰</h4><p><strong>æ¸¸æˆæ ¸å¿ƒæ–‡ä»¶ï¼š<code>game.php</code></strong><br><figure class=\"highlight php\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&lt;?php</span></span><br><span class=\"line\"><span class=\"title function_ invoke__\">session_start</span>();</span><br><span class=\"line\"><span class=\"comment\">// è¿æ¥æ•°æ®åº“</span></span><br><span class=\"line\"><span class=\"variable\">$db</span> = <span class=\"keyword\">new</span> <span class=\"title function_ invoke__\">mysqli</span>(<span class=\"string\">&#x27;localhost&#x27;</span>, <span class=\"string\">&#x27;username&#x27;</span>, <span class=\"string\">&#x27;password&#x27;</span>, <span class=\"string\">&#x27;fishing_game&#x27;</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">FishingGame</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"variable\">$db</span>;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">__construct</span>(<span class=\"params\"><span class=\"variable\">$db</span></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;db = <span class=\"variable\">$db</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"comment\">// æ•é±¼é€»è¾‘</span></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">catchFish</span>(<span class=\"params\"><span class=\"variable\">$playerId</span>, <span class=\"variable\">$cannonType</span>, <span class=\"variable\">$fishType</span></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$cost</span> = <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">getCannonCost</span>(<span class=\"variable\">$cannonType</span>);</span><br><span class=\"line\">        <span class=\"variable\">$reward</span> = <span class=\"variable language_\">$this</span>-&gt;<span class=\"title function_ invoke__\">getFishReward</span>(<span class=\"variable\">$fishType</span>);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// æ‰£é™¤é‡‘å¸</span></span><br><span class=\"line\">        <span class=\"variable language_\">$this</span>-&gt;db-&gt;<span class=\"title function_ invoke__\">query</span>(<span class=\"string\">&quot;UPDATE players SET gold = gold - <span class=\"subst\">$cost</span> WHERE id = <span class=\"subst\">$playerId</span>&quot;</span>);</span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"comment\">// æ•è·åˆ¤å®šï¼ˆç®€åŒ–ç‰ˆæ¦‚ç‡è®¡ç®—ï¼‰</span></span><br><span class=\"line\">        <span class=\"variable\">$success</span> = (<span class=\"title function_ invoke__\">rand</span>(<span class=\"number\">1</span>, <span class=\"number\">100</span>) &gt; <span class=\"number\">30</span>); <span class=\"comment\">// 70%æˆåŠŸç‡</span></span><br><span class=\"line\">        </span><br><span class=\"line\">        <span class=\"keyword\">if</span>(<span class=\"variable\">$success</span>) &#123;</span><br><span class=\"line\">            <span class=\"variable language_\">$this</span>-&gt;db-&gt;<span class=\"title function_ invoke__\">query</span>(<span class=\"string\">&quot;UPDATE players SET gold = gold + <span class=\"subst\">$reward</span>, score = score + <span class=\"subst\">$reward</span> WHERE id = <span class=\"subst\">$playerId</span>&quot;</span>);</span><br><span class=\"line\">            <span class=\"keyword\">return</span> [<span class=\"string\">&#x27;success&#x27;</span> =&gt; <span class=\"literal\">true</span>, <span class=\"string\">&#x27;reward&#x27;</span> =&gt; <span class=\"variable\">$reward</span>];</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> [<span class=\"string\">&#x27;success&#x27;</span> =&gt; <span class=\"literal\">false</span>];</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getCannonCost</span>(<span class=\"params\"><span class=\"variable\">$type</span></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$costs</span> = [<span class=\"number\">1</span> =&gt; <span class=\"number\">5</span>, <span class=\"number\">2</span> =&gt; <span class=\"number\">10</span>, <span class=\"number\">3</span> =&gt; <span class=\"number\">20</span>]; <span class=\"comment\">// ç‚®å¼¹ç±»å‹å¯¹åº”æ¶ˆè€—</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable\">$costs</span>[<span class=\"variable\">$type</span>] ?? <span class=\"number\">5</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"function\"><span class=\"keyword\">function</span> <span class=\"title\">getFishReward</span>(<span class=\"params\"><span class=\"variable\">$type</span></span>) </span>&#123;</span><br><span class=\"line\">        <span class=\"variable\">$rewards</span> = [<span class=\"number\">1</span> =&gt; <span class=\"number\">10</span>, <span class=\"number\">2</span> =&gt; <span class=\"number\">25</span>, <span class=\"number\">3</span> =&gt; <span class=\"number\">50</span>]; <span class=\"comment\">// é±¼ç±»å¥–åŠ±</span></span><br><span class=\"line\">        <span class=\"keyword\">return</span> <span class=\"variable\">$rewards</span>[<span class=\"variable\">$type</span>] ?? <span class=\"number\">10</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å®ä¾‹åŒ–æ¸¸æˆ</span></span><br><span class=\"line\"><span class=\"variable\">$game</span> = <span class=\"keyword\">new</span> <span class=\"title class_\">FishingGame</span>(<span class=\"variable\">$db</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// å¤„ç†AJAXè¯·æ±‚</span></span><br><span class=\"line\"><span class=\"keyword\">if</span> (<span class=\"variable\">$_SERVER</span>[<span class=\"string\">&#x27;REQUEST_METHOD&#x27;</span>] === <span class=\"string\">&#x27;POST&#x27;</span>) &#123;</span><br><span class=\"line\">    <span class=\"variable\">$playerId</span> = <span class=\"variable\">$_SESSION</span>[<span class=\"string\">&#x27;player_id&#x27;</span>];</span><br><span class=\"line\">    <span class=\"variable\">$data</span> = <span class=\"title function_ invoke__\">json_decode</span>(<span class=\"title function_ invoke__\">file_get_contents</span>(<span class=\"string\">&#x27;php://input&#x27;</span>), <span class=\"literal\">true</span>);</span><br><span class=\"line\">    </span><br><span class=\"line\">    <span class=\"keyword\">if</span>(<span class=\"keyword\">isset</span>(<span class=\"variable\">$data</span>[<span class=\"string\">&#x27;action&#x27;</span>]) &amp;&amp; <span class=\"variable\">$data</span>[<span class=\"string\">&#x27;action&#x27;</span>] === <span class=\"string\">&#x27;catch&#x27;</span>) &#123;</span><br><span class=\"line\">        <span class=\"variable\">$response</span> = <span class=\"variable\">$game</span>-&gt;<span class=\"title function_ invoke__\">catchFish</span>(</span><br><span class=\"line\">            <span class=\"variable\">$playerId</span>,</span><br><span class=\"line\">            <span class=\"variable\">$data</span>[<span class=\"string\">&#x27;cannon&#x27;</span>],</span><br><span class=\"line\">            <span class=\"variable\">$data</span>[<span class=\"string\">&#x27;fishType&#x27;</span>]</span><br><span class=\"line\">        );</span><br><span class=\"line\">        <span class=\"title function_ invoke__\">header</span>(<span class=\"string\">&#x27;Content-Type: application/json&#x27;</span>);</span><br><span class=\"line\">        <span class=\"keyword\">echo</span> <span class=\"title function_ invoke__\">json_encode</span>(<span class=\"variable\">$response</span>);</span><br><span class=\"line\">        <span class=\"keyword\">exit</span>;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"meta\">?&gt;</span></span><br></pre></td></tr></table></figure></p>\n<h4 id=\"3-å‰ç«¯æ ¸å¿ƒå®ç°ï¼ˆJavaScriptï¼‰\"><a href=\"#3-å‰ç«¯æ ¸å¿ƒå®ç°ï¼ˆJavaScriptï¼‰\" class=\"headerlink\" title=\"3. å‰ç«¯æ ¸å¿ƒå®ç°ï¼ˆJavaScriptï¼‰\"></a>3. å‰ç«¯æ ¸å¿ƒå®ç°ï¼ˆJavaScriptï¼‰</h4><figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">canvas</span> <span class=\"attr\">id</span>=<span class=\"string\">&quot;gameCanvas&quot;</span> <span class=\"attr\">width</span>=<span class=\"string\">&quot;800&quot;</span> <span class=\"attr\">height</span>=<span class=\"string\">&quot;600&quot;</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"name\">canvas</span>&gt;</span></span><br><span class=\"line\"><span class=\"tag\">&lt;<span class=\"name\">script</span>&gt;</span><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"comment\">// æ¸¸æˆé…ç½®</span></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">const</span> <span class=\"variable constant_\">FISH_TYPES</span> = &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"number\">1</span>: &#123; <span class=\"attr\">speed</span>: <span class=\"number\">2</span>, <span class=\"attr\">color</span>: <span class=\"string\">&#x27;#FF9900&#x27;</span>, <span class=\"attr\">size</span>: <span class=\"number\">30</span> &#125;,</span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"number\">2</span>: &#123; <span class=\"attr\">speed</span>: <span class=\"number\">3</span>, <span class=\"attr\">color</span>: <span class=\"string\">&#x27;#00CCFF&#x27;</span>, <span class=\"attr\">size</span>: <span class=\"number\">50</span> &#125;,</span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"number\">3</span>: &#123; <span class=\"attr\">speed</span>: <span class=\"number\">1</span>, <span class=\"attr\">color</span>: <span class=\"string\">&#x27;#FF66CC&#x27;</span>, <span class=\"attr\">size</span>: <span class=\"number\">80</span> &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">&#125;;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">class</span> <span class=\"title class_\">FishingGame</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"title function_\">constructor</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">canvas</span> = <span class=\"variable language_\">document</span>.<span class=\"title function_\">getElementById</span>(<span class=\"string\">&#x27;gameCanvas&#x27;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span> = <span class=\"variable language_\">this</span>.<span class=\"property\">canvas</span>.<span class=\"title function_\">getContext</span>(<span class=\"string\">&#x27;2d&#x27;</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">fishes</span> = [];</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">player</span> = &#123; <span class=\"attr\">gold</span>: <span class=\"number\">1000</span>, <span class=\"attr\">score</span>: <span class=\"number\">0</span> &#125;;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">init</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"title function_\">init</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">generateFish</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"title function_\">gameLoop</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">canvas</span>.<span class=\"title function_\">addEventListener</span>(<span class=\"string\">&#x27;click&#x27;</span>, <span class=\"variable language_\">this</span>.<span class=\"property\">handleClick</span>.<span class=\"title function_\">bind</span>(<span class=\"variable language_\">this</span>));</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"title function_\">generateFish</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">// éšæœºç”Ÿæˆé±¼ç¾¤</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"built_in\">setInterval</span>(<span class=\"function\">() =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"keyword\">const</span> type = <span class=\"title class_\">Math</span>.<span class=\"title function_\">floor</span>(<span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">3</span>) + <span class=\"number\">1</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"variable language_\">this</span>.<span class=\"property\">fishes</span>.<span class=\"title function_\">push</span>(&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        type,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">x</span>: -<span class=\"number\">50</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">y</span>: <span class=\"title class_\">Math</span>.<span class=\"title function_\">random</span>() * <span class=\"number\">500</span> + <span class=\"number\">50</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        ...<span class=\"variable constant_\">FISH_TYPES</span>[type]</span></span><br><span class=\"line\"><span class=\"language-javascript\">      &#125;);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;, <span class=\"number\">2000</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"title function_\">handleClick</span>(<span class=\"params\">e</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> rect = <span class=\"variable language_\">this</span>.<span class=\"property\">canvas</span>.<span class=\"title function_\">getBoundingClientRect</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> clickX = e.<span class=\"property\">clientX</span> - rect.<span class=\"property\">left</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> clickY = e.<span class=\"property\">clientY</span> - rect.<span class=\"property\">top</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    </span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">// æ£€æµ‹ç‚¹å‡»åˆ°çš„é±¼</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> cannonType = <span class=\"number\">1</span>; <span class=\"comment\">// é»˜è®¤ç‚®å¼¹ç±»å‹</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">for</span>(<span class=\"keyword\">let</span> i = <span class=\"variable language_\">this</span>.<span class=\"property\">fishes</span>.<span class=\"property\">length</span> - <span class=\"number\">1</span>; i &gt;= <span class=\"number\">0</span>; i--) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"keyword\">const</span> fish = <span class=\"variable language_\">this</span>.<span class=\"property\">fishes</span>[i];</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"keyword\">const</span> distance = <span class=\"title class_\">Math</span>.<span class=\"title function_\">sqrt</span>(</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"title class_\">Math</span>.<span class=\"title function_\">pow</span>(fish.<span class=\"property\">x</span> - clickX, <span class=\"number\">2</span>) + </span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"title class_\">Math</span>.<span class=\"title function_\">pow</span>(fish.<span class=\"property\">y</span> - clickY, <span class=\"number\">2</span>)</span></span><br><span class=\"line\"><span class=\"language-javascript\">      );</span></span><br><span class=\"line\"><span class=\"language-javascript\">      </span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"keyword\">if</span>(distance &lt; fish.<span class=\"property\">size</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"variable language_\">this</span>.<span class=\"title function_\">sendCatchRequest</span>(fish.<span class=\"property\">type</span>, cannonType);</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"variable language_\">this</span>.<span class=\"property\">fishes</span>.<span class=\"title function_\">splice</span>(i, <span class=\"number\">1</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"keyword\">break</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"keyword\">async</span> <span class=\"title function_\">sendCatchRequest</span>(<span class=\"params\">fishType, cannonType</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> response = <span class=\"keyword\">await</span> <span class=\"title function_\">fetch</span>(<span class=\"string\">&#x27;game.php&#x27;</span>, &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">method</span>: <span class=\"string\">&#x27;POST&#x27;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">headers</span>: &#123; <span class=\"string\">&#x27;Content-Type&#x27;</span>: <span class=\"string\">&#x27;application/json&#x27;</span> &#125;,</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"attr\">body</span>: <span class=\"title class_\">JSON</span>.<span class=\"title function_\">stringify</span>(&#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">action</span>: <span class=\"string\">&#x27;catch&#x27;</span>,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">fishType</span>: fishType,</span></span><br><span class=\"line\"><span class=\"language-javascript\">        <span class=\"attr\">cannon</span>: cannonType</span></span><br><span class=\"line\"><span class=\"language-javascript\">      &#125;)</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    </span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">const</span> result = <span class=\"keyword\">await</span> response.<span class=\"title function_\">json</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"keyword\">if</span>(result.<span class=\"property\">success</span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"variable language_\">this</span>.<span class=\"property\">player</span>.<span class=\"property\">gold</span> += result.<span class=\"property\">reward</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"variable language_\">this</span>.<span class=\"property\">player</span>.<span class=\"property\">score</span> += result.<span class=\"property\">reward</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"variable language_\">this</span>.<span class=\"title function_\">showEffect</span>(<span class=\"string\">&#x27;+&#x27;</span>+result.<span class=\"property\">reward</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\">  <span class=\"title function_\">gameLoop</span>(<span class=\"params\"></span>) &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span>.<span class=\"title function_\">clearRect</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">800</span>, <span class=\"number\">600</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    </span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">// ç»˜åˆ¶èƒŒæ™¯</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span>.<span class=\"property\">fillStyle</span> = <span class=\"string\">&#x27;#3399FF&#x27;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span>.<span class=\"title function_\">fillRect</span>(<span class=\"number\">0</span>, <span class=\"number\">0</span>, <span class=\"number\">800</span>, <span class=\"number\">600</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    </span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">// æ›´æ–°å¹¶ç»˜åˆ¶é±¼</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">fishes</span>.<span class=\"title function_\">forEach</span>(<span class=\"function\"><span class=\"params\">fish</span> =&gt;</span> &#123;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      fish.<span class=\"property\">x</span> += fish.<span class=\"property\">speed</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"keyword\">if</span>(fish.<span class=\"property\">x</span> &gt; <span class=\"number\">850</span>) fish.<span class=\"property\">x</span> = -<span class=\"number\">50</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      </span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span>.<span class=\"title function_\">beginPath</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span>.<span class=\"property\">fillStyle</span> = fish.<span class=\"property\">color</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span>.<span class=\"title function_\">arc</span>(fish.<span class=\"property\">x</span>, fish.<span class=\"property\">y</span>, fish.<span class=\"property\">size</span>/<span class=\"number\">2</span>, <span class=\"number\">0</span>, <span class=\"title class_\">Math</span>.<span class=\"property\">PI</span> * <span class=\"number\">2</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">      <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span>.<span class=\"title function_\">fill</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\">    &#125;);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    </span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"comment\">// ç»˜åˆ¶UI</span></span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span>.<span class=\"property\">fillStyle</span> = <span class=\"string\">&#x27;#000&#x27;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span>.<span class=\"property\">font</span> = <span class=\"string\">&#x27;20px Arial&#x27;</span>;</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span>.<span class=\"title function_\">fillText</span>(<span class=\"string\">`é‡‘å¸: <span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.player.gold&#125;</span>`</span>, <span class=\"number\">20</span>, <span class=\"number\">30</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"variable language_\">this</span>.<span class=\"property\">ctx</span>.<span class=\"title function_\">fillText</span>(<span class=\"string\">`åˆ†æ•°: <span class=\"subst\">$&#123;<span class=\"variable language_\">this</span>.player.score&#125;</span>`</span>, <span class=\"number\">20</span>, <span class=\"number\">60</span>);</span></span><br><span class=\"line\"><span class=\"language-javascript\">    </span></span><br><span class=\"line\"><span class=\"language-javascript\">    <span class=\"title function_\">requestAnimationFrame</span>(<span class=\"function\">() =&gt;</span> <span class=\"variable language_\">this</span>.<span class=\"title function_\">gameLoop</span>());</span></span><br><span class=\"line\"><span class=\"language-javascript\">  &#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\">&#125;</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span></span><br><span class=\"line\"><span class=\"language-javascript\"><span class=\"keyword\">new</span> <span class=\"title class_\">FishingGame</span>();</span></span><br><span class=\"line\"><span class=\"language-javascript\"></span><span class=\"tag\">&lt;/<span class=\"name\">script</span>&gt;</span></span><br></pre></td></tr></table></figure>\n<h3 id=\"ä¸‰ã€æ¸¸æˆåŠŸèƒ½æ‰©å±•å»ºè®®\"><a href=\"#ä¸‰ã€æ¸¸æˆåŠŸèƒ½æ‰©å±•å»ºè®®\" class=\"headerlink\" title=\"ä¸‰ã€æ¸¸æˆåŠŸèƒ½æ‰©å±•å»ºè®®\"></a>ä¸‰ã€æ¸¸æˆåŠŸèƒ½æ‰©å±•å»ºè®®</h3><ol>\n<li><p><strong>é«˜çº§åŠŸèƒ½</strong>ï¼š</p>\n<ul>\n<li>æ·»åŠ å¤šç§æ­¦å™¨ç³»ç»Ÿï¼ˆæ¿€å…‰ç‚®ã€æ¸”ç½‘ï¼‰</li>\n<li>å®ç°é±¼ç¾¤ç‰¹æ®Šè¡Œä¸ºï¼ˆBOSSé±¼ã€é±¼ç¾¤è¿å¾™ï¼‰</li>\n<li>é“å…·ç³»ç»Ÿï¼ˆé‡‘å¸åŠ å€ã€å†°å†»æ•ˆæœï¼‰</li>\n</ul>\n</li>\n<li><p><strong>æ€§èƒ½ä¼˜åŒ–</strong>ï¼š</p>\n<ul>\n<li>WebSocketå®ç°å®æ—¶é€šä¿¡</li>\n<li>å¯¹è±¡æ± é‡ç”¨é±¼å¯¹è±¡</li>\n<li>ç²¾çµå›¾ä»£æ›¿çº¯è‰²ç»˜åˆ¶</li>\n</ul>\n</li>\n<li><p><strong>å®‰å…¨å¢å¼º</strong>ï¼š</p>\n<ul>\n<li>ç‚®å¼¹æ¶ˆè€—éªŒè¯</li>\n<li>é¢‘ç‡é™åˆ¶ï¼ˆé˜²ä½œå¼Šï¼‰</li>\n<li>æ•°æ®åŠ å¯†ä¼ è¾“</li>\n</ul>\n</li>\n<li><p><strong>å•†ä¸šåŒ–åŠŸèƒ½</strong>ï¼š</p>\n<ul>\n<li>å†…è´­é‡‘å¸ç³»ç»Ÿ</li>\n<li>æ¯æ—¥ä»»åŠ¡å¥–åŠ±</li>\n<li>ç©å®¶æ’è¡Œæ¦œ</li>\n</ul>\n</li>\n</ol>\n<h3 id=\"å››ã€éƒ¨ç½²æ³¨æ„äº‹é¡¹\"><a href=\"#å››ã€éƒ¨ç½²æ³¨æ„äº‹é¡¹\" class=\"headerlink\" title=\"å››ã€éƒ¨ç½²æ³¨æ„äº‹é¡¹\"></a>å››ã€éƒ¨ç½²æ³¨æ„äº‹é¡¹</h3><ol>\n<li>ä½¿ç”¨PHP 7.4+ è·å–æœ€ä½³æ€§èƒ½</li>\n<li>é…ç½®OPCacheåŠ é€ŸPHPæ‰§è¡Œ</li>\n<li>å‰ç«¯èµ„æºä½¿ç”¨CDNåŠ é€Ÿ</li>\n<li>å®šæœŸå¤‡ä»½ç©å®¶æ•°æ®</li>\n</ol>\n<blockquote>\n<p>å®Œæ•´å®ç°éœ€åŒ…å«ç”¨æˆ·ç³»ç»Ÿï¼ˆæ³¨å†Œ/ç™»å½•ï¼‰ã€æ¸¸æˆå•†åŸã€ç¤¾äº¤åŠŸèƒ½ç­‰æ¨¡å—ã€‚å®é™…å¼€å‘ä¸­å»ºè®®ä½¿ç”¨æ¸¸æˆå¼•æ“å¦‚Phaser.jsæ›¿ä»£åŸç”ŸCanvas APIä»¥æé«˜å¼€å‘æ•ˆç‡ã€‚</p>\n</blockquote>\n",
            "tags": [
                "php",
                "æ¸¸æˆ"
            ]
        },
        {
            "id": "https://erik.xyz/2025/05/26/webman-hyperf-change/",
            "url": "https://erik.xyz/2025/05/26/webman-hyperf-change/",
            "title": "webmanå’Œhyperfå¯¹æ¯”è§£æ",
            "date_published": "2025-05-26T13:55:00.000Z",
            "content_html": "<p>å¥½çš„ï¼Œæˆ‘ä»¬æ¥æ·±å…¥æ¢è®¨ä¸€ä¸‹ <code>webman</code>ã€<code>Hyperf</code> çš„åº•å±‚åŸç†ä»¥åŠ PHP ä¸­æ³¨è§£ï¼ˆAnnotationsï¼‰çš„å®ç°åŸç†ã€‚</p>\n<h2 id=\"1-webman-åº•å±‚åŸç†\"><a href=\"#1-webman-åº•å±‚åŸç†\" class=\"headerlink\" title=\"1. webman åº•å±‚åŸç†\"></a>1. webman åº•å±‚åŸç†</h2><p><code>webman</code> çš„æ ¸å¿ƒè®¾è®¡ç†å¿µæ˜¯ <strong>è½»é‡ã€é«˜æ€§èƒ½ã€æ˜“ç”¨</strong>ã€‚å®ƒæ„å»ºåœ¨å¼ºå¤§çš„å¼‚æ­¥äº‹ä»¶é©±åŠ¨ç½‘ç»œåº“ <strong>Workerman</strong> ä¹‹ä¸Šï¼Œå……åˆ†åˆ©ç”¨äº† PHP çš„ CLIï¼ˆå‘½ä»¤è¡Œæ¥å£ï¼‰æ¨¡å¼å’Œäº‹ä»¶å¾ªç¯æœºåˆ¶ï¼Œæ‘’å¼ƒäº†ä¼ ç»Ÿçš„ PHP-FPM æ¨¡å¼ï¼Œä»è€Œå®ç°äº†é«˜æ€§èƒ½å’Œé«˜å¹¶å‘ã€‚</p>\n<span id=\"more\"></span>\n<h3 id=\"æ ¸å¿ƒåŸç†å‰–æ\"><a href=\"#æ ¸å¿ƒåŸç†å‰–æ\" class=\"headerlink\" title=\"æ ¸å¿ƒåŸç†å‰–æ\"></a>æ ¸å¿ƒåŸç†å‰–æ</h3><ol>\n<li><p><strong>åŸºäº Workermanï¼š</strong></p>\n<ul>\n<li><strong>äº‹ä»¶é©±åŠ¨ï¼š</strong> Workerman ä½¿ç”¨ <code>libevent</code> (é»˜è®¤)ã€<code>event</code> æˆ– <code>swoole</code> æ‰©å±•æä¾›çš„äº‹ä»¶å¾ªç¯åº“ã€‚å®ƒåœ¨ä¸€ä¸ªæˆ–å¤šä¸ªä¸»è¿›ç¨‹ä¸­åˆ›å»ºå’Œç®¡ç†ä¸€ä¸ªæˆ–å¤šä¸ªäº‹ä»¶å¾ªç¯ (<code>event loop</code>)ã€‚</li>\n<li><strong>éé˜»å¡ I/Oï¼š</strong> æ‰€æœ‰ç½‘ç»œæ“ä½œï¼ˆTCP/UDP/Unix Socket ç›‘å¬å’Œè¿æ¥ï¼‰éƒ½æ˜¯éé˜»å¡çš„ã€‚å½“ä¸€ä¸ªè¿æ¥ä¸Šæœ‰æ•°æ®å¯è¯»ã€å¯å†™æˆ–å‘ç”Ÿé”™è¯¯æ—¶ï¼Œäº‹ä»¶å¾ªç¯ä¼šè§¦å‘æ³¨å†Œçš„å›è°ƒå‡½æ•°è¿›è¡Œå¤„ç†ã€‚è¿™é¿å…äº†ä¸ºæ¯ä¸ªè¿æ¥åˆ›å»ºçº¿ç¨‹æˆ–è¿›ç¨‹çš„å·¨å¤§å¼€é”€ã€‚</li>\n<li><strong>å¤šè¿›ç¨‹æ¨¡å‹ï¼š</strong><ul>\n<li><strong>ä¸»è¿›ç¨‹ (Master)ï¼š</strong> è´Ÿè´£è§£æé…ç½®ã€åˆ›å»ºç›‘å¬å¥—æ¥å­—ã€ç®¡ç†å­è¿›ç¨‹ï¼ˆWorker è¿›ç¨‹ï¼‰ã€ç›‘æ§å­è¿›ç¨‹çŠ¶æ€ï¼ˆå¦‚å´©æºƒé‡å¯ï¼‰ã€å¤„ç†ä¿¡å·ï¼ˆå¦‚ reload, stop, statusï¼‰ã€‚</li>\n<li><strong>Worker è¿›ç¨‹ (Worker)ï¼š</strong> çœŸæ­£å¤„ç†ä¸šåŠ¡é€»è¾‘çš„è¿›ç¨‹ã€‚ä¸»è¿›ç¨‹ <code>fork</code> å‡ºå¤šä¸ª Worker å­è¿›ç¨‹ã€‚<strong>é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™äº› Worker è¿›ç¨‹æ˜¯å¸¸é©»å†…å­˜çš„</strong>ã€‚æ¯ä¸ª Worker è¿›ç¨‹éƒ½ç‹¬ç«‹è¿è¡Œç€è‡ªå·±çš„äº‹ä»¶å¾ªç¯ï¼Œå¤„ç†åˆ†é…ç»™å®ƒçš„è¿æ¥è¯·æ±‚ã€‚</li>\n<li><strong>è¿›ç¨‹é—´é€šä¿¡ (IPC)ï¼š</strong> Master å’Œ Worker ä¹‹é—´é€šå¸¸é€šè¿‡ Unix Socket ç®¡é“è¿›è¡Œé€šä¿¡ï¼ˆä¾‹å¦‚å‘é€ reload ä¿¡å·ã€çŠ¶æ€æŸ¥è¯¢ï¼‰ã€‚</li>\n</ul>\n</li>\n<li><strong>åè®®æ”¯æŒï¼š</strong> Workerman å†…ç½®äº†å¯¹ HTTPã€WebSocketã€TCPã€UDP ç­‰åè®®çš„æ”¯æŒï¼Œå¹¶èƒ½è‡ªå®šä¹‰åè®®ã€‚</li>\n</ul>\n</li>\n<li><p><strong>webman åœ¨ Workerman ä¸Šçš„å°è£…ï¼š</strong></p>\n<ul>\n<li><strong>PSR å…¼å®¹ï¼š</strong> æä¾›äº†ç¬¦åˆ PSR-7 (HTTP æ¶ˆæ¯æ¥å£)ã€PSR-15 (HTTP ä¸­é—´ä»¶)ã€PSR-11 (å®¹å™¨) ç­‰æ ‡å‡†çš„å®ç°ï¼Œä½¿å¾—å¼€å‘è€…å¯ä»¥ä½¿ç”¨ç†Ÿæ‚‰çš„ä¸­é—´ä»¶æ¨¡å¼å’Œä¾èµ–æ³¨å…¥ã€‚</li>\n<li><strong>è·¯ç”±ï¼š</strong> æä¾›çµæ´»çš„è·¯ç”±é…ç½®ï¼ˆå¦‚æ–‡ä»¶è·¯ç”± <code>route.php</code>ï¼‰ï¼Œå°† HTTP è¯·æ±‚æ˜ å°„åˆ°å¯¹åº”çš„æ§åˆ¶å™¨æ–¹æ³•æˆ–é—­åŒ…ã€‚</li>\n<li><strong>ä¸­é—´ä»¶ï¼š</strong> å®ç°äº†æ´‹è‘±åœˆæ¨¡å‹çš„ä¸­é—´ä»¶æœºåˆ¶ï¼Œæ–¹ä¾¿å¤„ç†è¯·æ±‚å‰ã€åçš„é€»è¾‘ï¼ˆå¦‚é‰´æƒã€æ—¥å¿—ã€è·¨åŸŸï¼‰ã€‚</li>\n<li><strong>æ§åˆ¶å™¨ï¼š</strong> ç»„ç»‡ä¸šåŠ¡é€»è¾‘ä»£ç ã€‚</li>\n<li><strong>è§†å›¾ï¼š</strong> æ”¯æŒç®€å•çš„æ¨¡æ¿æ¸²æŸ“ã€‚</li>\n<li><strong>æ•°æ®åº“/Redisï¼š</strong> æä¾›ä¾¿æ·çš„å°è£…ï¼Œä½†éœ€è¦æ³¨æ„<strong>åœ¨é»˜è®¤ Worker è¿›ç¨‹æ¨¡å‹ä¸‹ï¼Œæ•°æ®åº“è¿æ¥ä¸èƒ½åƒ Swoole åç¨‹é‚£æ ·è‡ªåŠ¨é‡Šæ”¾/é‡ç”¨ï¼Œéœ€è¦å¼€å‘è€…è‡ªè¡Œç®¡ç†è¿æ¥çš„ç”Ÿå‘½å‘¨æœŸ</strong>ï¼ˆé€šå¸¸åœ¨ä¸€ä¸ªè¯·æ±‚å¤„ç†å‘¨æœŸå†…åˆ›å»ºå’Œå…³é—­ï¼Œæˆ–ä½¿ç”¨è¿æ¥æ± ï¼‰ã€‚webman å®˜æ–¹æä¾›äº† <code>webman/redis-queue</code> ç­‰æ’ä»¶æ¥å¸®åŠ©ç®¡ç†ã€‚</li>\n<li><strong>æ–‡ä»¶ç›‘æ§ä¸çƒ­æ›´æ–°ï¼š</strong><ul>\n<li><code>php webman start</code> é»˜è®¤å¯åŠ¨æ—¶å¸¦ <code>-w</code> å‚æ•°å¼€å¯ç›‘æ§ã€‚</li>\n<li>Workerman åˆ©ç”¨ Linux å†…æ ¸çš„ <code>inotify</code> æœºåˆ¶ï¼ˆæˆ– macOS çš„ <code>kqueue</code>ï¼‰ç›‘æ§é¡¹ç›®æ–‡ä»¶ï¼ˆ<code>.php</code>, <code>.env</code> ç­‰ï¼‰çš„æ›´æ”¹ã€‚</li>\n<li>å½“æ£€æµ‹åˆ°æ–‡ä»¶ä¿®æ”¹ï¼Œä¸»è¿›ç¨‹ä¼šå‘æ‰€æœ‰ Worker è¿›ç¨‹å‘é€ <code>SIGUSR1</code> ä¿¡å·ã€‚</li>\n<li>Worker è¿›ç¨‹æ”¶åˆ°ä¿¡å·åï¼Œå®‰å…¨åœ°é€€å‡ºå½“å‰æ­£åœ¨å¤„ç†çš„è¯·æ±‚ï¼ˆå¦‚æœæœ‰ï¼‰ï¼Œç„¶åä¼˜é›…åœ°é‡å¯è‡ªèº«ï¼ˆé‡æ–°åŠ è½½ä¿®æ”¹åçš„ä»£ç ï¼‰ï¼Œè€Œä¸»è¿›ç¨‹ä¿æŒè¿è¡Œå¹¶é‡æ–° <code>fork</code> æ–°çš„ Worker è¿›ç¨‹ã€‚è¿™ä¸ªè¿‡ç¨‹<strong>éå¸¸å¿«é€Ÿ</strong>ï¼Œç”¨æˆ·å‡ ä¹æ„ŸçŸ¥ä¸åˆ°æœåŠ¡ä¸­æ–­ï¼Œå®ç°äº†â€œçƒ­æ›´æ–°â€ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p><strong>é«˜æ€§èƒ½å…³é”®ç‚¹ï¼š</strong></p>\n<ul>\n<li><strong>å¸¸é©»å†…å­˜ï¼š</strong> æœ€å¤§çš„ä¼˜åŠ¿ã€‚æ¡†æ¶æ ¸å¿ƒã€ä¸šåŠ¡ä»£ç ã€é…ç½®ç­‰åœ¨ Worker è¿›ç¨‹å¯åŠ¨æ—¶åŠ è½½ä¸€æ¬¡ï¼Œé©»ç•™åœ¨å†…å­˜ä¸­ã€‚å¤„ç†åç»­è¯·æ±‚æ—¶<strong>æ— éœ€é‡å¤åˆå§‹åŒ–æ¡†æ¶ã€åŠ è½½æ ¸å¿ƒæ–‡ä»¶ã€è¿æ¥æ•°æ®åº“ï¼ˆå¦‚æœè¿æ¥æ± ç®¡ç†å¾—å½“ï¼‰</strong>ï¼Œæå¤§å‡å°‘äº†å¼€é”€ã€‚</li>\n<li><strong>äº‹ä»¶é©±åŠ¨ &amp; éé˜»å¡ï¼š</strong> é«˜æ•ˆå¤„ç†é«˜å¹¶å‘è¿æ¥ï¼Œå°¤å…¶é€‚åˆ I/O å¯†é›†å‹åœºæ™¯ã€‚</li>\n<li><strong>è½»é‡çº§ï¼š</strong> æ¡†æ¶æœ¬èº«ä»£ç é‡å°‘ï¼ŒæŠ½è±¡å±‚è–„ï¼Œå¼€é”€å°ã€‚</li>\n</ul>\n</li>\n</ol>\n<p><strong>æ€»ç»“ webman åŸç†ï¼š</strong> åˆ©ç”¨ Workerman çš„äº‹ä»¶é©±åŠ¨ã€éé˜»å¡ I/O å’Œå¤šè¿›ç¨‹æ¨¡å‹æä¾›é«˜æ€§èƒ½ç½‘ç»œåŸºç¡€ã€‚webman åœ¨å…¶ä¸Šæ„å»ºäº†ä¸€ä¸ªç¬¦åˆç°ä»£ PHP å¼€å‘è§„èŒƒï¼ˆPSRï¼‰çš„è½»é‡çº§ Web æ¡†æ¶ï¼Œå¹¶é€šè¿‡æ–‡ä»¶ç›‘æ§å®ç°äº†ä¾¿æ·çš„çƒ­æ›´æ–°ã€‚å…¶æ ¸å¿ƒä¼˜åŠ¿åœ¨äºå¸¸é©»å†…å­˜å¸¦æ¥çš„æ€§èƒ½æå‡å’Œ Workerman çš„ç¨³å®šæ€§ã€‚</p>\n<h2 id=\"2-Hyperf-åº•å±‚åŸç†\"><a href=\"#2-Hyperf-åº•å±‚åŸç†\" class=\"headerlink\" title=\"2. Hyperf åº•å±‚åŸç†\"></a>2. Hyperf åº•å±‚åŸç†</h2><p><code>Hyperf</code> æ˜¯ä¸€ä¸ª <strong>é«˜æ€§èƒ½ã€é«˜çµæ´»æ€§çš„ä¼ä¸šçº§åç¨‹æ¡†æ¶</strong>ã€‚å®ƒçš„æ ¸å¿ƒå»ºç«‹åœ¨ <strong>Swoole</strong> æ‰©å±•ä¹‹ä¸Šï¼Œæ·±åº¦åˆ©ç”¨äº† Swoole æä¾›çš„ <strong>åç¨‹</strong> èƒ½åŠ›æ¥å®ç°é«˜æ€§èƒ½å’Œé«˜å¹¶å‘ï¼Œå¹¶å¼•å…¥äº†å¤§é‡ Java Spring Cloud ç­‰æ¡†æ¶çš„è®¾è®¡ç†å¿µï¼ˆå¦‚ä¾èµ–æ³¨å…¥ã€AOPã€æ³¨è§£é©±åŠ¨ï¼‰ã€‚</p>\n<h3 id=\"æ ¸å¿ƒåŸç†å‰–æ-1\"><a href=\"#æ ¸å¿ƒåŸç†å‰–æ-1\" class=\"headerlink\" title=\"æ ¸å¿ƒåŸç†å‰–æ\"></a>æ ¸å¿ƒåŸç†å‰–æ</h3><ol>\n<li><p><strong>åŸºäº Swooleï¼š</strong></p>\n<ul>\n<li><strong>åç¨‹ï¼š</strong> Swoole çš„æ ¸å¿ƒèƒ½åŠ›ã€‚åç¨‹æ˜¯ç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼Œç”±æ¡†æ¶æˆ–è¿è¡Œæ—¶è‡ªèº«è°ƒåº¦ï¼Œåˆ‡æ¢æˆæœ¬æä½ï¼ˆé€šå¸¸åªæœ‰å‡½æ•°è°ƒç”¨çš„å¼€é”€ï¼‰ã€‚Hyperf <strong>æ·±åº¦æ‹¥æŠ±åç¨‹</strong>ï¼Œå‡ ä¹æ‰€æœ‰ç»„ä»¶ï¼ˆHTTP Serverã€Database Clientã€Redis Clientã€RPC Client/Serverã€AMQP ç­‰ï¼‰éƒ½è®¾è®¡ä¸º<strong>åç¨‹å®‰å…¨</strong>æˆ–<strong>åç¨‹å‹å¥½</strong>ã€‚</li>\n<li><strong>åç¨‹è°ƒåº¦ï¼š</strong> Swoole æä¾›äº†åç¨‹è°ƒåº¦å™¨ã€‚å½“ä¸€ä¸ªåç¨‹é‡åˆ° I/O æ“ä½œï¼ˆå¦‚æ•°æ®åº“æŸ¥è¯¢ã€ç½‘ç»œè¯·æ±‚ã€æ–‡ä»¶è¯»å†™ï¼‰æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨æŒ‚èµ·ï¼ˆ<code>yield</code>ï¼‰ï¼Œå°† CPU è®©ç»™å…¶ä»–å°±ç»ªçš„åç¨‹ã€‚å½“ I/O æ“ä½œå®Œæˆï¼Œè°ƒåº¦å™¨ä¼šæ¢å¤ï¼ˆ<code>resume</code>ï¼‰è¯¥åç¨‹ç»§ç»­æ‰§è¡Œã€‚è¿™ä½¿å¾—<strong>å•è¿›ç¨‹å†…å¯ä»¥å¹¶å‘å¤„ç†æˆåƒä¸Šä¸‡ä¸ªè¿æ¥/ä»»åŠ¡</strong>ï¼Œä¸”ä»£ç é€»è¾‘ä¾ç„¶æ˜¯<strong>é¡ºåºç¼–å†™</strong>ï¼ˆå¼‚æ­¥å›è°ƒçš„ <code>callback hell</code> é—®é¢˜å¾—åˆ°æå¤§ç¼“è§£ï¼‰ã€‚</li>\n<li><strong>äº‹ä»¶é©±åŠ¨ï¼š</strong> åº•å±‚ä»ç„¶æ˜¯äº‹ä»¶é©±åŠ¨ï¼ˆåŸºäº <code>epoll</code>/<code>kqueue</code> ç­‰ï¼‰ï¼ŒSwoole çš„äº‹ä»¶å¾ªç¯é©±åŠ¨ç€åç¨‹çš„è°ƒåº¦ã€‚</li>\n<li><strong>Serverï¼š</strong> æä¾›é«˜æ€§èƒ½çš„ HTTP Serverã€WebSocket Serverã€TCP/UDP Server ç­‰ã€‚Hyperf ä¸»è¦ä½¿ç”¨ HTTP Serverã€‚</li>\n</ul>\n</li>\n<li><p><strong>Hyperf åœ¨ Swoole ä¸Šçš„é«˜çº§å°è£…ä¸æ¶æ„ï¼š</strong></p>\n<ul>\n<li><strong>å¼ºå¤§çš„ä¾èµ–æ³¨å…¥å®¹å™¨ (DI Container)ï¼š</strong><ul>\n<li>æ˜¯æ•´ä¸ªæ¡†æ¶çš„åŸºçŸ³ï¼ˆåŸºäº <code>hyperf/di</code> ç»„ä»¶ï¼‰ã€‚</li>\n<li>å®ç°äº† <code>PSR-11</code>ã€‚</li>\n<li>æ”¯æŒè‡ªåŠ¨è£…é…ï¼ˆAutowiringï¼‰ã€æ¥å£ç»‘å®šå®ç°ã€æ„é€ å‡½æ•°æ³¨å…¥ã€å±æ€§æ³¨å…¥ã€æ–¹æ³•æ³¨å…¥ã€‚</li>\n<li>ç®¡ç†ç€åº”ç”¨ä¸­å‡ ä¹æ‰€æœ‰å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸï¼ˆå•ä¾‹ã€åŸå‹ç­‰ï¼‰ã€‚</li>\n<li>æ˜¯ AOP å’Œæ³¨è§£é©±åŠ¨å®ç°çš„åŸºç¡€ã€‚</li>\n</ul>\n</li>\n<li><strong>æ³¨è§£é©±åŠ¨å¼€å‘ (Annotation-Driven Development)ï¼š</strong><ul>\n<li>Hyperf <strong>é‡åº¦ä¾èµ–æ³¨è§£</strong>æ¥é…ç½®è·¯ç”±ã€å®šä¹‰ä¸­é—´ä»¶ã€å£°æ˜ AOP åˆ‡é¢ã€æ ‡è®°å®šæ—¶ä»»åŠ¡ã€é…ç½®ä¾èµ–æ³¨å…¥ã€å®šä¹‰ RPC æœåŠ¡ç­‰ã€‚</li>\n<li>æ¡†æ¶å¯åŠ¨æ—¶ï¼ˆæˆ–åœ¨ <code>Worker</code> è¿›ç¨‹å¯åŠ¨æ—¶ï¼Œå–å†³äºæ³¨è§£ä½œç”¨åŸŸï¼‰ï¼Œä¼šé€šè¿‡<strong>åå°„</strong>æ‰«æä»£ç ï¼Œè§£æç±»ã€æ–¹æ³•ã€å±æ€§ä¸Šçš„æ³¨è§£ï¼Œæ”¶é›†å…ƒæ•°æ®ï¼Œå¹¶åŠ¨æ€ç”Ÿæˆä»£ç†ç±»æˆ–è¿›è¡Œç›¸åº”çš„é…ç½®æ³¨å†Œï¼ˆå¦‚å°†è·¯ç”±ä¿¡æ¯æ³¨å†Œåˆ°è·¯ç”±å™¨ï¼‰ã€‚</li>\n<li>æå¤§æé«˜äº†å¼€å‘æ•ˆç‡å’Œä»£ç çš„å¯è¯»æ€§ã€å¯ç»´æŠ¤æ€§ï¼ˆé…ç½®ç´§è´´ä»£ç ï¼‰ã€‚</li>\n</ul>\n</li>\n<li><strong>é¢å‘åˆ‡é¢ç¼–ç¨‹ (AOP)ï¼š</strong><ul>\n<li>åŸºäº DI å®¹å™¨å’ŒåŠ¨æ€ä»£ç†å®ç°ã€‚</li>\n<li>å…è®¸å¼€å‘è€…å®šä¹‰â€œåˆ‡é¢â€ï¼ˆ<code>Aspect</code>ï¼‰ç±»ï¼Œå…¶ä¸­åŒ…å«â€œé€šçŸ¥â€ï¼ˆ<code>Advice</code> - å¦‚ <code>@Before</code>, <code>@After</code>, <code>@Around</code>ï¼‰å’Œâ€œåˆ‡å…¥ç‚¹â€ï¼ˆ<code>Pointcut</code> - é€šè¿‡æ³¨è§£æˆ–è¡¨è¾¾å¼æŒ‡å®šå“ªäº›ç±»çš„å“ªäº›æ–¹æ³•éœ€è¦è¢«åˆ‡å…¥ï¼‰ã€‚</li>\n<li>æ¡†æ¶åœ¨è¿è¡Œæ—¶ï¼Œä¼šä¸ºåŒ¹é… <code>Pointcut</code> çš„ç›®æ ‡ç±»<strong>ç”Ÿæˆä»£ç†ç±»</strong>ã€‚å½“è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œå®é™…ä¸Šæ˜¯è°ƒç”¨ä»£ç†ç±»çš„æ–¹æ³•ï¼Œä»£ç†ç±»ä¼šæŒ‰é¡ºåºæ‰§è¡Œç›¸å…³çš„ <code>Advice</code> é€»è¾‘ï¼ˆå¦‚æ—¥å¿—è®°å½•ã€æ€§èƒ½ç›‘æ§ã€äº‹åŠ¡ç®¡ç†ã€ç¼“å­˜å¤„ç†ã€æƒé™æ ¡éªŒç­‰ï¼‰ï¼Œç„¶åå†è°ƒç”¨æˆ–ç¯ç»•è°ƒç”¨åŸå§‹ç›®æ ‡æ–¹æ³•ã€‚</li>\n<li>å®ç°äº†æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼ˆCross-Cutting Concernsï¼‰ä¸æ ¸å¿ƒä¸šåŠ¡é€»è¾‘çš„è§£è€¦ã€‚</li>\n</ul>\n</li>\n<li><strong>åç¨‹ä¸Šä¸‹æ–‡ç®¡ç†ï¼š</strong><ul>\n<li>ç”±äºåç¨‹æ˜¯è½»é‡çº§ä¸”å¹¶å‘æ‰§è¡Œçš„ï¼Œä¼ ç»Ÿçš„å…¨å±€å˜é‡ã€å•ä¾‹æ¨¡å¼åœ¨åç¨‹ç¯å¢ƒä¸‹å¯èƒ½ä¸å®‰å…¨ï¼ˆä¸€ä¸ªåç¨‹ä¿®æ”¹ä¼šå½±å“å…¶ä»–åç¨‹ï¼‰ã€‚</li>\n<li>Hyperf æä¾›äº† <code>hyperf/context</code> ç»„ä»¶ï¼Œåˆ©ç”¨ Swoole çš„åç¨‹ API (<code>Swoole\\Coroutine::getContext()</code>) å®ç°<strong>åç¨‹çº§åˆ«çš„ä¸Šä¸‹æ–‡éš”ç¦»</strong>ã€‚<code>Context</code> ç±»å…è®¸å®‰å…¨åœ°åœ¨åŒä¸€ä¸ªåç¨‹å†…å­˜å‚¨å’Œè·å–æ•°æ®ã€‚</li>\n</ul>\n</li>\n<li><strong>è¿æ¥æ± ï¼š</strong><ul>\n<li>ä¸ºæ˜‚è´µçš„èµ„æºï¼ˆå¦‚æ•°æ®åº“è¿æ¥ã€Redis è¿æ¥ã€HTTP å®¢æˆ·ç«¯è¿æ¥ï¼‰æä¾›æ± åŒ–ç®¡ç†ã€‚</li>\n<li>å½“åç¨‹éœ€è¦èµ„æºæ—¶ï¼Œä»æ± ä¸­è·å–ï¼›ä½¿ç”¨å®Œæ¯•åï¼Œå½’è¿˜åˆ°æ± ä¸­ã€‚</li>\n<li><strong>é¿å…é¢‘ç¹åˆ›å»ºå’Œé”€æ¯è¿æ¥çš„å¼€é”€</strong>ï¼Œæå¤§æå‡æ€§èƒ½ï¼Œå¹¶ä¸”<strong>å¤©ç„¶é€‚é…åç¨‹æ¨¡å‹</strong>ï¼ˆæ¯ä¸ªåç¨‹ä½¿ç”¨ç‹¬ç«‹çš„è¿æ¥ï¼Œé¿å…å¹¶å‘é—®é¢˜ï¼‰ã€‚</li>\n</ul>\n</li>\n<li><strong>ç»„ä»¶åŒ–ä¸å¼‚æ­¥éé˜»å¡å®¢æˆ·ç«¯ï¼š</strong><ul>\n<li>Hyperf æä¾›äº†å¤§é‡å¼€ç®±å³ç”¨çš„é«˜æ€§èƒ½åç¨‹ç»„ä»¶ï¼šæ•°æ®åº“ (<code>hyperf/database</code> - åŸºäº Eloquent/Doctrine, å¸¦è¿æ¥æ± )ã€Redis (<code>hyperf/redis</code> - å¸¦è¿æ¥æ± )ã€ç¼“å­˜ã€é˜Ÿåˆ— (<code>hyperf/async-queue</code>)ã€RPC (<code>hyperf/json-rpc</code>)ã€æœåŠ¡æ³¨å†Œä¸å‘ç° (<code>hyperf/service-governance</code>)ã€é…ç½®ä¸­å¿ƒ (<code>hyperf/config</code>)ã€åˆ†å¸ƒå¼è¿½è¸ª (<code>hyperf/tracer</code>)ã€é™æµç†”æ–­ (<code>hyperf/rate-limit</code>, <code>hyperf/circuit-breaker</code>)ã€GraphQLã€gRPCã€AMQPã€WebSocket ç­‰ã€‚</li>\n<li>è¿™äº›å®¢æˆ·ç«¯åº•å±‚éƒ½ä½¿ç”¨ Swoole æä¾›çš„åç¨‹ Client æˆ–è‡ªè¡Œå®ç°çš„åç¨‹åŒ– Clientï¼Œç¡®ä¿æ‰€æœ‰ I/O æ“ä½œéƒ½æ˜¯<strong>å¼‚æ­¥éé˜»å¡</strong>çš„ï¼Œèƒ½å¤Ÿè¢«åç¨‹è°ƒåº¦å™¨æŒ‚èµ·å’Œæ¢å¤ã€‚</li>\n</ul>\n</li>\n<li><strong>è¿›ç¨‹æ¨¡å‹ï¼š</strong><ul>\n<li><strong>ä¸»è¿›ç¨‹ (Master)ï¼š</strong> ç®¡ç†æœåŠ¡ç”Ÿå‘½å‘¨æœŸã€‚</li>\n<li><strong>Manager è¿›ç¨‹ï¼š</strong> ç®¡ç† Worker/TaskWorker è¿›ç¨‹ï¼ˆåˆ›å»ºã€å›æ”¶ï¼‰ã€‚</li>\n<li><strong>Worker è¿›ç¨‹ï¼š</strong> å¤„ç†ç½‘ç»œè¯·æ±‚ï¼ˆHTTP, WebSocket, TCP ç­‰ï¼‰ã€‚<strong>æ¯ä¸ª Worker è¿›ç¨‹æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„åç¨‹è°ƒåº¦å•å…ƒ</strong>ï¼Œå†…éƒ¨å¯ä»¥å¹¶å‘è¿è¡Œå¤§é‡åç¨‹å¤„ç†è¯·æ±‚ã€‚</li>\n<li><strong>TaskWorker è¿›ç¨‹ (å¯é€‰)ï¼š</strong> ä¸“é—¨å¤„ç†è€—æ—¶è¾ƒé•¿çš„åŒæ­¥é˜»å¡ä»»åŠ¡ï¼ˆå¦‚æŸäº›å¤æ‚è®¡ç®—ã€è°ƒç”¨ä¸æ”¯æŒåç¨‹çš„åº“ï¼‰ã€‚Worker è¿›ç¨‹é€šè¿‡ <code>task()</code> æŠ•é€’ä»»åŠ¡åˆ° TaskWorkerã€‚Hyperf ä¹Ÿæä¾›äº†åŸºäºæ¶ˆæ¯é˜Ÿåˆ— (<code>async-queue</code>) çš„å¼‚æ­¥ä»»åŠ¡å¤„ç†æ–¹æ¡ˆã€‚</li>\n</ul>\n</li>\n<li><strong>çƒ­æ›´æ–°ï¼š</strong><ul>\n<li>åŸç†ç±»ä¼¼ webman/Workermanï¼Œä½¿ç”¨ <code>inotify</code>/<code>kqueue</code> ç›‘æ§æ–‡ä»¶å˜åŒ–ã€‚</li>\n<li>å‘ Worker è¿›ç¨‹å‘é€ä¿¡å· (<code>SIGUSR1</code> æˆ– <code>SIGTERM</code>) é€šçŸ¥å…¶ä¼˜é›…é‡å¯ï¼ˆå®Œæˆå½“å‰è¯·æ±‚åé€€å‡ºï¼Œä¸»è¿›ç¨‹é‡æ–°æ‹‰èµ·æ–° Worker åŠ è½½æ–°ä»£ç ï¼‰ã€‚Hyperf çš„ DI å®¹å™¨å’Œä»£ç†ç±»ç”Ÿæˆæœºåˆ¶ä½¿å¾—çƒ­æ›´æ–°ç›¸å¯¹å¯é ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<p><strong>æ€»ç»“ Hyperf åŸç†ï¼š</strong> æ·±åº¦é›†æˆ Swoole åç¨‹ï¼Œæ„å»ºäº†ä¸€ä¸ªé«˜æ€§èƒ½ã€ä¼ä¸šçº§çš„å¾®æœåŠ¡æ¡†æ¶ã€‚å…¶æ ¸å¿ƒåœ¨äºå¼ºå¤§çš„ä¾èµ–æ³¨å…¥å®¹å™¨ã€åŸºäºæ³¨è§£çš„å…ƒç¼–ç¨‹å’Œé…ç½®ã€AOP è§£è€¦æ¨ªåˆ‡å…³æ³¨ç‚¹ã€å®Œå–„çš„åç¨‹ä¸Šä¸‹æ–‡å’Œè¿æ¥æ± ç®¡ç†ï¼Œä»¥åŠå¤§é‡å¼€ç®±å³ç”¨çš„é«˜æ€§èƒ½åç¨‹ç»„ä»¶ã€‚å®ƒæ›´é€‚åˆæ„å»ºå¤æ‚çš„ã€åˆ†å¸ƒå¼çš„é«˜å¹¶å‘ç³»ç»Ÿï¼ˆå¦‚å¾®æœåŠ¡æ¶æ„ï¼‰ã€‚</p>\n<h2 id=\"3-PHP-æ³¨è§£-Annotations-åŸç†\"><a href=\"#3-PHP-æ³¨è§£-Annotations-åŸç†\" class=\"headerlink\" title=\"3. PHP æ³¨è§£ (Annotations) åŸç†\"></a>3. PHP æ³¨è§£ (Annotations) åŸç†</h2><p>æ³¨è§£ï¼ˆPHP 8 ä¹‹å‰å¸¸ç§°ä¸º DocBlock Annotationsï¼ŒPHP 8 å¼•å…¥äº†åŸç”Ÿ Attributesï¼‰æ˜¯ä¸€ç§<strong>å…ƒæ•°æ®</strong>æœºåˆ¶ã€‚å®ƒå…è®¸ä½ å°†ç»“æ„åŒ–çš„ä¿¡æ¯ï¼ˆå…ƒæ•°æ®ï¼‰é™„åŠ åˆ°ä»£ç å…ƒç´ ï¼ˆç±»ã€æ–¹æ³•ã€å±æ€§ã€å‡½æ•°ã€å‚æ•°ï¼‰ä¸Šã€‚è¿™äº›ä¿¡æ¯æœ¬èº«<strong>ä¸ä¼šç›´æ¥å½±å“ä»£ç çš„é€»è¾‘æ‰§è¡Œ</strong>ï¼Œä½†å¯ä»¥è¢«<strong>å¤–éƒ¨å·¥å…·ï¼ˆå¦‚æ¡†æ¶ã€åº“ã€IDEã€æ–‡æ¡£ç”Ÿæˆå™¨ï¼‰åœ¨è¿è¡Œæ—¶æˆ–ç¼–è¯‘æ—¶è¯»å–å¹¶åˆ©ç”¨</strong>ã€‚</p>\n<h3 id=\"å®ç°åŸç†-é‡ç‚¹åœ¨æ¡†æ¶å¦‚ä½•åˆ©ç”¨\"><a href=\"#å®ç°åŸç†-é‡ç‚¹åœ¨æ¡†æ¶å¦‚ä½•åˆ©ç”¨\" class=\"headerlink\" title=\"å®ç°åŸç† (é‡ç‚¹åœ¨æ¡†æ¶å¦‚ä½•åˆ©ç”¨)\"></a>å®ç°åŸç† (é‡ç‚¹åœ¨æ¡†æ¶å¦‚ä½•åˆ©ç”¨)</h3><ol>\n<li><p><strong>PHP 8 ä¹‹å‰ (DocBlock Annotations)ï¼š</strong></p>\n<ul>\n<li><strong>å­˜å‚¨ä½ç½®ï¼š</strong> å…ƒæ•°æ®ä»¥ç‰¹å®šæ ¼å¼çš„æ³¨é‡Šå—ï¼ˆ<code>/** ... */</code>ï¼‰å½¢å¼å†™åœ¨ä»£ç å…ƒç´ çš„ä¸Šæ–¹ã€‚</li>\n<li><strong>æ ¼å¼ï¼š</strong> éµå¾ª PHPDoc æ ‡å‡†ï¼Œä½†æ¡†æ¶ä¼šå®šä¹‰è‡ªå·±çš„ç‰¹æ®Šæ ‡ç­¾ï¼ˆå¦‚ <code>@Route</code>, <code>@Inject</code>, <code>@Cacheable</code>ï¼‰ã€‚</li>\n<li><strong>è§£æï¼š</strong><ul>\n<li><strong>åå°„ (Reflection)ï¼š</strong> æ¡†æ¶åˆ©ç”¨ PHP çš„åå°„ API (<code>ReflectionClass</code>, <code>ReflectionMethod</code>, <code>ReflectionProperty</code>) è·å–ä»£ç å…ƒç´ ï¼ˆç±»ã€æ–¹æ³•ã€å±æ€§ï¼‰ã€‚</li>\n<li><strong>è·å– DocCommentï¼š</strong> é€šè¿‡åå°„å¯¹è±¡çš„ <code>getDocComment()</code> æ–¹æ³•è·å–è¯¥å…ƒç´ ä¸Šçš„æ–‡æ¡£æ³¨é‡Šå­—ç¬¦ä¸²ã€‚</li>\n<li><strong>è§£æå­—ç¬¦ä¸²ï¼š</strong> æ¡†æ¶éœ€è¦ç¼–å†™è‡ªå·±çš„è§£æå™¨ï¼ˆæˆ–ä½¿ç”¨åº“å¦‚ <code>doctrine/annotations</code>ï¼‰æ¥è§£æè¿™ä¸ªå­—ç¬¦ä¸²ã€‚è§£æå™¨ï¼š<ul>\n<li>è¯†åˆ«ä»¥ <code>@</code> å¼€å¤´çš„æ ‡è®°ï¼ˆTagsï¼‰ã€‚</li>\n<li>è§£ææ ‡è®°åçš„å‚æ•°ï¼ˆå¯èƒ½æ˜¯ç®€å•çš„å­—ç¬¦ä¸²ã€é”®å€¼å¯¹ã€æ•°ç»„ã€ç”šè‡³åµŒå¥—ç»“æ„ï¼‰ã€‚</li>\n<li>å°†è§£æç»“æœè½¬æ¢ä¸ºç»“æ„åŒ–çš„æ•°æ®ï¼ˆé€šå¸¸æ˜¯æ•°ç»„æˆ–ç‰¹å®šçš„æ³¨è§£å¯¹è±¡ï¼‰ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><strong>å¤„ç†ï¼š</strong><ul>\n<li><strong>å¯åŠ¨æ—¶æ‰«æï¼š</strong> æ¡†æ¶é€šå¸¸åœ¨å¯åŠ¨é˜¶æ®µï¼ˆæˆ–é¦–æ¬¡è¯·æ±‚æ—¶ï¼‰æ‰«ææŒ‡å®šçš„ç›®å½•æˆ–å‘½åç©ºé—´ä¸‹çš„æ‰€æœ‰ PHP æ–‡ä»¶ã€‚</li>\n<li><strong>åå°„ä¸è§£æï¼š</strong> å¯¹æ‰«æåˆ°çš„ç±»ã€æ–¹æ³•ã€å±æ€§ä½¿ç”¨åå°„è·å– DocComment å¹¶è¿›è¡Œè§£æã€‚</li>\n<li><strong>å…ƒæ•°æ®æ”¶é›†ï¼š</strong> å°†è§£æå¾—åˆ°çš„ç»“æ„åŒ–æ³¨è§£ä¿¡æ¯æ”¶é›†å¹¶å­˜å‚¨èµ·æ¥ï¼ˆä¾‹å¦‚ï¼Œå°† <code>@Route</code> ä¿¡æ¯æ³¨å†Œåˆ°è·¯ç”±è¡¨ä¸­ï¼›å°† <code>@Inject</code> ä¿¡æ¯ç”¨äº DI å®¹å™¨çš„è‡ªåŠ¨è£…é…é…ç½®ï¼‰ã€‚</li>\n<li><strong>è¿è¡Œæ—¶åˆ©ç”¨ï¼š</strong> åœ¨å¤„ç†è¯·æ±‚æˆ–æ‰§è¡Œç‰¹å®šé€»è¾‘æ—¶ï¼Œæ¡†æ¶ä¼šæ ¹æ®ä¹‹å‰æ”¶é›†çš„æ³¨è§£å…ƒæ•°æ®æ¥æŒ‡å¯¼è¡Œä¸ºï¼ˆå¦‚æ ¹æ®è·¯ç”±æ³¨è§£åŒ¹é…æ§åˆ¶å™¨æ–¹æ³•ï¼›æ ¹æ®ç¼“å­˜æ³¨è§£å†³å®šæ˜¯å¦ä»ç¼“å­˜è¯»å–æ•°æ®ï¼‰ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p><strong>PHP 8 åŠä¹‹å (åŸç”Ÿ Attributes)ï¼š</strong></p>\n<ul>\n<li><strong>è¯­è¨€çº§æ”¯æŒï¼š</strong> PHP 8 å°†æ³¨è§£ä½œä¸º<strong>ä¸€çº§è¯­è¨€ç‰¹æ€§</strong>å¼•å…¥ï¼Œç§°ä¸º <strong>Attributes</strong>ã€‚å®ƒä»¬ä¸å†æ˜¯æ³¨é‡Šï¼Œè€Œæ˜¯<strong>æ­£å¼çš„è¯­æ³•ç»“æ„</strong>ã€‚</li>\n<li><strong>å®šä¹‰ï¼š</strong> ä½¿ç”¨ <code>#[...]</code> è¯­æ³•å®šä¹‰ã€‚Attribute æœ¬èº«å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ PHP ç±»ï¼ˆé€šå¸¸ç»§æ‰¿è‡ª <code>\\Attribute</code>ï¼‰ï¼Œå¯ä»¥æœ‰è‡ªå·±çš„æ„é€ å‡½æ•°ã€å±æ€§å’Œæ–¹æ³•ï¼Œç”¨äºå®šä¹‰å’ŒéªŒè¯å…ƒæ•°æ®çš„ç»“æ„ã€‚</li>\n<li><strong>åå°„è·å–ï¼š</strong> åå°„ API æ–°å¢äº† <code>getAttributes()</code> æ–¹æ³•ï¼ˆä¾‹å¦‚ <code>ReflectionClass::getAttributes()</code>ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ª <code>ReflectionAttribute</code> å¯¹è±¡æ•°ç»„ã€‚</li>\n<li><strong>å®ä¾‹åŒ–ï¼š</strong> å¯ä»¥é€šè¿‡ <code>ReflectionAttribute::newInstance()</code> æ–¹æ³•å®ä¾‹åŒ– Attribute ç±»å¯¹è±¡ï¼ˆå¦‚æœå®šä¹‰äº†ç±»ï¼‰ï¼Œä¼ å…¥çš„å‚æ•°å°±æ˜¯åœ¨ Attribute å®šä¹‰æ—¶æä¾›çš„å‚æ•°ã€‚è¿™æ ·å°±å¾—åˆ°äº†ä¸€ä¸ª<strong>å¼ºç±»å‹çš„ã€ç»“æ„åŒ–çš„æ³¨è§£å¯¹è±¡</strong>ã€‚</li>\n<li><strong>ä¼˜åŠ¿ï¼š</strong><ul>\n<li><strong>æ€§èƒ½ï¼š</strong> åŸç”Ÿè¯­æ³•ï¼Œè§£æé€Ÿåº¦æ¯”è§£æ DocComment å­—ç¬¦ä¸²å¿«å¾—å¤šã€‚</li>\n<li><strong>éªŒè¯ï¼š</strong> Attribute ç±»å¯ä»¥å®šä¹‰æ„é€ å‡½æ•°å‚æ•°ç±»å‹ï¼ŒPHP å¼•æ“ä¼šåœ¨å®šä¹‰æ—¶å°±è¿›è¡Œå‚æ•°ç±»å‹æ£€æŸ¥ï¼Œé¿å…è¿è¡Œæ—¶è§£æé”™è¯¯ã€‚</li>\n<li><strong>ç»“æ„æ¸…æ™°ï¼š</strong> å¼ºç±»å‹å¯¹è±¡æ¯”è§£æå­—ç¬¦ä¸²å¾—åˆ°çš„æ•°ç»„æ›´æ¸…æ™°ã€æ›´å®‰å…¨ã€‚</li>\n<li><strong>IDE æ”¯æŒï¼š</strong> IDE èƒ½æ›´å¥½åœ°è¯†åˆ«ã€è‡ªåŠ¨è¡¥å…¨å’Œæ£€æŸ¥ Attributesã€‚</li>\n</ul>\n</li>\n<li><strong>æ¡†æ¶å¤„ç†æµç¨‹ (ç±»ä¼¼ DocBlockï¼Œä½†æ›´é«˜æ•ˆå®‰å…¨)ï¼š</strong><ul>\n<li>å¯åŠ¨æ‰«æç›®å½•/å‘½åç©ºé—´ã€‚</li>\n<li>ä½¿ç”¨åå°„ API è·å–ç±»/æ–¹æ³•/å±æ€§ã€‚</li>\n<li>è°ƒç”¨ <code>getAttributes()</code> è·å–é™„åŠ çš„ Attribute åˆ—è¡¨ã€‚</li>\n<li><code>newInstance()</code> å®ä¾‹åŒ–éœ€è¦çš„ Attribute å¯¹è±¡ã€‚</li>\n<li>æ”¶é›†è¿™äº› Attribute å¯¹è±¡åŒ…å«çš„å…ƒæ•°æ®ã€‚</li>\n<li>æ ¹æ®å…ƒæ•°æ®é…ç½®æ¡†æ¶ï¼ˆæ³¨å†Œè·¯ç”±ã€é…ç½® DIã€å®šä¹‰ AOP åˆ‡å…¥ç‚¹ç­‰ï¼‰ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n<p><strong>æ€»ç»“æ³¨è§£åŸç†ï¼š</strong> æ— è®ºæ˜¯æ—§çš„ DocBlock è¿˜æ˜¯æ–°çš„åŸç”Ÿ Attributeï¼Œæ³¨è§£çš„æœ¬è´¨éƒ½æ˜¯<strong>é™„åŠ åœ¨ä»£ç å…ƒç´ ä¸Šçš„å…ƒæ•°æ®</strong>ã€‚æ¡†æ¶é€šè¿‡ <strong>åå°„æœºåˆ¶</strong> åœ¨<strong>å¯åŠ¨é˜¶æ®µï¼ˆæˆ–æŒ‰éœ€ï¼‰</strong> æ‰«æä»£ç ï¼Œ<strong>è§£æ</strong>è¿™äº›å…ƒæ•°æ®ï¼Œå°†å…¶è½¬æ¢ä¸º<strong>ç»“æ„åŒ–ä¿¡æ¯</strong>ï¼Œå¹¶<strong>åˆ©ç”¨è¿™äº›ä¿¡æ¯æ¥åŠ¨æ€é…ç½®æ¡†æ¶è¡Œä¸ºã€ç”Ÿæˆä»£ç†ä»£ç ï¼ˆAOPï¼‰æˆ–æŒ‡å¯¼è¿è¡Œæ—¶é€»è¾‘</strong>ã€‚åŸç”Ÿ Attributes åœ¨æ€§èƒ½ã€ç±»å‹å®‰å…¨æ€§å’Œå¼€å‘ä½“éªŒä¸Šå¸¦æ¥äº†æ˜¾è‘—æå‡ã€‚åƒ Hyperf è¿™ç±»ç°ä»£æ¡†æ¶å·²å…¨é¢è½¬å‘ä½¿ç”¨åŸç”Ÿ Attributesã€‚</p>\n<h2 id=\"webman-vs-Hyperf-æ ¸å¿ƒåŸç†å¯¹æ¯”æ‘˜è¦\"><a href=\"#webman-vs-Hyperf-æ ¸å¿ƒåŸç†å¯¹æ¯”æ‘˜è¦\" class=\"headerlink\" title=\"webman vs Hyperf æ ¸å¿ƒåŸç†å¯¹æ¯”æ‘˜è¦\"></a>webman vs Hyperf æ ¸å¿ƒåŸç†å¯¹æ¯”æ‘˜è¦</h2><div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">ç‰¹æ€§</th>\n<th style=\"text-align:left\">webman</th>\n<th style=\"text-align:left\">Hyperf</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\"><strong>æ ¸å¿ƒå¼•æ“</strong></td>\n<td style=\"text-align:left\">Workerman (äº‹ä»¶é©±åŠ¨, å¤šè¿›ç¨‹)</td>\n<td style=\"text-align:left\">Swoole (äº‹ä»¶é©±åŠ¨ + <strong>åç¨‹</strong>, å¤šè¿›ç¨‹)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>ç¼–ç¨‹æ¨¡å‹</strong></td>\n<td style=\"text-align:left\">äº‹ä»¶å›è°ƒ + ä¼ ç»ŸåŒæ­¥é€»è¾‘ (éœ€è‡ªè¡Œç®¡ç†é˜»å¡I/O)</td>\n<td style=\"text-align:left\"><strong>åç¨‹</strong> (åŒæ­¥å†™æ³•, å¼‚æ­¥éé˜»å¡I/O)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>æ€§èƒ½å…³é”®</strong></td>\n<td style=\"text-align:left\">å¸¸é©»å†…å­˜ (å‡å°‘åˆå§‹åŒ–å¼€é”€)</td>\n<td style=\"text-align:left\">å¸¸é©»å†…å­˜ + <strong>åç¨‹</strong> (é«˜å¹¶å‘, ä½èµ„æºæ¶ˆè€—)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>è¿æ¥ç®¡ç†</strong></td>\n<td style=\"text-align:left\">éœ€æ‰‹åŠ¨ç®¡ç†æˆ–å€ŸåŠ©æ’ä»¶/è¿æ¥æ± </td>\n<td style=\"text-align:left\"><strong>å†…ç½®åç¨‹è¿æ¥æ± </strong> (DB, Redis, HTTP Clientç­‰)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>æ ¸å¿ƒæœºåˆ¶</strong></td>\n<td style=\"text-align:left\">è½»é‡è·¯ç”±ã€ä¸­é—´ä»¶ã€PSR å°è£…</td>\n<td style=\"text-align:left\"><strong>å¼ºå¤§çš„DIå®¹å™¨</strong>ã€<strong>æ³¨è§£é©±åŠ¨</strong>ã€<strong>AOP</strong>ã€ä¸°å¯Œç»„ä»¶åŒ–</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>å¹¶å‘èƒ½åŠ›</strong></td>\n<td style=\"text-align:left\">é«˜ (å¤šè¿›ç¨‹)</td>\n<td style=\"text-align:left\"><strong>æé«˜</strong> (å¤šè¿›ç¨‹ + å•è¿›ç¨‹å†…é«˜åç¨‹å¹¶å‘)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>å¤æ‚åº¦</strong></td>\n<td style=\"text-align:left\"><strong>è½»é‡ç®€å•</strong>ï¼Œå­¦ä¹ æ›²çº¿å¹³ç¼“</td>\n<td style=\"text-align:left\"><strong>åŠŸèƒ½å¼ºå¤§å¤æ‚</strong>ï¼Œå­¦ä¹ æ›²çº¿è¾ƒé™¡ (éœ€ç†è§£DI, AOP, åç¨‹)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>å®šä½</strong></td>\n<td style=\"text-align:left\">é«˜æ€§èƒ½ HTTP API / ç®€å•å®æ—¶åº”ç”¨</td>\n<td style=\"text-align:left\">ä¼ä¸šçº§ã€å¾®æœåŠ¡ã€åˆ†å¸ƒå¼ç³»ç»Ÿã€å¤æ‚é«˜å¹¶å‘åº”ç”¨</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>çƒ­æ›´æ–°</strong></td>\n<td style=\"text-align:left\">æ”¯æŒ (åŸºäº inotify/kqueue)</td>\n<td style=\"text-align:left\">æ”¯æŒ (åŸºäº inotify/kqueue)</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"><strong>ä»£è¡¨æŠ€æœ¯</strong></td>\n<td style=\"text-align:left\">æ–‡ä»¶ç›‘å¬ã€Workerman API</td>\n<td style=\"text-align:left\">Attributesã€AOPã€ä¾èµ–æ³¨å…¥ã€è¿æ¥æ± ã€æœåŠ¡æ²»ç†</td>\n</tr>\n</tbody>\n</table>\n</div>\n",
            "tags": [
                "php",
                "hyperf",
                "webman"
            ]
        },
        {
            "id": "https://erik.xyz/2025/04/11/python-backstage-project/",
            "url": "https://erik.xyz/2025/04/11/python-backstage-project/",
            "title": "pythonåç«¯ç®¡ç†æ¡†æ¶æœ‰å“ªäº›",
            "date_published": "2025-04-11T13:24:00.000Z",
            "content_html": "<p>Python åç«¯ç®¡ç†æ¡†æ¶ä¸»è¦ç”¨äºå¿«é€Ÿæ„å»ºåå°ç®¡ç†ç³»ç»Ÿï¼ˆå¦‚æ•°æ®ç®¡ç†ã€ç”¨æˆ·æƒé™æ§åˆ¶ç­‰ï¼‰ã€‚ä»¥ä¸‹æ˜¯å¸¸è§çš„ Python åç«¯ç®¡ç†æ¡†æ¶åˆ†ç±»åŠä»£è¡¨å·¥å…·ï¼š</p>\n<hr>\n<h3 id=\"1-åŸºäº-Django-çš„æ¡†æ¶\"><a href=\"#1-åŸºäº-Django-çš„æ¡†æ¶\" class=\"headerlink\" title=\"1. åŸºäº Django çš„æ¡†æ¶\"></a><strong>1. åŸºäº Django çš„æ¡†æ¶</strong></h3><ul>\n<li><strong>Django Admin</strong>  <ul>\n<li>Django å†…ç½®çš„ç®¡ç†åå°ï¼Œå¼€ç®±å³ç”¨ã€‚  </li>\n<li>æ”¯æŒ ORM è‡ªåŠ¨ç”Ÿæˆ CRUD ç•Œé¢ï¼Œé€‚åˆå¿«é€Ÿå¼€å‘ã€‚  </li>\n<li><strong>ç¼ºç‚¹</strong>ï¼šé»˜è®¤ç•Œé¢è¾ƒç®€é™‹ï¼ˆå¯é€šè¿‡æ’ä»¶ç¾åŒ–ï¼‰ã€‚  <figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ç¤ºä¾‹ï¼šæ³¨å†Œæ¨¡å‹åˆ° Admin</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> django.contrib <span class=\"keyword\">import</span> admin</span><br><span class=\"line\"><span class=\"keyword\">from</span> .models <span class=\"keyword\">import</span> Product</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@admin.register(<span class=\"params\">Product</span>)</span></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">ProductAdmin</span>(admin.ModelAdmin):</span><br><span class=\"line\">    list_display = (<span class=\"string\">&#x27;name&#x27;</span>, <span class=\"string\">&#x27;price&#x27;</span>)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n</ul>\n<span id=\"more\"></span>\n<ul>\n<li><strong>Django Jet</strong>  <ul>\n<li>ç°ä»£åŒ–çš„ Django Admin ä¸»é¢˜ï¼ˆæ”¯æŒå“åº”å¼å¸ƒå±€ï¼‰ã€‚  </li>\n</ul>\n</li>\n<li><strong>Django Grappelli</strong>  <ul>\n<li>ç»å…¸çš„ç¾åŒ–æ‰©å±•ï¼Œæä¾›æ›´å‹å¥½çš„ UIã€‚  </li>\n</ul>\n</li>\n<li><strong>Django Suit</strong>  <ul>\n<li>å¦ä¸€ä¸ªæµè¡Œçš„ Admin ä¸»é¢˜ï¼ˆéœ€ä»˜è´¹ï¼‰ã€‚  </li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3 id=\"2-åŸºäº-Flask-çš„æ¡†æ¶\"><a href=\"#2-åŸºäº-Flask-çš„æ¡†æ¶\" class=\"headerlink\" title=\"2. åŸºäº Flask çš„æ¡†æ¶\"></a><strong>2. åŸºäº Flask çš„æ¡†æ¶</strong></h3><ul>\n<li><p><strong>Flask-Admin</strong>  </p>\n<ul>\n<li>è½»é‡çº§ã€é«˜åº¦å¯å®šåˆ¶ï¼Œæ”¯æŒå¤šç§æ•°æ®åº“åç«¯ï¼ˆSQLAlchemyã€MongoDB ç­‰ï¼‰ã€‚  </li>\n<li><strong>ç‰¹ç‚¹</strong>ï¼šçµæ´»æ€§é«˜ï¼Œé€‚åˆä¸­å¤§å‹é¡¹ç›®ã€‚  <figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ç¤ºä¾‹ï¼šé›†æˆ Flask-Admin</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> flask <span class=\"keyword\">import</span> Flask</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_sqlalchemy <span class=\"keyword\">import</span> SQLAlchemy</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_admin <span class=\"keyword\">import</span> Admin</span><br><span class=\"line\"><span class=\"keyword\">from</span> flask_admin.contrib.sqla <span class=\"keyword\">import</span> ModelView</span><br><span class=\"line\"></span><br><span class=\"line\">app = Flask(__name__)</span><br><span class=\"line\">db = SQLAlchemy(app)</span><br><span class=\"line\">admin = Admin(app, name=<span class=\"string\">&#x27;ç®¡ç†åå°&#x27;</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">class</span> <span class=\"title class_\">Product</span>(db.Model):</span><br><span class=\"line\">    <span class=\"built_in\">id</span> = db.Column(db.Integer, primary_key=<span class=\"literal\">True</span>)</span><br><span class=\"line\">    name = db.Column(db.String(<span class=\"number\">80</span>))</span><br><span class=\"line\"></span><br><span class=\"line\">admin.add_view(ModelView(Product, db.session))</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p><strong>Flask-AppBuilder</strong>  </p>\n<ul>\n<li>å¿«é€Ÿç”Ÿæˆ CRUD ç•Œé¢ï¼Œå†…ç½® RBAC æƒé™æ§åˆ¶ã€‚  </li>\n<li>æä¾›å›¾è¡¨ã€è¡¨å•ç”Ÿæˆç­‰é«˜çº§åŠŸèƒ½ã€‚  </li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3 id=\"3-ç‹¬ç«‹-é€šç”¨æ¡†æ¶\"><a href=\"#3-ç‹¬ç«‹-é€šç”¨æ¡†æ¶\" class=\"headerlink\" title=\"3. ç‹¬ç«‹/é€šç”¨æ¡†æ¶\"></a><strong>3. ç‹¬ç«‹/é€šç”¨æ¡†æ¶</strong></h3><ul>\n<li><strong>SQLAlchemy-Admin</strong>  <ul>\n<li>åŸºäº SQLAlchemy çš„ç‹¬ç«‹ç®¡ç†ç•Œé¢ï¼Œä¸ä¾èµ– Web æ¡†æ¶ã€‚  </li>\n</ul>\n</li>\n<li><strong>WTForms-Alchemy</strong>  <ul>\n<li>è‡ªåŠ¨ä» SQLAlchemy æ¨¡å‹ç”Ÿæˆè¡¨å•ï¼ˆå¸¸ä¸ Flask-Admin é…åˆä½¿ç”¨ï¼‰ã€‚  </li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3 id=\"4-åŸºäº-FastAPI-çš„æ¡†æ¶\"><a href=\"#4-åŸºäº-FastAPI-çš„æ¡†æ¶\" class=\"headerlink\" title=\"4. åŸºäº FastAPI çš„æ¡†æ¶\"></a><strong>4. åŸºäº FastAPI çš„æ¡†æ¶</strong></h3><ul>\n<li><p><strong>FastAPI Admin</strong>  </p>\n<ul>\n<li>å¼‚æ­¥æ”¯æŒï¼Œé€‚åˆé«˜æ€§èƒ½åœºæ™¯ã€‚  </li>\n<li>æä¾›æ¨¡å‹ç®¡ç†ã€æ–‡ä»¶ä¸Šä¼ ç­‰åŠŸèƒ½ã€‚  <figure class=\"highlight python\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># ç¤ºä¾‹ï¼šFastAPI-Admin åŸºç¡€ä½¿ç”¨</span></span><br><span class=\"line\"><span class=\"keyword\">from</span> fastapi <span class=\"keyword\">import</span> FastAPI</span><br><span class=\"line\"><span class=\"keyword\">from</span> fastapi_admin.app <span class=\"keyword\">import</span> app <span class=\"keyword\">as</span> admin_app</span><br><span class=\"line\"><span class=\"keyword\">from</span> fastapi_admin.providers.login <span class=\"keyword\">import</span> UsernamePasswordProvider</span><br><span class=\"line\"></span><br><span class=\"line\">app = FastAPI()</span><br><span class=\"line\">admin_app.add_provider(UsernamePasswordProvider())</span><br><span class=\"line\">app.mount(<span class=\"string\">&quot;/admin&quot;</span>, admin_app)</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n</li>\n<li><p><strong>SQLModel-Admin</strong>  </p>\n<ul>\n<li>åŸºäº SQLModelï¼ˆFastAPI å®˜æ–¹ ORMï¼‰çš„ç®¡ç†ç•Œé¢ã€‚  </li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3 id=\"5-ä½ä»£ç -å¯è§†åŒ–å·¥å…·\"><a href=\"#5-ä½ä»£ç -å¯è§†åŒ–å·¥å…·\" class=\"headerlink\" title=\"5. ä½ä»£ç /å¯è§†åŒ–å·¥å…·\"></a><strong>5. ä½ä»£ç /å¯è§†åŒ–å·¥å…·</strong></h3><ul>\n<li><strong>AppSmith / ToolJet</strong>  <ul>\n<li>æ”¯æŒè¿æ¥æ•°æ®åº“/APIï¼Œé€šè¿‡æ‹–æ‹½ç”Ÿæˆç®¡ç†ç•Œé¢ï¼ˆéçº¯ Pythonï¼Œä½†å¯é›†æˆï¼‰ã€‚  </li>\n</ul>\n</li>\n<li><strong>Django Builder</strong>  <ul>\n<li>å¯è§†åŒ–æ„å»º Django åå°çš„ç¬¬ä¸‰æ–¹å·¥å…·ã€‚  </li>\n</ul>\n</li>\n</ul>\n<hr>\n<h3 id=\"é€‰æ‹©å»ºè®®\"><a href=\"#é€‰æ‹©å»ºè®®\" class=\"headerlink\" title=\"é€‰æ‹©å»ºè®®\"></a><strong>é€‰æ‹©å»ºè®®</strong></h3><ul>\n<li><strong>å¿«é€ŸåŸå‹</strong>ï¼šç”¨ Django Adminï¼ˆDjango é¡¹ç›®ï¼‰æˆ– Flask-AppBuilderï¼ˆFlask é¡¹ç›®ï¼‰ã€‚  </li>\n<li><strong>é«˜å®šåˆ¶åŒ–</strong>ï¼šé€‰ Flask-Admin æˆ–æ‰‹åŠ¨æ‰©å±• Django Adminã€‚  </li>\n<li><strong>ç°ä»£å¼‚æ­¥æ¶æ„</strong>ï¼šé€‰ FastAPI Adminã€‚  </li>\n<li><strong>ä½ä»£ç éœ€æ±‚</strong>ï¼šAppSmith/ToolJet + Python APIã€‚  </li>\n</ul>\n<p>æ ¹æ®é¡¹ç›®éœ€æ±‚å’ŒæŠ€æœ¯æ ˆé€‰æ‹©åˆé€‚çš„å·¥å…·ï¼Œèƒ½å¤§å¹…æå‡åå°ç®¡ç†ç³»ç»Ÿçš„å¼€å‘æ•ˆç‡ï¼</p>\n",
            "tags": [
                "python"
            ]
        },
        {
            "id": "https://erik.xyz/2025/03/22/github-open-project-im/",
            "url": "https://erik.xyz/2025/03/22/github-open-project-im/",
            "title": "githubå¼€æºçš„å³æ—¶é€šè®¯é¡¹ç›®",
            "date_published": "2025-03-22T02:01:00.000Z",
            "content_html": "<p>ä»¥ä¸‹æ˜¯ GitHub ä¸Šå½“å‰æ´»è·ƒä¸”åŠŸèƒ½å¼ºå¤§çš„å¼€æºå³æ—¶é€šè®¯ï¼ˆIMï¼‰é¡¹ç›®ï¼Œæ¶µç›–ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆã€è½»é‡çº§åº”ç”¨å’Œåˆ›æ–°å‹å¹³å°ï¼Œé€‚åˆä¸åŒå¼€å‘éœ€æ±‚ï¼š</p>\n<hr>\n<h3 id=\"ğŸ”§-ä¸€ã€ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆï¼ˆé«˜å¯ç”¨ã€å¯æ‰©å±•ï¼‰\"><a href=\"#ğŸ”§-ä¸€ã€ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆï¼ˆé«˜å¯ç”¨ã€å¯æ‰©å±•ï¼‰\" class=\"headerlink\" title=\"ğŸ”§ ä¸€ã€ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆï¼ˆé«˜å¯ç”¨ã€å¯æ‰©å±•ï¼‰\"></a>ğŸ”§ <strong>ä¸€ã€ä¼ä¸šçº§è§£å†³æ–¹æ¡ˆï¼ˆé«˜å¯ç”¨ã€å¯æ‰©å±•ï¼‰</strong></h3><ol>\n<li><strong>OpenIM</strong>  <ul>\n<li><strong>æŠ€æœ¯æ ˆ</strong>ï¼šGo è¯­è¨€æœåŠ¡ç«¯ï¼Œæ”¯æŒ Android/iOS/Web/Flutter ç­‰å…¨å¹³å° SDK ã€‚  </li>\n<li><strong>æ ¸å¿ƒç‰¹æ€§</strong>ï¼š  <ul>\n<li>ç§æœ‰åŒ–éƒ¨ç½²ï¼Œæ•°æ®å®Œå…¨è‡ªæ§ï¼Œæ”¯æŒé›†ç¾¤æ‰©å±•è‡³äº¿çº§ç”¨æˆ· ã€‚  </li>\n<li>æ¶ˆæ¯å¿…è¾¾ï¼ˆ100% å¯é æ€§ï¼‰ï¼Œæ”¯æŒå•èŠã€ç¾¤èŠï¼ˆ10 ä¸‡äººè¶…å¤§ç¾¤ï¼‰ã€å·²è¯»å›æ‰§ã€æ¶ˆæ¯æ’¤å›ç­‰ ã€‚  </li>\n<li>é›†æˆç»„ç»‡æ¶æ„ã€å·¥ä½œåœˆã€éŸ³è§†é¢‘é€šè¯ï¼Œé€‚åˆæ”¿ä¼åŠå…¬åœºæ™¯ ã€‚  </li>\n</ul>\n</li>\n<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šæ›¿ä»£å•†ä¸š IM äº‘æœåŠ¡ï¼ˆå¦‚èäº‘ã€ç¯ä¿¡ï¼‰ï¼Œé™ä½é•¿æœŸæˆæœ¬ ã€‚  </li>\n<li><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href=\"https://github.com/OpenIMSDK\">GitHub - OpenIMSDK</a> | ğŸŒŸ <strong>Star 9k+</strong> ã€‚</li>\n</ul>\n</li>\n</ol>\n<span id=\"more\"></span>\n<hr>\n<h3 id=\"ğŸ–¥ï¸-äºŒã€è½»é‡çº§è·¨å¹³å°åº”ç”¨\"><a href=\"#ğŸ–¥ï¸-äºŒã€è½»é‡çº§è·¨å¹³å°åº”ç”¨\" class=\"headerlink\" title=\"ğŸ–¥ï¸ äºŒã€è½»é‡çº§è·¨å¹³å°åº”ç”¨\"></a>ğŸ–¥ï¸ <strong>äºŒã€è½»é‡çº§è·¨å¹³å°åº”ç”¨</strong></h3><ol>\n<li><p><strong>HuLa</strong>  </p>\n<ul>\n<li><strong>æŠ€æœ¯æ ˆ</strong>ï¼šåŸºäº Tauriï¼ˆRust è·¨å¹³å°æ¡†æ¶ï¼‰ + Vue 3 + TypeScriptï¼Œæ”¯æŒ Windows/macOS/Linux ã€‚  </li>\n<li><strong>æ ¸å¿ƒç‰¹æ€§</strong>ï¼š  <ul>\n<li>è½»é‡é«˜æ•ˆï¼ˆèµ„æºå ç”¨ä½ï¼‰ï¼Œæ”¯æŒæ–‡å­—ã€è¯­éŸ³ã€è§†é¢‘é€šè¯åŠæ–‡ä»¶ä¼ è¾“ ã€‚  </li>\n<li>å†…ç½®ä¸»é¢˜å®šåˆ¶ã€è¡¨æƒ…åŒ…ã€ç¾¤ç»„ç®¡ç†ï¼Œç•Œé¢ç®€æ´æ˜“ç”¨ ã€‚  </li>\n</ul>\n</li>\n<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šä¸ªäººå¼€å‘è€…å¿«é€Ÿæ„å»ºæ¡Œé¢ç«¯èŠå¤©åº”ç”¨ã€‚  </li>\n<li><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href=\"https://github.com/HuLaSpark/HuLa\">GitHub - HuLaSpark</a>ã€‚</li>\n</ul>\n</li>\n<li><p><strong>Tailchat</strong>  </p>\n<ul>\n<li><strong>æŠ€æœ¯æ ˆ</strong>ï¼šReact + TypeScript + Node.jsï¼Œæ’ä»¶åŒ–æ¶æ„ï¼ˆç±»ä¼¼ Discordï¼‰ã€‚  </li>\n<li><strong>æ ¸å¿ƒç‰¹æ€§</strong>ï¼š  <ul>\n<li>é«˜åº¦å¯æ‰©å±•çš„æ’ä»¶ç³»ç»Ÿï¼ˆ30+ å®˜æ–¹æ’ä»¶ï¼‰ï¼Œæ”¯æŒèº«ä»½ç»„æƒé™ç®¡ç†ã€è‡ªå®šä¹‰é¢æ¿ ã€‚  </li>\n<li>å¤šç«¯åŒæ­¥ï¼ˆWeb/ç§»åŠ¨/æ¡Œé¢ï¼‰ï¼Œé›†æˆå¼€æ”¾å¹³å°ï¼ˆæœºå™¨äººã€ç¬¬ä¸‰æ–¹ç™»å½•ï¼‰ã€‚  </li>\n</ul>\n</li>\n<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šç¤¾åŒºåä½œã€æ¸¸æˆç¤¾äº¤ç­‰éœ€å®šåˆ¶åŒ–åŠŸèƒ½çš„åœºæ™¯ã€‚  </li>\n<li><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href=\"https://github.com/msgbyte/tailchat\">GitHub - Tailchat</a>ã€‚</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3 id=\"ğŸ”Œ-ä¸‰ã€å‚ç›´åœºæ™¯ä¸é›†æˆæ–¹æ¡ˆ\"><a href=\"#ğŸ”Œ-ä¸‰ã€å‚ç›´åœºæ™¯ä¸é›†æˆæ–¹æ¡ˆ\" class=\"headerlink\" title=\"ğŸ”Œ ä¸‰ã€å‚ç›´åœºæ™¯ä¸é›†æˆæ–¹æ¡ˆ\"></a>ğŸ”Œ <strong>ä¸‰ã€å‚ç›´åœºæ™¯ä¸é›†æˆæ–¹æ¡ˆ</strong></h3><ol>\n<li><p><strong>åŸºäºç¯ä¿¡ SDK çš„ç¤¾äº¤åº”ç”¨</strong>  </p>\n<ul>\n<li><strong>ä»£è¡¨é¡¹ç›®</strong>ï¼šé«˜ä»¿å¾®ä¿¡ã€å›¾å¿†ï¼ˆLBS ç¤¾äº¤ï¼‰ã€ç¾è‚¤ GOï¼ˆç”µå•†å®¢æœï¼‰ã€‚  </li>\n<li><strong>ç‰¹ç‚¹</strong>ï¼šæä¾›å®Œæ•´ UI å’Œä¸šåŠ¡é€»è¾‘æºç ï¼Œé€‚åˆå¿«é€Ÿé›†æˆç¤¾äº¤åŠŸèƒ½ã€‚  </li>\n<li><strong>é¡¹ç›®ç¤ºä¾‹</strong>ï¼š<a href=\"https://github.com/CameloeAnthony/Perfect_IM_SNS\">GitHub - ç¯ä¿¡ Demo åˆé›†</a>ã€‚</li>\n</ul>\n</li>\n<li><p><strong>FreeTubeï¼ˆéšç§å‘ IM æ‰©å±•ï¼‰</strong>  </p>\n<ul>\n<li><strong>æŠ€æœ¯æ ˆ</strong>ï¼šJavaScript æ¡Œé¢åº”ç”¨ï¼Œä¸“æ³¨éšç§ä¿æŠ¤ ã€‚  </li>\n<li><strong>ç‰¹è‰²</strong>ï¼šæ— å¹¿å‘Šã€æ— è¿½è¸ªï¼Œæœ¬åœ°å­˜å‚¨ç”¨æˆ·æ•°æ®ï¼Œé€‚åˆå®‰å…¨æ•æ„Ÿåœºæ™¯ã€‚  </li>\n<li><strong>é¡¹ç›®åœ°å€</strong>ï¼š<a href=\"https://github.com/FreeTubeApp/FreeTube\">GitHub - FreeTube</a> | ğŸŒŸ Star 15k+ã€‚</li>\n</ul>\n</li>\n</ol>\n<hr>\n<h3 id=\"ğŸ“Š-æ ¸å¿ƒé¡¹ç›®å¯¹æ¯”\"><a href=\"#ğŸ“Š-æ ¸å¿ƒé¡¹ç›®å¯¹æ¯”\" class=\"headerlink\" title=\"ğŸ“Š æ ¸å¿ƒé¡¹ç›®å¯¹æ¯”\"></a>ğŸ“Š <strong>æ ¸å¿ƒé¡¹ç›®å¯¹æ¯”</strong></h3><div class=\"table-container\">\n<table>\n<thead>\n<tr>\n<th><strong>é¡¹ç›®</strong></th>\n<th><strong>æŠ€æœ¯ä¼˜åŠ¿</strong></th>\n<th><strong>é€‚ç”¨åœºæ™¯</strong></th>\n<th><strong>éƒ¨ç½²å¤æ‚åº¦</strong></th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><strong>OpenIM</strong></td>\n<td>é«˜å¹¶å‘ã€ä¼ä¸šçº§åŠŸèƒ½å…¨</td>\n<td>æ”¿åŠ¡/å¤§å‹ä¼ä¸š IM</td>\n<td>ä¸­é«˜ï¼ˆéœ€ Dockerï¼‰</td>\n</tr>\n<tr>\n<td><strong>HuLa</strong></td>\n<td>è½»é‡è·¨å¹³å°ã€å¼€å‘å¿«æ·</td>\n<td>ä¸ªäºº/å°å›¢é˜Ÿæ¡Œé¢åº”ç”¨</td>\n<td>ä½</td>\n</tr>\n<tr>\n<td><strong>Tailchat</strong></td>\n<td>æ’ä»¶åŒ–ã€é«˜åº¦å¯å®šåˆ¶</td>\n<td>ç¤¾åŒº/æ¸¸æˆç¤¾äº¤å¹³å°</td>\n<td>ä¸­</td>\n</tr>\n</tbody>\n</table>\n</div>\n<hr>\n<h3 id=\"ğŸ’¡-å››ã€é€‰å‹å»ºè®®\"><a href=\"#ğŸ’¡-å››ã€é€‰å‹å»ºè®®\" class=\"headerlink\" title=\"ğŸ’¡ å››ã€é€‰å‹å»ºè®®\"></a>ğŸ’¡ <strong>å››ã€é€‰å‹å»ºè®®</strong></h3><ul>\n<li><strong>è¿½æ±‚ä¼ä¸šçº§ç¨³å®šæ€§</strong>ï¼šé€‰æ‹© <strong>OpenIM</strong>ï¼Œæ”¯æŒç§æœ‰åŒ–éƒ¨ç½²å’Œå›½äº§åŒ–éœ€æ±‚ ã€‚  </li>\n<li><strong>å¿«é€Ÿå¼€å‘æ¡Œé¢ç«¯åº”ç”¨</strong>ï¼š<strong>HuLa</strong> çš„ç°ä»£å‰ç«¯æŠ€æœ¯æ ˆï¼ˆVue3 + Tauriï¼‰å¯å¤§å¹…æå‡æ•ˆç‡ ã€‚  </li>\n<li><strong>éœ€è¦é«˜åº¦å®šåˆ¶åŒ–</strong>ï¼š<strong>Tailchat</strong> çš„æ’ä»¶æœºåˆ¶å…è®¸è‡ªç”±æ‰©å±•åŠŸèƒ½ ã€‚  </li>\n</ul>\n<blockquote>\n<p>ğŸ’¡ æ›´å¤šé¡¹ç›®æºç å’Œéƒ¨ç½²æŒ‡å—å¯è®¿é—®å¯¹åº” GitHub ä»“åº“ã€‚è‹¥éœ€æ›¿ä»£å•†ä¸š IM æœåŠ¡ï¼ˆå¦‚èäº‘ã€ç¯ä¿¡ï¼‰ï¼ŒOpenIM çš„ç§æœ‰åŒ–æ–¹æ¡ˆèƒ½æ˜¾è‘—é™ä½æˆæœ¬å¹¶æå‡æ•°æ®å®‰å…¨æ€§ ã€‚</p>\n</blockquote>\n",
            "tags": [
                "php",
                "im"
            ]
        },
        {
            "id": "https://erik.xyz/2025/02/13/open-source-esktop-sharing-tool/",
            "url": "https://erik.xyz/2025/02/13/open-source-esktop-sharing-tool/",
            "title": "å¼€æºæ¡Œé¢å…±äº«å·¥å…·",
            "date_published": "2025-02-13T13:35:00.000Z",
            "content_html": "<h2 id=\"1-xrdp\"><a href=\"#1-xrdp\" class=\"headerlink\" title=\"1. xrdp\"></a>1. <a href=\"https://github.com/neutrinolabs/xrdp\">xrdp</a></h2><ul>\n<li><strong>åŠŸèƒ½</strong>ï¼šxrdp æ˜¯ä¸€ä¸ªå¼€æºçš„è¿œç¨‹æ¡Œé¢åè®® (RDP) æœåŠ¡å™¨ï¼Œå…è®¸ Linux ç³»ç»Ÿé€šè¿‡ Windows çš„ RDP å®¢æˆ·ç«¯è¿œç¨‹è®¿é—®ã€‚å®ƒä¸ Microsoft RDP åè®®å…¼å®¹ï¼Œèƒ½å¤Ÿè®©ä½ ä» Windows å®¢æˆ·ç«¯è¿æ¥åˆ° Linux ç³»ç»Ÿã€‚</li>\n<li><strong>å®‰è£…</strong>ï¼šé€šå¸¸å¯ä»¥é€šè¿‡ Linux çš„åŒ…ç®¡ç†å™¨å®‰è£…ï¼Œä¾‹å¦‚åœ¨ Ubuntu ä¸Šä½¿ç”¨å‘½ä»¤ï¼š<span id=\"more\"></span>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt install xrdp</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"2-VNC-Virtual-Network-Computing\"><a href=\"#2-VNC-Virtual-Network-Computing\" class=\"headerlink\" title=\"2. VNC (Virtual Network Computing)\"></a>2. VNC (Virtual Network Computing)</h2><ul>\n<li><strong>åŠŸèƒ½</strong>ï¼šVNC æ˜¯ä¸€ç§å›¾å½¢æ¡Œé¢å…±äº«ç³»ç»Ÿï¼Œæ”¯æŒè·¨å¹³å°è¿œç¨‹è®¿é—®ã€‚å¸¸è§çš„å¼€æº VNC å®ç°æœ‰ï¼š<ul>\n<li><strong>TightVNC</strong>ï¼šè½»é‡çº§ä¸”æ€§èƒ½ä¼˜åŒ–ã€‚</li>\n<li><strong>TigerVNC</strong>ï¼šå¢å¼ºäº†æ€§èƒ½å’Œå®‰å…¨æ€§ã€‚</li>\n<li><strong>RealVNC</strong>ï¼šæä¾›å•†ä¸šå’Œå¼€æºç‰ˆæœ¬ã€‚</li>\n</ul>\n</li>\n<li><strong>å®‰è£…</strong>ï¼šå¯ä»¥é€šè¿‡åŒ…ç®¡ç†å™¨ï¼ˆå¦‚ <code>apt</code>ï¼‰å®‰è£…ï¼Œæˆ–é€šè¿‡ä¸‹è½½å…¶æºä»£ç æ¥å®‰è£…ã€‚</li>\n</ul>\n<h2 id=\"3-NoMachine\"><a href=\"#3-NoMachine\" class=\"headerlink\" title=\"3. NoMachine\"></a>3. <a href=\"https://www.nomachine.com/\">NoMachine</a></h2><ul>\n<li><strong>åŠŸèƒ½</strong>ï¼šNoMachine æ˜¯ä¸€æ¬¾å¼€æºè¿œç¨‹æ¡Œé¢è§£å†³æ–¹æ¡ˆï¼Œæ”¯æŒè·¨å¹³å°è¿œç¨‹è®¿é—®ã€‚å®ƒå…·æœ‰é«˜æ€§èƒ½å’Œè¾ƒä½å»¶è¿Ÿï¼Œæ”¯æŒéŸ³è§†é¢‘æµå’Œæ–‡ä»¶ä¼ è¾“ç­‰åŠŸèƒ½ã€‚</li>\n<li><strong>å®‰è£…</strong>ï¼šå¯ä»¥ç›´æ¥ä»å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®˜æ–¹çš„å¼€æºç‰ˆæœ¬è¿›è¡Œå®‰è£…ã€‚</li>\n</ul>\n<h2 id=\"4-Remmina\"><a href=\"#4-Remmina\" class=\"headerlink\" title=\"4. Remmina\"></a>4. <a href=\"https://github.com/FreeRDP/Remmina\">Remmina</a></h2><ul>\n<li><strong>åŠŸèƒ½</strong>ï¼šRemmina æ˜¯ä¸€ä¸ªæ”¯æŒå¤šç§è¿œç¨‹æ¡Œé¢åè®®çš„å®¢æˆ·ç«¯ï¼Œæ”¯æŒ RDPã€VNCã€SSH ç­‰å¤šç§åè®®ã€‚å®ƒçš„è®¾è®¡éå¸¸é€‚åˆ Linux ç”¨æˆ·ï¼Œä½†ä¹Ÿæ”¯æŒå…¶ä»–æ“ä½œç³»ç»Ÿã€‚</li>\n<li><strong>å®‰è£…</strong>ï¼šå¤§å¤šæ•° Linux å‘è¡Œç‰ˆéƒ½å¯ä»¥é€šè¿‡åŒ…ç®¡ç†å™¨å®‰è£…ï¼Œä¾‹å¦‚ï¼š<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">sudo</span> apt install remmina</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"5-FreeRDP\"><a href=\"#5-FreeRDP\" class=\"headerlink\" title=\"5. FreeRDP\"></a>5. <a href=\"https://github.com/FreeRDP/FreeRDP\">FreeRDP</a></h2><ul>\n<li><strong>åŠŸèƒ½</strong>ï¼šFreeRDP æ˜¯ä¸€ä¸ªå¼€æºçš„è¿œç¨‹æ¡Œé¢åè®®å®ç°ï¼Œå¯ä»¥ç”¨ä½œ RDP å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ã€‚å®ƒæ”¯æŒ Windows å’Œ Linux ç³»ç»Ÿä¹‹é—´çš„è¿œç¨‹è®¿é—®ï¼Œå¹¶ä¸”éå¸¸è½»é‡çº§ã€‚</li>\n<li><strong>å®‰è£…</strong>ï¼šå¯ä»¥é€šè¿‡åŒ…ç®¡ç†å™¨è¿›è¡Œå®‰è£…ï¼Œä¾‹å¦‚ï¼š<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">sudo</span> apt install freerdp2-x11</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<h2 id=\"6-WayVNC\"><a href=\"#6-WayVNC\" class=\"headerlink\" title=\"6. WayVNC\"></a>6. WayVNC</h2><ul>\n<li><strong>åŠŸèƒ½</strong>ï¼šWayVNC æ˜¯ä¸“é—¨ä¸º Wayland å…¼å®¹çš„ Linux ç³»ç»Ÿè®¾è®¡çš„ VNC æœåŠ¡å™¨ï¼Œé€‚ç”¨äºé‚£äº›ä½¿ç”¨ Wayland æ˜¾ç¤ºæœåŠ¡å™¨çš„ç³»ç»Ÿã€‚</li>\n<li><strong>å®‰è£…</strong>ï¼šå¯ä»¥é€šè¿‡æºç ç¼–è¯‘å®‰è£…ï¼Œæˆ–æŸ¥æ‰¾ç›¸å…³çš„ Linux åŒ…ã€‚</li>\n</ul>\n<h2 id=\"7-Guacamole\"><a href=\"#7-Guacamole\" class=\"headerlink\" title=\"7. Guacamole\"></a>7. <a href=\"http://guacamole.apache.org/\">Guacamole</a></h2><ul>\n<li><strong>åŠŸèƒ½</strong>ï¼šGuacamole æ˜¯ä¸€ä¸ªåŸºäº Web çš„è¿œç¨‹æ¡Œé¢å®¢æˆ·ç«¯ï¼Œæ”¯æŒ RDPã€VNC å’Œ SSHã€‚ä½ å¯ä»¥é€šè¿‡æµè§ˆå™¨è®¿é—®å¹¶è¿œç¨‹æ§åˆ¶è®¡ç®—æœºï¼Œå®‰è£…è¾ƒä¸ºå¤æ‚ï¼Œé€šå¸¸éœ€è¦é…ç½® Web æœåŠ¡å™¨ã€‚</li>\n<li><strong>å®‰è£…</strong>ï¼šéœ€è¦åœ¨æœåŠ¡å™¨ç«¯å®‰è£… Guacamoleï¼Œå¹¶é…ç½®ç›¸åº”çš„ Web æœåŠ¡å™¨ã€‚å®ƒæ”¯æŒå„ç§æ“ä½œç³»ç»Ÿã€‚</li>\n</ul>\n",
            "tags": [
                "å·¥å…·",
                "å¼€æºå·¥å…·",
                "æ¡Œé¢å…±äº«å·¥å…·"
            ]
        },
        {
            "id": "https://erik.xyz/2025/02/05/baimasi/",
            "url": "https://erik.xyz/2025/02/05/baimasi/",
            "title": "ç™½é©¬å¯º",
            "date_published": "2025-02-05T05:16:00.000Z",
            "content_html": "<pre><code>      ç™½é©¬å¯º\n\nåƒå¹´é£éœœæ–‘é©³ç›®ï¼Œæ–°å‡ºå¯°å®‡å®¢æ¥æ…•ã€‚\nä½›ä¸˜å·²éä»Šæœæ—¶ï¼Œç‹¬å¾—æ¯æœ¨é€¢æ˜¥æ—¶ã€‚\n</code></pre>",
            "tags": [
                "éšç¬”"
            ]
        },
        {
            "id": "https://erik.xyz/2025/01/12/composer-intranet-deployment/",
            "url": "https://erik.xyz/2025/01/12/composer-intranet-deployment/",
            "title": "composerå†…ç½‘éƒ¨ç½²",
            "date_published": "2025-01-12T14:01:00.000Z",
            "content_html": "<p>åœ¨å†…ç½‘ç¯å¢ƒä¸­éƒ¨ç½² Composerï¼ˆPHPçš„ä¾èµ–ç®¡ç†å·¥å…·ï¼‰ï¼Œé€šå¸¸æ˜¯ä¸ºäº†é¿å…å› å¤–ç½‘è®¿é—®é™åˆ¶è€Œå¯¼è‡´çš„ä¾èµ–ä¸‹è½½é—®é¢˜ã€‚å†…ç½‘éƒ¨ç½² Composer ä¸»è¦æ¶‰åŠé…ç½®ä¸€ä¸ª ç§æœ‰ Composer ä»“åº“ï¼Œæˆ–è€…ä½¿ç”¨ æœ¬åœ°ä»£ç†é•œåƒ æ¥åŠ é€Ÿå’Œç®¡ç†ä¾èµ–ã€‚</p>\n<h3 id=\"1-ä½¿ç”¨-composer-json-è®¾ç½®ä¾èµ–\"><a href=\"#1-ä½¿ç”¨-composer-json-è®¾ç½®ä¾èµ–\" class=\"headerlink\" title=\"1. ä½¿ç”¨ composer.json è®¾ç½®ä¾èµ–\"></a><b>1. ä½¿ç”¨ composer.json è®¾ç½®ä¾èµ–</b></h3><p>é¦–å…ˆï¼Œç¡®ä¿ä½ çš„ composer.json æ–‡ä»¶åŒ…å«æ‰€æœ‰é¡¹ç›®ä¾èµ–ï¼Œå¹¶æ­£ç¡®é…ç½®äº†åŒ…çš„ç‰ˆæœ¬å’Œæ¥æºã€‚<br><span id=\"more\"></span><br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;name&quot;: &quot;vendor/project&quot;,</span><br><span class=\"line\">    &quot;require&quot;: &#123;</span><br><span class=\"line\">        &quot;monolog/monolog&quot;: &quot;^2.0&quot;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure></p>\n<h3 id=\"2-ä½¿ç”¨ä»£ç†é•œåƒ\"><a href=\"#2-ä½¿ç”¨ä»£ç†é•œåƒ\" class=\"headerlink\" title=\"2. ä½¿ç”¨ä»£ç†é•œåƒ\"></a><b>2. ä½¿ç”¨ä»£ç†é•œåƒ</b></h3><p>ç”±äºå†…ç½‘æ— æ³•ç›´æ¥è®¿é—® Composer å®˜æ–¹çš„åŒ…ä»“åº“ï¼Œå¸¸è§çš„åšæ³•æ˜¯ä½¿ç”¨å›½å†…é•œåƒæˆ–æ­å»ºä»£ç†æœåŠ¡å™¨ï¼Œå¸¸è§çš„æ–¹æ¡ˆåŒ…æ‹¬ä½¿ç”¨ é˜¿é‡Œäº‘ Composer é•œåƒ æˆ– ç§æœ‰é•œåƒä»“åº“ã€‚</p>\n<p> <b>2.1 ä½¿ç”¨å›½å†…é•œåƒæº</b></p>\n<p>ä½ å¯ä»¥é€šè¿‡é…ç½® Composer ä½¿ç”¨å›½å†…é•œåƒæºæ¥åŠ é€Ÿä¾èµ–åŒ…çš„ä¸‹è½½ã€‚åœ¨ Composer ä¸­ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è®¾ç½®å›½å†…é•œåƒï¼š<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer config repo.packagist composer https://mirrors.aliyun.com/composer/</span><br></pre></td></tr></table></figure><br>è¿™ä¸ªå‘½ä»¤å°† packagist.org æºæ›´æ¢ä¸ºé˜¿é‡Œäº‘çš„é•œåƒæºã€‚</p>\n<p>ä½ è¿˜å¯ä»¥é€šè¿‡åœ¨ composer.json æ–‡ä»¶ä¸­è¿›è¡Œè®¾ç½®ï¼Œå¼ºåˆ¶ä½¿ç”¨é•œåƒæºï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;repositories&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;type&quot;: &quot;composer&quot;,</span><br><span class=\"line\">            &quot;url&quot;: &quot;https://mirrors.aliyun.com/composer/&quot;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ ·æ¯æ¬¡æ‰§è¡Œ composer install æ—¶ï¼Œéƒ½ä¼šä»é˜¿é‡Œäº‘çš„é•œåƒæºä¸‹è½½ä¾èµ–ã€‚</p>\n<p><b>2.2 é…ç½®è‡ªå»º Composer é•œåƒä»£ç†</b></p>\n<p>å¦‚æœä½ æƒ³åœ¨ä¼ä¸šå†…éƒ¨å®Œå…¨æ§åˆ¶åŒ…ç®¡ç†ï¼Œå¯ä»¥æ­å»ºè‡ªå·±çš„ Composer é•œåƒä»£ç†ã€‚å¸¸è§çš„é€‰æ‹©åŒ…æ‹¬ï¼š</p>\n<ul>\n<li>Satisï¼šä¸€ä¸ªå®˜æ–¹æä¾›çš„å·¥å…·ï¼Œç”¨æ¥æ­å»ºç§æœ‰çš„ Composer ä»“åº“ã€‚</li>\n<li>Private Packagistï¼šä¸€ä¸ªå•†ä¸šè§£å†³æ–¹æ¡ˆï¼Œä¸“é—¨ç”¨äºåœ¨ç§æœ‰ç¯å¢ƒä¸­ç®¡ç† Composer åŒ…ã€‚</li>\n<li>Sinopia (npm ä»“åº“ä»£ç†å·¥å…·)ï¼šå¯ä»¥ä½œä¸ºç§æœ‰çš„ Composer ä»“åº“ä»£ç†ä½¿ç”¨ã€‚</li>\n</ul>\n<p><b>2.2.1 ä½¿ç”¨ Satis æ­å»ºç§æœ‰ Composer ä»“åº“</b></p>\n<p>Satis æ˜¯ Composer å®˜æ–¹æä¾›çš„ä¸€ä¸ªè½»é‡çº§å·¥å…·ï¼Œä¸“é—¨ç”¨äºåˆ›å»ºç§æœ‰çš„ Composer ä»“åº“ã€‚é€šè¿‡ä½¿ç”¨ Satisï¼Œä½ å¯ä»¥å°†å†…ç½‘ç¯å¢ƒä¸‹å¸¸ç”¨çš„ä¾èµ–ç¼“å­˜ä¸‹æ¥ï¼Œå¹¶æä¾›ç»™é¡¹ç›®ä¸­ä½¿ç”¨ã€‚</p>\n<p>æ­¥éª¤ï¼š</p>\n<ol>\n<li>å®‰è£… Satisï¼š</li>\n</ol>\n<p>ä½¿ç”¨ Composer å®‰è£… Satisï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">composer require composer/satis</span><br></pre></td></tr></table></figure>\n<ul>\n<li>é…ç½® Satisï¼š</li>\n</ul>\n<p>åœ¨ä½ çš„æœåŠ¡å™¨ä¸Šåˆ›å»ºä¸€ä¸ª satis.json é…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®šä½ å¸Œæœ›æ‰˜ç®¡çš„åŒ…æºã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;name&quot;: &quot;my-private-repo&quot;,</span><br><span class=\"line\">    &quot;homepage&quot;: &quot;https://example.com/packages&quot;,</span><br><span class=\"line\">    &quot;repositories&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;type&quot;: &quot;vcs&quot;,</span><br><span class=\"line\">            &quot;url&quot;: &quot;https://github.com/some/package&quot;</span><br><span class=\"line\">        &#125;,</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;type&quot;: &quot;composer&quot;,</span><br><span class=\"line\">            &quot;url&quot;: &quot;https://packagist.org&quot;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ],</span><br><span class=\"line\">    &quot;output-dir&quot;: &quot;/path/to/output&quot;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<ul>\n<li>ç”Ÿæˆé™æ€èµ„æºï¼š</li>\n</ul>\n<p>è¿è¡Œä»¥ä¸‹å‘½ä»¤ç”Ÿæˆé™æ€çš„ Composer åŒ…ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">php bin/satis build satis.json /path/to/output</span><br></pre></td></tr></table></figure>\n<ul>\n<li>æä¾›è®¿é—®ï¼š</li>\n</ul>\n<p>ä½ å¯ä»¥é€šè¿‡ Web æœåŠ¡å™¨ï¼ˆå¦‚ Nginx æˆ– Apacheï¼‰æä¾›è®¿é—®é™æ€èµ„æºã€‚è¿™æ ·ï¼Œå…¶ä»–é¡¹ç›®å°±èƒ½é€šè¿‡ä½ çš„å†…éƒ¨ Satis ä»“åº“è·å–ä¾èµ–äº†ã€‚</p>\n<p><b>2.2.2 é…ç½® Composer ä½¿ç”¨ç§æœ‰ä»“åº“</b></p>\n<p>åœ¨ composer.json ä¸­é…ç½®ç§æœ‰ä»“åº“ï¼ˆä¾‹å¦‚ï¼Œä½ çš„å…¬å¸å†…éƒ¨æ­å»ºçš„ Satis ä»“åº“ï¼‰ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&#123;</span><br><span class=\"line\">    &quot;repositories&quot;: [</span><br><span class=\"line\">        &#123;</span><br><span class=\"line\">            &quot;type&quot;: &quot;composer&quot;,</span><br><span class=\"line\">            &quot;url&quot;: &quot;http://your-internal-repository.com&quot;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    ]</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<p>è¿™æ ·ï¼ŒComposer ä¼šä»ä½ é…ç½®çš„ç§æœ‰ä»“åº“ä¸­æ‹‰å–ä¾èµ–ã€‚</p>\n<h3 id=\"3-ç¦»çº¿å®‰è£…-Composer-ä¾èµ–\"><a href=\"#3-ç¦»çº¿å®‰è£…-Composer-ä¾èµ–\" class=\"headerlink\" title=\"3. ç¦»çº¿å®‰è£… Composer ä¾èµ–\"></a><b>3. ç¦»çº¿å®‰è£… Composer ä¾èµ–</b></h3><p>å¦‚æœå†…ç½‘æ— æ³•è®¿é—®å¤–éƒ¨ç½‘ç»œï¼Œä¹Ÿå¯ä»¥è€ƒè™‘åœ¨æœ‰å¤–ç½‘è®¿é—®æƒé™çš„æœºå™¨ä¸Šä¸‹è½½ä¾èµ–åŒ…ï¼Œç„¶åå°†å®ƒä»¬å¯¼å…¥åˆ°å†…ç½‘æœºå™¨ä¸­è¿›è¡Œå®‰è£…ã€‚</p>\n<p><b>3.1  åœ¨æœ‰å¤–ç½‘çš„æœºå™¨ä¸Šä¸‹è½½ä¾èµ–</b></p>\n<p>åœ¨èƒ½å¤Ÿè®¿é—®å¤–ç½‘çš„æœºå™¨ä¸Šæ‰§è¡Œ composer installã€‚<br>ä¸‹è½½å®Œæˆåï¼Œå°† vendor ç›®å½•åŠ composer.lock æ–‡ä»¶æ‹·è´åˆ°å†…ç½‘æœåŠ¡å™¨ç›¸åŒä½ç½®ã€‚</p>\n<p><b>3.2 ä½¿ç”¨ â€”prefer-dist å‚æ•°</b></p>\n<p>ä½ è¿˜å¯ä»¥ä½¿ç”¨ composer install â€”prefer-dist æ¥ä¸‹è½½ .tar.gz æˆ– .zip æ ¼å¼çš„åŒ…ï¼Œè¿™æ ·å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œç¦»çº¿å®‰è£…ã€‚</p>\n<p><b>3.3 é…ç½® COMPOSER_HOME</b></p>\n<p>å¦‚æœä½ å¸Œæœ›åœ¨å†…ç½‘æœºå™¨ä¸Šä½¿ç”¨æœ¬åœ°ç¼“å­˜çš„åŒ…ï¼Œå¯ä»¥è®¾ç½® COMPOSER_HOME ç¯å¢ƒå˜é‡æ¥æŒ‡å®š Composer ç¼“å­˜ç›®å½•ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export COMPOSER_HOME=/path/to/composer/cache</span><br></pre></td></tr></table></figure>\n<p>ç„¶åï¼Œå°†ç¼“å­˜ç›®å½•å¤åˆ¶åˆ°å†…ç½‘æœºå™¨ï¼Œç¡®ä¿ Composer èƒ½å¤Ÿä½¿ç”¨è¿™äº›ç¼“å­˜ã€‚</p>\n<h3 id=\"4-å…¶ä»–è€ƒè™‘\"><a href=\"#4-å…¶ä»–è€ƒè™‘\" class=\"headerlink\" title=\"4. å…¶ä»–è€ƒè™‘\"></a><b>4. å…¶ä»–è€ƒè™‘</b></h3><ul>\n<li>ä»£ç†é…ç½®ï¼šå¦‚æœå†…ç½‘å¯ä»¥é€šè¿‡ HTTP ä»£ç†è®¿é—®å¤–ç½‘ï¼Œç¡®ä¿ Composer é…ç½®äº†ä»£ç†ã€‚åœ¨ composer.json ä¸­é…ç½®ä»£ç†ï¼Œæˆ–è€…ä½¿ç”¨ç¯å¢ƒå˜é‡æ¥æŒ‡å®šä»£ç†ï¼š</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">export HTTP_PROXY=http://proxy.example.com:8080</span><br><span class=\"line\">export HTTPS_PROXY=http://proxy.example.com:8080</span><br></pre></td></tr></table></figure>\n<ul>\n<li>ç§æœ‰åŒ…çš„æƒé™ï¼šå¦‚æœä½ ä½¿ç”¨äº†ç§æœ‰ Composer ä»“åº“æˆ– GitHub ä»“åº“ï¼Œè®°å¾—é…ç½®å¥½è®¤è¯æ–¹å¼ï¼ˆå¦‚ä½¿ç”¨ auth.json æ–‡ä»¶å­˜å‚¨ GitHub Tokenï¼‰ã€‚</li>\n</ul>\n",
            "tags": [
                "composer",
                "composeréƒ¨ç½²",
                "å†…ç½‘éƒ¨ç½²composer"
            ]
        },
        {
            "id": "https://erik.xyz/2025/01/10/agricultural-detection-system/",
            "url": "https://erik.xyz/2025/01/10/agricultural-detection-system/",
            "title": "å†œä¸šæ£€æµ‹ç³»ç»Ÿè®¾è®¡",
            "date_published": "2025-01-10T14:34:00.000Z",
            "content_html": "<p><b>å†œä¸šæ£€æµ‹ç³»ç»Ÿè®¾è®¡</b></p>\n<p>æ ¹æ®ä½ çš„éœ€æ±‚ï¼Œæˆ‘ä»¬å°†è®¾è®¡ä¸€ä¸ªæ™ºèƒ½å†œä¸šç³»ç»Ÿï¼Œé€šè¿‡å¤šç§æŠ€æœ¯æ‰‹æ®µå®ç°æ¸©æ¹¿åº¦ã€å…‰ç…§åº¦ç›‘æµ‹ã€è®¾å¤‡æ§åˆ¶å’Œè¿œç¨‹ç®¡ç†ã€‚ç³»ç»Ÿçš„æ ¸å¿ƒåŠŸèƒ½åŒ…æ‹¬ï¼šæ™ºèƒ½èŠ‚ç‚¹ç›‘æ§ç¯å¢ƒæ•°æ®ã€æ‰‹åŠ¨å’Œè‡ªåŠ¨æ§åˆ¶æ¨¡å¼ã€é€šè¿‡ LoRa å’Œ 4G é€šä¿¡ä¼ è¾“æ•°æ®ã€ä»¥åŠé€šè¿‡æ‰‹æœºæˆ–ç”µè„‘ç«¯è¿›è¡Œè¿œç¨‹æ§åˆ¶ã€‚<br><span id=\"more\"></span></p>\n<h4 id=\"1-ç³»ç»Ÿæ¨¡å—æ¦‚è¿°\"><a href=\"#1-ç³»ç»Ÿæ¨¡å—æ¦‚è¿°\" class=\"headerlink\" title=\"1. ç³»ç»Ÿæ¨¡å—æ¦‚è¿°\"></a><b>1. ç³»ç»Ÿæ¨¡å—æ¦‚è¿°</b></h4><p>è¯¥å†œä¸šæ£€æµ‹ç³»ç»ŸåŒ…æ‹¬ä»¥ä¸‹å‡ ä¸ªä¸»è¦æ¨¡å—ï¼š</p>\n<ol>\n<li><p>æ™ºèƒ½èŠ‚ç‚¹ï¼ˆä¼ æ„Ÿå™¨ä¸æ§åˆ¶å•å…ƒï¼‰ï¼š</p>\n<ul>\n<li>è·å–æ¸©æ¹¿åº¦ã€å…‰ç…§åº¦ä¼ æ„Ÿå™¨æ•°æ®ã€‚</li>\n<li>æ§åˆ¶é£æ‰‡çš„å¯åœï¼Œæ˜¾ç¤ºå½“å‰é£æ‰‡çŠ¶æ€ã€‚</li>\n<li>æ”¯æŒæ‰‹åŠ¨å’Œè‡ªåŠ¨æ¨¡å¼åˆ‡æ¢ã€‚</li>\n<li>æ˜¾ç¤ºæ¸©æ¹¿åº¦ã€å…‰ç…§åº¦ã€é£æ‰‡çŠ¶æ€å’Œæ¨¡å¼çŠ¶æ€ã€‚</li>\n<li>é€šè¿‡ LoRa å‘é€æ•°æ®åˆ° 4G èŠ‚ç‚¹ã€‚</li>\n</ul>\n</li>\n<li><p>4G ç½‘å…³èŠ‚ç‚¹ï¼š</p>\n<ul>\n<li>æ¥æ”¶æ¥è‡ªæ™ºèƒ½èŠ‚ç‚¹çš„ä¼ æ„Ÿå™¨æ•°æ®ã€‚</li>\n<li>å°†æ•°æ®é€šè¿‡ 4G ç½‘ç»œä¸Šä¼ è‡³ MOTT æœåŠ¡å™¨ã€‚</li>\n<li>åœ¨æ˜¾ç¤ºå±ä¸Šæ˜¾ç¤ºå„é¡¹ä¼ æ„Ÿå™¨æ•°æ®ã€‚</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li><p>MOTT æœåŠ¡å™¨ï¼š</p>\n<ul>\n<li>å­˜å‚¨ä» 4G èŠ‚ç‚¹å‘é€æ¥çš„æ•°æ®ã€‚</li>\n<li>æä¾›è¿œç¨‹è®¿é—®æ¥å£ã€‚</li>\n</ul>\n</li>\n<li><p>åº”ç”¨è½¯ä»¶ï¼ˆç”µè„‘ç«¯æˆ–æ‰‹æœºç«¯ï¼‰ï¼š</p>\n<ul>\n<li>æ˜¾ç¤ºæ¸©æ¹¿åº¦ã€å…‰ç…§åº¦ã€é£æ‰‡çŠ¶æ€ã€æ‰‹åŠ¨/è‡ªåŠ¨æ¨¡å¼ç­‰æ•°æ®ã€‚</li>\n<li>æä¾›ç™»å½•ã€æ‰‹åŠ¨æ§åˆ¶ã€è‡ªåŠ¨æ§åˆ¶ç­‰åŠŸèƒ½ã€‚</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"2-ç³»ç»ŸåŠŸèƒ½è®¾è®¡\"><a href=\"#2-ç³»ç»ŸåŠŸèƒ½è®¾è®¡\" class=\"headerlink\" title=\"2.ç³»ç»ŸåŠŸèƒ½è®¾è®¡\"></a><b>2.ç³»ç»ŸåŠŸèƒ½è®¾è®¡</b></h4><p>2.1 æ™ºèƒ½èŠ‚ç‚¹åŠŸèƒ½</p>\n<ol>\n<li><p>ä¼ æ„Ÿå™¨æ•°æ®é‡‡é›†ï¼š</p>\n<ul>\n<li>æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼šå®æ—¶è·å–æ¸©åº¦å’Œæ¹¿åº¦æ•°æ®ã€‚</li>\n<li>å…‰ç…§åº¦ä¼ æ„Ÿå™¨ï¼šå®æ—¶è·å–å…‰ç…§å¼ºåº¦æ•°æ®ã€‚</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li><p>æ¨¡å¼åˆ‡æ¢ï¼š</p>\n<ul>\n<li>æ‰‹åŠ¨æ¨¡å¼ï¼šå…è®¸ç”¨æˆ·é€šè¿‡æŒ‰é”®æ‰‹åŠ¨å¯åŠ¨æˆ–åœæ­¢é£æ‰‡ã€‚</li>\n<li>è‡ªåŠ¨æ¨¡å¼ï¼šå½“æ¸©åº¦å’Œå…‰ç…§åº¦è¶…è¿‡è®¾å®šé˜ˆå€¼æ—¶ï¼Œè‡ªåŠ¨å¯åœé£æ‰‡ã€‚</li>\n</ul>\n</li>\n<li><p>é£æ‰‡æ§åˆ¶ï¼š</p>\n<ul>\n<li>åœ¨æ‰‹åŠ¨æ¨¡å¼ä¸‹ï¼Œç”¨æˆ·é€šè¿‡æŒ‰é”®æ§åˆ¶é£æ‰‡å¼€å…³ï¼Œå¹¶é€šè¿‡ç»¿è‰² LED æŒ‡ç¤ºç¯æ˜¾ç¤ºé£æ‰‡çŠ¶æ€ã€‚</li>\n<li>åœ¨è‡ªåŠ¨æ¨¡å¼ä¸‹ï¼Œç³»ç»Ÿä¼šæ ¹æ®è®¾å®šçš„æ¸©åº¦å’Œå…‰ç…§åº¦é˜ˆå€¼è‡ªåŠ¨æ§åˆ¶é£æ‰‡ï¼Œå¹¶ä½¿ç”¨ç»¿ç¯å’Œçº¢ç¯è¿›è¡ŒçŠ¶æ€æŒ‡ç¤ºã€‚</li>\n</ul>\n</li>\n<li><p>æ•°æ®ä¼ è¾“ï¼š</p>\n<ul>\n<li>ä½¿ç”¨ LoRa æ— çº¿ä¼ è¾“æ¨¡å—å°†ä¼ æ„Ÿå™¨æ•°æ®å’Œé£æ‰‡çŠ¶æ€ä¸Šä¼ è‡³ 4G ç½‘å…³èŠ‚ç‚¹ã€‚</li>\n</ul>\n</li>\n<li><p>æ˜¾ç¤ºå±ï¼š</p>\n<ul>\n<li>æ˜¾ç¤ºå½“å‰æ¸©æ¹¿åº¦ã€å…‰ç…§åº¦ã€æ¨¡å¼çŠ¶æ€å’Œé£æ‰‡çŠ¶æ€ã€‚</li>\n</ul>\n</li>\n</ul>\n<p><b>2.2 4G ç½‘å…³èŠ‚ç‚¹åŠŸèƒ½</b></p>\n<ol>\n<li><p>æ•°æ®æ¥æ”¶ï¼š</p>\n<ul>\n<li>é€šè¿‡ LoRa æ¥æ”¶æ™ºèƒ½èŠ‚ç‚¹ä¸Šä¼ çš„ä¼ æ„Ÿå™¨æ•°æ®ï¼ˆæ¸©åº¦ã€æ¹¿åº¦ã€å…‰ç…§åº¦ã€é£æ‰‡çŠ¶æ€ã€æ‰‹åŠ¨/è‡ªåŠ¨æ¨¡å¼çŠ¶æ€ï¼‰ã€‚</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li><p>4G ç½‘ç»œä¼ è¾“ï¼š</p>\n<ul>\n<li>å°†æ™ºèƒ½èŠ‚ç‚¹çš„æ•°æ®é€šè¿‡ 4G ç½‘ç»œä¸Šä¼ è‡³ MOTT æœåŠ¡å™¨ã€‚</li>\n</ul>\n</li>\n<li><p>æ˜¾ç¤ºå±æ˜¾ç¤ºï¼š</p>\n<ul>\n<li>åœ¨ 4G ç½‘å…³èŠ‚ç‚¹çš„æ˜¾ç¤ºå±ä¸Šå±•ç¤ºæ¸©æ¹¿åº¦ã€å…‰ç…§åº¦ã€æ¨¡å¼çŠ¶æ€å’Œé£æ‰‡çŠ¶æ€ã€‚</li>\n</ul>\n</li>\n</ul>\n<p><b>2.3 MOTT æœåŠ¡å™¨åŠŸèƒ½</b></p>\n<ol>\n<li><p>æ•°æ®å­˜å‚¨ï¼š</p>\n<ul>\n<li>å­˜å‚¨æ¥è‡ª 4G ç½‘å…³èŠ‚ç‚¹çš„æ¸©æ¹¿åº¦ã€å…‰ç…§åº¦ã€é£æ‰‡çŠ¶æ€ç­‰æ•°æ®ã€‚</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li><p>è¿œç¨‹ç®¡ç†æ¥å£ï¼š</p>\n<ul>\n<li>æä¾› RESTful API æˆ– WebSocket æ¥å£ï¼Œä¾›å®¢æˆ·ç«¯åº”ç”¨è®¿é—®ã€‚</li>\n</ul>\n</li>\n</ul>\n<p><b>2.4 åº”ç”¨è½¯ä»¶åŠŸèƒ½</b></p>\n<ol>\n<li>ç”¨æˆ·ç™»å½•ï¼š<ul>\n<li>æä¾›ç™»å½•ç•Œé¢ï¼Œç”¨æˆ·é€šè¿‡è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ç™»å½•ï¼ˆç”¨æˆ·åï¼šadminï¼Œå¯†ç ï¼šadmin123ï¼‰ã€‚</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li><p>æ‰‹åŠ¨æ§åˆ¶ï¼š</p>\n<ul>\n<li>ç™»å½•æˆåŠŸåï¼Œç”¨æˆ·å¯é€šè¿‡ç•Œé¢æ‰‹åŠ¨å¯åœé£æ‰‡ï¼Œæ“ä½œæ—¶è§¦å‘çº¢ç¯å’Œèœ‚é¸£å™¨çš„æç¤ºã€‚</li>\n</ul>\n</li>\n<li><p>è‡ªåŠ¨æ§åˆ¶ï¼š</p>\n<ul>\n<li>ç”¨æˆ·å¯ä»¥è®¾å®šæ¸©åº¦å’Œå…‰ç…§åº¦çš„é˜ˆå€¼ï¼Œæ™ºèƒ½èŠ‚ç‚¹è¿›å…¥è‡ªåŠ¨æ¨¡å¼åï¼Œç³»ç»Ÿæ ¹æ®ä¼ æ„Ÿå™¨æ•°æ®è‡ªåŠ¨æ§åˆ¶é£æ‰‡å¼€å…³ï¼Œå¹¶é€šè¿‡ LED æŒ‡ç¤ºç¯æ˜¾ç¤ºçŠ¶æ€ã€‚</li>\n</ul>\n</li>\n<li><p>æ˜¾ç¤ºåŠŸèƒ½ï¼š</p>\n<ul>\n<li>å®æ—¶æ˜¾ç¤ºæ¸©åº¦ã€æ¹¿åº¦ã€å…‰ç…§åº¦ã€é£æ‰‡çŠ¶æ€ã€æ‰‹åŠ¨/è‡ªåŠ¨æ¨¡å¼çŠ¶æ€ã€‚</li>\n</ul>\n</li>\n</ul>\n<h4 id=\"3-åŸå‹å›¾è®¾è®¡\"><a href=\"#3-åŸå‹å›¾è®¾è®¡\" class=\"headerlink\" title=\"3. åŸå‹å›¾è®¾è®¡\"></a><b>3. åŸå‹å›¾è®¾è®¡</b></h4><p>3.1 æ™ºèƒ½èŠ‚ç‚¹åŸå‹å›¾<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+-------------------------+</span><br><span class=\"line\">|    æ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨          |</span><br><span class=\"line\">|                         |</span><br><span class=\"line\">|    å…‰ç…§åº¦ä¼ æ„Ÿå™¨          |</span><br><span class=\"line\">|                         |</span><br><span class=\"line\">|    æŒ‰é”®é¢æ¿ (5ä¸ªæŒ‰é”®)    |</span><br><span class=\"line\">|                         |</span><br><span class=\"line\">|    æ˜¾ç¤ºå± (LCD)          |</span><br><span class=\"line\">|                         |</span><br><span class=\"line\">|    é£æ‰‡æ§åˆ¶ (LED/èœ‚é¸£å™¨) |</span><br><span class=\"line\">+-------------------------+</span><br></pre></td></tr></table></figure></p>\n<ul>\n<li>æ˜¾ç¤ºå±ï¼šæ˜¾ç¤ºæ¸©åº¦ã€æ¹¿åº¦ã€å…‰ç…§åº¦ã€å½“å‰æ¨¡å¼ï¼ˆæ‰‹åŠ¨/è‡ªåŠ¨ï¼‰å’Œé£æ‰‡çŠ¶æ€ã€‚</li>\n<li>æŒ‰é”®é¢æ¿ï¼š5ä¸ªæŒ‰é”®ï¼Œå…¶ä¸­åŒ…æ‹¬ï¼š<ul>\n<li>åˆ‡æ¢æ¨¡å¼æŒ‰é”®ï¼ˆæ‰‹åŠ¨/è‡ªåŠ¨ï¼‰</li>\n<li>å¯åŠ¨é£æ‰‡çš„æ§åˆ¶æŒ‰é”®</li>\n<li>åœæ­¢é£æ‰‡çš„æ§åˆ¶æŒ‰é”®</li>\n</ul>\n</li>\n<li>LED ç¯ï¼šæŒ‡ç¤ºé£æ‰‡æ˜¯å¦æ­£åœ¨è¿è¡Œï¼ˆç»¿è‰²ä¸ºè¿è¡Œï¼Œçº¢è‰²ä¸ºåœæ­¢ï¼‰ã€‚</li>\n<li>èœ‚é¸£å™¨ï¼šåœ¨é£æ‰‡è¿è¡Œæ—¶ä»¥ 1Hz çš„é¢‘ç‡å‘å‡ºå£°éŸ³ã€‚</li>\n</ul>\n<p><b>3.2 4G ç½‘å…³èŠ‚ç‚¹åŸå‹å›¾</b></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+-------------------------+</span><br><span class=\"line\">|    LoRa æ¥æ”¶æ¨¡å—        |</span><br><span class=\"line\">|    (æ¥æ”¶æ•°æ®)           |</span><br><span class=\"line\">|                         |</span><br><span class=\"line\">|    æ˜¾ç¤ºå± (LCD)          |</span><br><span class=\"line\">|                         |</span><br><span class=\"line\">|    4G ç½‘ç»œæ¨¡å—          |</span><br><span class=\"line\">|    (ä¸Šä¼ æ•°æ®)           |</span><br><span class=\"line\">+-------------------------+</span><br></pre></td></tr></table></figure>\n<ul>\n<li>æ˜¾ç¤ºå±ï¼šæ˜¾ç¤ºæ¸©æ¹¿åº¦ã€å…‰ç…§åº¦ã€æ¨¡å¼çŠ¶æ€å’Œé£æ‰‡çŠ¶æ€ã€‚</li>\n<li>LoRa æ¥æ”¶æ¨¡å—ï¼šæ¥æ”¶æ™ºèƒ½èŠ‚ç‚¹å‘é€çš„ä¼ æ„Ÿå™¨æ•°æ®ã€‚</li>\n<li>4G ç½‘ç»œæ¨¡å—ï¼šå°†æ¥æ”¶åˆ°çš„æ•°æ®ä¸Šä¼ åˆ° MOTT æœåŠ¡å™¨ã€‚</li>\n</ul>\n<p><b>3.3 åº”ç”¨è½¯ä»¶åŸå‹å›¾ï¼ˆç”µè„‘ç«¯æˆ–æ‰‹æœºç«¯ï¼‰</b></p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">+-------------------------------------------------------+</span><br><span class=\"line\">| ç™»å½•ç•Œé¢                                               |</span><br><span class=\"line\">|   - ç”¨æˆ·åè¾“å…¥æ¡†                                        |</span><br><span class=\"line\">|   - å¯†ç è¾“å…¥æ¡†                                          |</span><br><span class=\"line\">|   - ç™»å½•æŒ‰é’®                                            |</span><br><span class=\"line\">+-------------------------------------------------------+</span><br><span class=\"line\">| ä¸»ç•Œé¢                                                 |</span><br><span class=\"line\">|   - å®æ—¶æ˜¾ç¤ºæ¸©æ¹¿åº¦ã€å…‰ç…§åº¦ã€é£æ‰‡çŠ¶æ€ã€æ‰‹åŠ¨/è‡ªåŠ¨æ¨¡å¼   |</span><br><span class=\"line\">|   - æ‰‹åŠ¨æ§åˆ¶æŒ‰é’® (å¯åŠ¨/åœæ­¢é£æ‰‡)                       |</span><br><span class=\"line\">|   - è‡ªåŠ¨æ¨¡å¼é˜ˆå€¼è®¾ç½® (æ¸©åº¦ã€å…‰ç…§åº¦)                    |</span><br><span class=\"line\">|   - çŠ¶æ€æ˜¾ç¤ºï¼šå½“å‰æ¨¡å¼ï¼ˆæ‰‹åŠ¨/è‡ªåŠ¨ï¼‰ã€é£æ‰‡çŠ¶æ€ï¼ˆå¼€/å…³ï¼‰|</span><br><span class=\"line\">+-------------------------------------------------------+</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-ç³»ç»Ÿè®¾è®¡æ­¥éª¤\"><a href=\"#4-ç³»ç»Ÿè®¾è®¡æ­¥éª¤\" class=\"headerlink\" title=\"4. ç³»ç»Ÿè®¾è®¡æ­¥éª¤\"></a><b>4. ç³»ç»Ÿè®¾è®¡æ­¥éª¤</b></h4><p><b>4.1 ç¡¬ä»¶è®¾è®¡ä¸å¼€å‘</b></p>\n<ul>\n<li>é€‰æ‹©é€‚å½“çš„ä¼ æ„Ÿå™¨ï¼šæ¸©æ¹¿åº¦ä¼ æ„Ÿå™¨ï¼ˆå¦‚ DHT22ï¼‰ã€å…‰ç…§åº¦ä¼ æ„Ÿå™¨ã€é£æ‰‡æ§åˆ¶æ¨¡å—ã€LED æŒ‡ç¤ºç¯ã€èœ‚é¸£å™¨ã€‚</li>\n<li>æ™ºèƒ½èŠ‚ç‚¹ç”µè·¯è®¾è®¡ï¼šè®¾è®¡ç”µæºç®¡ç†ç”µè·¯ï¼Œç¡®ä¿æ‰€æœ‰ä¼ æ„Ÿå™¨å’Œæ§åˆ¶ç»„ä»¶èƒ½æ­£å¸¸å·¥ä½œã€‚</li>\n<li>LoRa æ¨¡å—é›†æˆï¼šå°† LoRa æ¨¡å—é›†æˆåˆ°æ™ºèƒ½èŠ‚ç‚¹ä¸­ï¼Œå®ç°æ•°æ®çš„æ— çº¿ä¼ è¾“ã€‚</li>\n</ul>\n<p><b>4.2 è½¯ä»¶å¼€å‘</b></p>\n<ol>\n<li><p>æ™ºèƒ½èŠ‚ç‚¹ç¨‹åºï¼š</p>\n<ul>\n<li>ç¼–å†™ä»£ç è·å–ä¼ æ„Ÿå™¨æ•°æ®ã€‚</li>\n<li>æ§åˆ¶é£æ‰‡åŠ LED æŒ‡ç¤ºç¯ã€‚</li>\n<li>å®ç°æ‰‹åŠ¨ä¸è‡ªåŠ¨æ¨¡å¼çš„åˆ‡æ¢ã€‚</li>\n<li>å®ç° LoRa æ•°æ®å‘é€åŠŸèƒ½ã€‚</li>\n</ul>\n</li>\n</ol>\n<ul>\n<li>4G ç½‘å…³èŠ‚ç‚¹ç¨‹åºï¼š<ul>\n<li>æ¥æ”¶ LoRa æ•°æ®å¹¶é€šè¿‡ 4G ç½‘ç»œä¸Šä¼ è‡³ MOTT æœåŠ¡å™¨ã€‚</li>\n</ul>\n</li>\n<li>MOTT æœåŠ¡å™¨å¼€å‘ï¼š<ul>\n<li>æä¾›æ•°æ®å­˜å‚¨å’Œè¿œç¨‹ç®¡ç†æ¥å£ï¼ˆAPIï¼‰ã€‚</li>\n</ul>\n</li>\n<li>åº”ç”¨è½¯ä»¶å¼€å‘ï¼š<ul>\n<li>å®ç°ç”¨æˆ·ç™»å½•ã€æ‰‹åŠ¨æ§åˆ¶ã€è‡ªåŠ¨æ§åˆ¶ã€æ•°æ®å±•ç¤ºç­‰åŠŸèƒ½ã€‚</li>\n</ul>\n</li>\n</ul>\n<p><b>4.3 ç³»ç»Ÿé›†æˆä¸æµ‹è¯•</b></p>\n<ul>\n<li>ç¡¬ä»¶é›†æˆï¼šå°†ä¼ æ„Ÿå™¨ã€LoRa æ¨¡å—ã€æ˜¾ç¤ºå±ç­‰ç¡¬ä»¶è¿æ¥è‡³æ™ºèƒ½èŠ‚ç‚¹å’Œ 4G ç½‘å…³èŠ‚ç‚¹ã€‚</li>\n<li>åŠŸèƒ½æµ‹è¯•ï¼šæµ‹è¯•æ‰‹åŠ¨æ¨¡å¼ã€è‡ªåŠ¨æ¨¡å¼ã€æ•°æ®ä¼ è¾“åŠŸèƒ½ç­‰ã€‚</li>\n<li>æ€§èƒ½ä¼˜åŒ–ï¼šç¡®ä¿ç³»ç»Ÿåœ¨å®æ—¶æ•°æ®ä¼ è¾“å’Œæ§åˆ¶ä¸­çš„ç¨³å®šæ€§ã€‚</li>\n</ul>\n<p><b>4.4 éƒ¨ç½²ä¸ç»´æŠ¤</b></p>\n<ul>\n<li>éƒ¨ç½²æ™ºèƒ½èŠ‚ç‚¹å’Œ 4G ç½‘å…³ï¼šå°†ç³»ç»Ÿéƒ¨ç½²åˆ°å®é™…å†œä¸šç¯å¢ƒä¸­ï¼Œè¿›è¡Œç°åœºæµ‹è¯•å’Œè°ƒè¯•ã€‚</li>\n<li>ç»´æŠ¤ä¸æ›´æ–°ï¼šå®šæœŸæ£€æŸ¥ç³»ç»Ÿï¼Œè¿›è¡Œå¿…è¦çš„åŠŸèƒ½æ›´æ–°å’Œä¼˜åŒ–ã€‚</li>\n</ul>\n",
            "tags": [
                "å†œä¸šç³»ç»Ÿ",
                "ç³»ç»Ÿè®¾è®¡"
            ]
        },
        {
            "id": "https://erik.xyz/2025/01/03/php-serial-port-development/",
            "url": "https://erik.xyz/2025/01/03/php-serial-port-development/",
            "title": "phpä¸²å£å¼€å‘",
            "date_published": "2025-01-03T07:30:00.000Z",
            "content_html": "<p>ä½¿ç”¨å¤–ç½®è®¾å¤‡ï¼Œé€šè¿‡ä¸²å£å‘é€å’Œæ¥æ”¶æ•°æ®ã€‚é‚£ä¹ˆï¼Œå°±è¦åœ¨phpç«¯æœ‰ä¸ªä¸²å£çš„æ“ä½œä»£ç ã€‚<br>PHP çš„ dio æ‰©å±•ï¼ˆDirect I/Oï¼‰æä¾›äº†å¯¹åº•å±‚ I/O æ“ä½œçš„è®¿é—®ï¼ŒåŒ…æ‹¬ä¸²å£é€šä¿¡ã€‚é€šè¿‡ dio æ‰©å±•ï¼Œä½ å¯ä»¥ç›´æ¥æ“ä½œä¸²å£è®¾å¤‡æ–‡ä»¶ï¼ˆå¦‚ /dev/ttyUSB0 æˆ– COM1ï¼‰æ¥å®ç°ä¸²å£é€šä¿¡ã€‚<br> <span id=\"more\"></span></p>\n<h3 id=\"1-å®‰è£…-dio-æ‰©å±•\"><a href=\"#1-å®‰è£…-dio-æ‰©å±•\" class=\"headerlink\" title=\"1. å®‰è£… dio æ‰©å±•\"></a>1. å®‰è£… dio æ‰©å±•</h3><p>dio æ‰©å±•æ˜¯ PHP çš„ä¸€ä¸ª PECL æ‰©å±•ã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ­¥éª¤å®‰è£…ï¼š</p>\n<p>åœ¨ Linux ä¸Šå®‰è£…ï¼š<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt-get install php-dev  # å®‰è£… PHP å¼€å‘å·¥å…·</span><br><span class=\"line\">sudo pecl install dio         # å®‰è£… dio æ‰©å±•</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p>å®‰è£…å®Œæˆåï¼Œåœ¨ php.ini æ–‡ä»¶ä¸­å¯ç”¨æ‰©å±•ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">extension=dio.so</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h3 id=\"2-ä½¿ç”¨-dio-å®ç°ä¸²å£é€šä¿¡\"><a href=\"#2-ä½¿ç”¨-dio-å®ç°ä¸²å£é€šä¿¡\" class=\"headerlink\" title=\"2. ä½¿ç”¨ dio å®ç°ä¸²å£é€šä¿¡\"></a>2. ä½¿ç”¨ dio å®ç°ä¸²å£é€šä¿¡</h3><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨ dio æ‰©å±•å®ç°ä¸²å£é€šä¿¡çš„ç¤ºä¾‹ä»£ç ï¼š<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;?php</span><br><span class=\"line\">// ä¸²å£è®¾å¤‡è·¯å¾„</span><br><span class=\"line\">$device = &#x27;/dev/pts/4&#x27;; // Linux</span><br><span class=\"line\">// $device = &#x27;COM1&#x27;;      // Windows</span><br><span class=\"line\"></span><br><span class=\"line\">// æ‰“å¼€ä¸²å£è®¾å¤‡</span><br><span class=\"line\">$fd = dio_open($device, O_RDWR | O_NOCTTY | O_NONBLOCK);</span><br><span class=\"line\"></span><br><span class=\"line\">if (!$fd) &#123;</span><br><span class=\"line\">    die(&quot;æ— æ³•æ‰“å¼€ä¸²å£è®¾å¤‡: $device\\n&quot;);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">// é…ç½®ä¸²å£å‚æ•°</span><br><span class=\"line\">dio_tcsetattr($fd, [</span><br><span class=\"line\">    &#x27;baud&#x27; =&gt; 9600,          // æ³¢ç‰¹ç‡</span><br><span class=\"line\">    &#x27;bits&#x27; =&gt; 8,             // æ•°æ®ä½</span><br><span class=\"line\">    &#x27;stop&#x27; =&gt; 1,             // åœæ­¢ä½</span><br><span class=\"line\">    &#x27;parity&#x27; =&gt; 0,           // æ ¡éªŒä½ (0: none, 1: odd, 2: even)</span><br><span class=\"line\">    &#x27;flow_control&#x27; =&gt; 0,     // æµæ§åˆ¶ (0: none, 1: hardware)</span><br><span class=\"line\">]);</span><br><span class=\"line\"></span><br><span class=\"line\">// å‘é€æ•°æ®åˆ°ä¸²å£</span><br><span class=\"line\">$message = &quot;ä½ å¥½æˆ‘åœ¨https://erik.xyzä¸Šå‡ºç”Ÿäº†ï¼&quot;;</span><br><span class=\"line\">dio_write($fd, $message);</span><br><span class=\"line\">echo &quot;å·²å‘é€: $message&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">// ä»ä¸²å£è¯»å–æ•°æ®</span><br><span class=\"line\">$data = dio_read($fd, 1024); // è¯»å–æœ€å¤š 1024 å­—èŠ‚</span><br><span class=\"line\">echo &quot;å·²æ¥æ”¶: $data\\n&quot;;</span><br><span class=\"line\"></span><br><span class=\"line\">// å…³é—­ä¸²å£</span><br><span class=\"line\">dio_close($fd);</span><br><span class=\"line\">?&gt;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<h3 id=\"3-ä»£ç è¯´æ˜\"><a href=\"#3-ä»£ç è¯´æ˜\" class=\"headerlink\" title=\"3. ä»£ç è¯´æ˜\"></a>3. ä»£ç è¯´æ˜</h3><ul>\n<li><p>dio_open: æ‰“å¼€ä¸²å£è®¾å¤‡æ–‡ä»¶ã€‚O_RDWR è¡¨ç¤ºä»¥è¯»å†™æ¨¡å¼æ‰“å¼€ï¼ŒO_NOCTTY è¡¨ç¤ºä¸å°†è®¾å¤‡ä½œä¸ºæ§åˆ¶ç»ˆç«¯ï¼ŒO_NONBLOCK è¡¨ç¤ºéé˜»å¡æ¨¡å¼ã€‚</p>\n</li>\n<li><p>dio_tcsetattr: é…ç½®ä¸²å£å‚æ•°ï¼ŒåŒ…æ‹¬æ³¢ç‰¹ç‡ã€æ•°æ®ä½ã€åœæ­¢ä½ã€æ ¡éªŒä½å’Œæµæ§åˆ¶ã€‚</p>\n</li>\n<li><p>dio_write: å‘ä¸²å£å†™å…¥æ•°æ®ã€‚</p>\n</li>\n<li><p>dio_read: ä»ä¸²å£è¯»å–æ•°æ®ã€‚</p>\n</li>\n<li><p>dio_close: å…³é—­ä¸²å£è®¾å¤‡ã€‚</p>\n</li>\n</ul>\n<h3 id=\"4-ä¸²å£å‚æ•°é…ç½®\"><a href=\"#4-ä¸²å£å‚æ•°é…ç½®\" class=\"headerlink\" title=\"4. ä¸²å£å‚æ•°é…ç½®\"></a>4. ä¸²å£å‚æ•°é…ç½®</h3><ul>\n<li><p>dio_tcsetattr çš„é…ç½®é€‰é¡¹ï¼š</p>\n</li>\n<li><p>baud: æ³¢ç‰¹ç‡ï¼ˆå¦‚ 9600ã€19200ã€38400ã€57600ã€115200ï¼‰ã€‚</p>\n</li>\n<li><p>bits: æ•°æ®ä½ï¼ˆé€šå¸¸ä¸º 8ï¼‰ã€‚</p>\n</li>\n<li><p>stop: åœæ­¢ä½ï¼ˆ1 æˆ– 2ï¼‰ã€‚</p>\n</li>\n<li><p>parity: æ ¡éªŒä½ï¼ˆ0: æ— æ ¡éªŒï¼Œ1: å¥‡æ ¡éªŒï¼Œ2: å¶æ ¡éªŒï¼‰ã€‚</p>\n</li>\n<li><p>flow_control: æµæ§åˆ¶ï¼ˆ0: æ— æµæ§åˆ¶ï¼Œ1: ç¡¬ä»¶æµæ§åˆ¶ï¼‰ã€‚</p>\n</li>\n</ul>\n<h2 id=\"é‚£ä¹ˆè¿™æ—¶å€™éœ€è¦æµ‹è¯•ä¸€ä¸‹ä»£ç ã€‚é‚£æ€»ä¸èƒ½çœŸçš„æ‰¾ä¸ªä¸²å£è®¾å¤‡å§ï¼Œç„¶è€Œè™šæ‹Ÿä¸²å£çœŸé¦™ã€‚\"><a href=\"#é‚£ä¹ˆè¿™æ—¶å€™éœ€è¦æµ‹è¯•ä¸€ä¸‹ä»£ç ã€‚é‚£æ€»ä¸èƒ½çœŸçš„æ‰¾ä¸ªä¸²å£è®¾å¤‡å§ï¼Œç„¶è€Œè™šæ‹Ÿä¸²å£çœŸé¦™ã€‚\" class=\"headerlink\" title=\"é‚£ä¹ˆè¿™æ—¶å€™éœ€è¦æµ‹è¯•ä¸€ä¸‹ä»£ç ã€‚é‚£æ€»ä¸èƒ½çœŸçš„æ‰¾ä¸ªä¸²å£è®¾å¤‡å§ï¼Œç„¶è€Œè™šæ‹Ÿä¸²å£çœŸé¦™ã€‚\"></a>é‚£ä¹ˆè¿™æ—¶å€™éœ€è¦æµ‹è¯•ä¸€ä¸‹ä»£ç ã€‚é‚£æ€»ä¸èƒ½çœŸçš„æ‰¾ä¸ªä¸²å£è®¾å¤‡å§ï¼Œç„¶è€Œè™šæ‹Ÿä¸²å£çœŸé¦™ã€‚</h2><h3 id=\"5-åœ¨Linuxä¸­ä½¿ç”¨-socat-æ¨¡æ‹Ÿè™šæ‹Ÿä¸²å£\"><a href=\"#5-åœ¨Linuxä¸­ä½¿ç”¨-socat-æ¨¡æ‹Ÿè™šæ‹Ÿä¸²å£\" class=\"headerlink\" title=\"5.åœ¨Linuxä¸­ä½¿ç”¨ socat æ¨¡æ‹Ÿè™šæ‹Ÿä¸²å£\"></a>5.åœ¨Linuxä¸­ä½¿ç”¨ socat æ¨¡æ‹Ÿè™šæ‹Ÿä¸²å£</h3><p>socat æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥åˆ›å»ºè™šæ‹Ÿä¸²å£å¯¹ã€‚</p>\n<p>å®‰è£… socatï¼š<br>åœ¨Debian/Ubuntuç³»ç»Ÿä¸Šï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo apt update</span><br><span class=\"line\">sudo apt install socat</span><br></pre></td></tr></table></figure>\n<p>åˆ›å»ºè™šæ‹Ÿä¸²å£å¯¹ï¼š<br>è¿è¡Œä»¥ä¸‹å‘½ä»¤åˆ›å»ºä¸€å¯¹è™šæ‹Ÿä¸²å£ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">socat -d -d pty,raw,echo=0 pty,raw,echo=0</span><br></pre></td></tr></table></figure>\n<p>è¿è¡Œåå¦‚å›¾ï¼š<br><img src=\"/img/2024/20250103151316.png\" alt=\"https://erik.xyz\"><br>è¿™æ ·å¯ä»¥çœ‹åˆ°å‡ºç°ä¸¤ä¸ªè™šæ‹Ÿä¸²å£ã€‚<br>æŠŠä¸Šé¢çš„phpä»£ç æ”¾åˆ°æ–‡ä»¶ä¸­è¿è¡Œä¸€ä¸‹:<br><img src=\"/img/2024/20250103151620.png\" alt=\"https://erik.xyz\"></p>\n<p>åŒæ—¶æ–°å¼€ä¸ªçª—å£æ‰§è¡Œï¼š<code>cat /dev/pts/5</code>æ¥è¯»å–ä¸²å£æ•°æ®ã€‚<br>å¦‚ä¸‹å›¾ï¼š<br><img src=\"/img/2024/20250103151927.png\" alt=\"https://erik.xyz\"></p>\n<p>è¿™é‡Œæ˜¯å‘é€æ•°æ®ï¼Œé‚£æ¥æ”¶æ•°æ®æ€ä¹ˆçœ‹å‘¢ã€‚<br>é‚£å°±åœ¨ä»£ç ä¸Šæ”¹é€ ä¸€ä¸‹åŠ ä¸ªforï¼š<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">// ä»ä¸²å£è¯»å–æ•°æ®</span><br><span class=\"line\">$data = dio_read($fd, 1024); // è¯»å–æœ€å¤š 1024 å­—èŠ‚</span><br><span class=\"line\">echo &quot;å·²æ¥æ”¶: $data\\n&quot;;</span><br></pre></td></tr></table></figure><br>è¿™é‡Œæ”¹é€ ä¸»è¦æ˜¯æµ‹è¯•ç”¨ï¼Œå®é™…ä¸Šä¸éœ€è¦ã€‚<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">//æµ‹è¯•æ¥æ”¶</span><br><span class=\"line\">for($i=0;$i&lt;20;$i++)&#123;</span><br><span class=\"line\">    sleep(3);</span><br><span class=\"line\">// ä»ä¸²å£è¯»å–æ•°æ®</span><br><span class=\"line\">$data = dio_read($fd, 1024); // è¯»å–æœ€å¤š 1024 å­—èŠ‚</span><br><span class=\"line\">echo &quot;å·²æ¥æ”¶: $data\\n&quot;;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure><br>é‚£ä¹ˆï¼Œå†æ¬¡è¿è¡Œphpä»£ç ,ç„¶ååœ¨æ–°çª—å£è¿è¡Œ<code>echo &quot;æ¬¢è¿ä½ å‡ºç”Ÿåœ¨https://erik.xyz&quot; &gt; /dev/pts/5</code>æ¥å‘é€ä¿¡æ¯ï¼Œä½ ä¼šçœ‹åˆ°å¦‚å›¾çš„æ¥æ”¶ï¼š<br><img src=\"/img/2024/20250103152421.png\" alt=\"https://erik.xyz\"></p>\n<p>åˆ°è¿™é‡Œï¼Œå‘é€å’Œæ¥æ”¶ä¸²å£å·²ç»å¥½äº†ã€‚</p>\n",
            "tags": [
                "php",
                "phpä¸²å£å¼€å‘"
            ]
        },
        {
            "id": "https://erik.xyz/2024/12/18/maven-intranet-library/",
            "url": "https://erik.xyz/2024/12/18/maven-intranet-library/",
            "title": "mavenå†…ç½‘åº“",
            "date_published": "2024-12-18T12:55:00.000Z",
            "content_html": "<h4 id=\"1-æ­å»º-Maven-ç§æœ‰ä»“åº“\"><a href=\"#1-æ­å»º-Maven-ç§æœ‰ä»“åº“\" class=\"headerlink\" title=\"1. æ­å»º Maven ç§æœ‰ä»“åº“\"></a>1. æ­å»º Maven ç§æœ‰ä»“åº“</h4><p>é¦–å…ˆï¼Œéœ€è¦åœ¨å†…ç½‘ç¯å¢ƒä¸­æ­å»ºä¸€ä¸ª Maven ä»“åº“ï¼Œå¸¸ç”¨çš„ç§æœ‰ Maven ä»“åº“å·¥å…·æœ‰ï¼š</p>\n<ul>\n<li>Nexus Repositoryï¼šSonatype Nexus æ˜¯æœ€æµè¡Œçš„ç§æœ‰ Maven ä»“åº“ç®¡ç†å·¥å…·ã€‚</li>\n<li>Artifactoryï¼šJFrog Artifactory æ˜¯å¦ä¸€ç§æµè¡Œçš„æ„å»ºç®¡ç†å·¥å…·ï¼Œæä¾›äº†ç§æœ‰ä»“åº“çš„æ”¯æŒã€‚</li>\n<li>Apache Archivaï¼šApache Archiva ä¹Ÿæ˜¯ä¸€ä¸ªæ”¯æŒ Maven çš„ä»“åº“ç®¡ç†å·¥å…·ã€‚</li>\n</ul>\n<p>ä»¥ä¸‹æ˜¯æ­å»º Nexus Repository çš„ç®€å•æ­¥éª¤ï¼š<br><span id=\"more\"></span></p>\n<p>1.1 å®‰è£… Nexus Repository</p>\n<ul>\n<li><p>ä¸‹è½½ Nexusï¼š è®¿é—® Nexus Repository ä¸‹è½½é¡µé¢ ä¸‹è½½ Nexus OSS ç‰ˆæœ¬ã€‚</p>\n</li>\n<li><p>è§£å‹å¹¶å¯åŠ¨ï¼š è§£å‹ä¸‹è½½çš„å‹ç¼©åŒ…å¹¶å¯åŠ¨ Nexusã€‚</p>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">cd /opt/nexus/bin</span><br><span class=\"line\">./nexus start</span><br></pre></td></tr></table></figure>\n<ul>\n<li>è®¿é—® Nexus UIï¼š æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—® Nexus çš„é»˜è®¤åœ°å€ï¼š</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http://localhost:8081</span><br></pre></td></tr></table></figure>\n<p>é»˜è®¤ç”¨æˆ·åä¸º adminï¼Œå¯†ç ä¸º admin123ï¼Œå¯ä»¥åœ¨é¦–æ¬¡ç™»å½•åä¿®æ”¹å¯†ç ã€‚</p>\n<p>1.2 é…ç½® Maven ä»“åº“</p>\n<p>åœ¨ Nexus UI ä¸­ï¼Œä½ å¯ä»¥åˆ›å»ºä¸€ä¸ªæ–°çš„ Maven ä»“åº“ã€‚åˆ›å»ºä»“åº“åï¼Œä½ å¯ä»¥ä¸Šä¼ å…¬å¸çš„å†…éƒ¨ä¾èµ–ã€æ’ä»¶å’Œæ„å»ºå·¥ä»¶ã€‚</p>\n<h4 id=\"2-é…ç½®-Maven-ä½¿ç”¨å†…ç½‘ä»“åº“\"><a href=\"#2-é…ç½®-Maven-ä½¿ç”¨å†…ç½‘ä»“åº“\" class=\"headerlink\" title=\"2. é…ç½® Maven ä½¿ç”¨å†…ç½‘ä»“åº“\"></a>2. é…ç½® Maven ä½¿ç”¨å†…ç½‘ä»“åº“</h4><p>é…ç½® Maven ä½¿ç”¨å†…ç½‘ä»“åº“éœ€è¦ä¿®æ”¹ settings.xml æ–‡ä»¶ã€‚</p>\n<p>2.1 ä¿®æ”¹ settings.xml</p>\n<p>åœ¨ Maven çš„ settings.xml æ–‡ä»¶ä¸­ï¼Œé…ç½®ç§æœ‰ä»“åº“çš„åœ°å€å’Œè®¤è¯ä¿¡æ¯ã€‚settings.xml æ–‡ä»¶é€šå¸¸ä½äº ~/.m2/ ç›®å½•ä¸‹ï¼ˆç”¨æˆ·çº§åˆ«é…ç½®ï¼‰æˆ–è€… ${MAVEN_HOME}/conf/ ç›®å½•ä¸‹ï¼ˆå…¨å±€é…ç½®ï¼‰ã€‚</p>\n<p>ä»¥ä¸‹æ˜¯é…ç½®å†…ç½‘ Maven ä»“åº“çš„ç¤ºä¾‹ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;settings xmlns=&quot;http://maven.apache.org/SETTINGS/1.0.0&quot;</span><br><span class=\"line\">          xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class=\"line\">          xsi:schemaLocation=&quot;http://maven.apache.org/SETTINGS/1.0.0 http://maven.apache.org/xsd/settings-1.0.0.xsd&quot;&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;mirrors&gt;</span><br><span class=\"line\">        &lt;!-- é…ç½®ç§æœ‰ä»“åº“é•œåƒ --&gt;</span><br><span class=\"line\">        &lt;mirror&gt;</span><br><span class=\"line\">            &lt;id&gt;nexus&lt;/id&gt;</span><br><span class=\"line\">            &lt;mirrorOf&gt;external:http://central&lt;/mirrorOf&gt;</span><br><span class=\"line\">            &lt;url&gt;http://your-nexus-server:8081/repository/maven-public/&lt;/url&gt;</span><br><span class=\"line\">            &lt;blocked&gt;false&lt;/blocked&gt;</span><br><span class=\"line\">        &lt;/mirror&gt;</span><br><span class=\"line\">    &lt;/mirrors&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;repositories&gt;</span><br><span class=\"line\">        &lt;repository&gt;</span><br><span class=\"line\">            &lt;id&gt;internal-repo&lt;/id&gt;</span><br><span class=\"line\">            &lt;url&gt;http://your-nexus-server:8081/repository/maven-releases/&lt;/url&gt;</span><br><span class=\"line\">            &lt;snapshots&gt;</span><br><span class=\"line\">                &lt;enabled&gt;false&lt;/enabled&gt;</span><br><span class=\"line\">            &lt;/snapshots&gt;</span><br><span class=\"line\">        &lt;/repository&gt;</span><br><span class=\"line\">    &lt;/repositories&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;pluginRepositories&gt;</span><br><span class=\"line\">        &lt;pluginRepository&gt;</span><br><span class=\"line\">            &lt;id&gt;internal-plugins&lt;/id&gt;</span><br><span class=\"line\">            &lt;url&gt;http://your-nexus-server:8081/repository/maven-plugins/&lt;/url&gt;</span><br><span class=\"line\">        &lt;/pluginRepository&gt;</span><br><span class=\"line\">    &lt;/pluginRepositories&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">    &lt;servers&gt;</span><br><span class=\"line\">        &lt;!-- é…ç½® Maven ä»“åº“è®¤è¯ --&gt;</span><br><span class=\"line\">        &lt;server&gt;</span><br><span class=\"line\">            &lt;id&gt;nexus&lt;/id&gt;</span><br><span class=\"line\">            &lt;username&gt;your-nexus-username&lt;/username&gt;</span><br><span class=\"line\">            &lt;password&gt;your-nexus-password&lt;/password&gt;</span><br><span class=\"line\">        &lt;/server&gt;</span><br><span class=\"line\">    &lt;/servers&gt;</span><br><span class=\"line\">&lt;/settings&gt;</span><br></pre></td></tr></table></figure>\n<p>2.2 é…ç½®é•œåƒå’Œä»“åº“</p>\n<ul>\n<li><p>é•œåƒï¼ˆMirrorï¼‰ï¼šåœ¨ <mirrors> æ ‡ç­¾ä¸­é…ç½®ç§æœ‰ä»“åº“çš„ URLï¼Œå°† Maven çš„ä¸­å¤®ä»“åº“æˆ–å…¶ä»–å…¬å…±ä»“åº“çš„è¯·æ±‚ä»£ç†åˆ°ç§æœ‰ä»“åº“ä¸­ã€‚é€šè¿‡ mirrorOf é…ç½®æ¥é€‰æ‹©ä»£ç†å“ªäº›ä»“åº“ï¼ˆexternal:<a href=\"http://central\">http://central</a> è¡¨ç¤ºä»£ç†æ‰€æœ‰å¤–éƒ¨ä»“åº“ï¼‰ã€‚</p>\n</li>\n<li><p>ä»“åº“ï¼ˆRepositoryï¼‰ï¼šåœ¨ <repositories> å’Œ <pluginRepositories> æ ‡ç­¾ä¸­é…ç½®ä½ çš„å†…ç½‘ä»“åº“çš„ URLã€‚</p>\n</li>\n<li><p>è®¤è¯ï¼ˆServer Authenticationï¼‰ï¼šåœ¨ <servers> æ ‡ç­¾ä¸­é…ç½®å†…ç½‘ä»“åº“çš„è®¤è¯ä¿¡æ¯ï¼ˆå¦‚æœä»“åº“éœ€è¦è®¤è¯ï¼‰ã€‚</p>\n</li>\n</ul>\n<h4 id=\"3-é…ç½®é¡¹ç›®ä½¿ç”¨å†…ç½‘ä»“åº“\"><a href=\"#3-é…ç½®é¡¹ç›®ä½¿ç”¨å†…ç½‘ä»“åº“\" class=\"headerlink\" title=\"3. é…ç½®é¡¹ç›®ä½¿ç”¨å†…ç½‘ä»“åº“\"></a>3. é…ç½®é¡¹ç›®ä½¿ç”¨å†…ç½‘ä»“åº“</h4><p>åœ¨é¡¹ç›®çš„ pom.xml æ–‡ä»¶ä¸­ï¼Œé€šå¸¸ä¸éœ€è¦é¢å¤–é…ç½®ä»“åº“ï¼Œå› ä¸º Maven ä¼šä½¿ç”¨ settings.xml ä¸­é…ç½®çš„å†…ç½‘ä»“åº“ã€‚ä½†æ˜¯å¦‚æœéœ€è¦å¼ºåˆ¶æŒ‡å®šæŸä¸ªä»“åº“ï¼Œå¯ä»¥åœ¨ pom.xml ä¸­é…ç½® <repositories> æ ‡ç­¾ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;repositories&gt;</span><br><span class=\"line\">    &lt;repository&gt;</span><br><span class=\"line\">        &lt;id&gt;nexus-repo&lt;/id&gt;</span><br><span class=\"line\">        &lt;url&gt;http://your-nexus-server:8081/repository/maven-releases/&lt;/url&gt;</span><br><span class=\"line\">    &lt;/repository&gt;</span><br><span class=\"line\">&lt;/repositories&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"4-ä¸Šä¼ å’Œä¸‹è½½ä¾èµ–\"><a href=\"#4-ä¸Šä¼ å’Œä¸‹è½½ä¾èµ–\" class=\"headerlink\" title=\"4. ä¸Šä¼ å’Œä¸‹è½½ä¾èµ–\"></a>4. ä¸Šä¼ å’Œä¸‹è½½ä¾èµ–</h4><p>4.1 ä¸Šä¼ ä¾èµ–åˆ°å†…ç½‘ä»“åº“<br>ä½ å¯ä»¥é€šè¿‡ Maven å‘½ä»¤å°†æœ¬åœ°æ„å»ºçš„ JAR æ–‡ä»¶ä¸Šä¼ åˆ°å†…ç½‘ä»“åº“ã€‚ä¾‹å¦‚ï¼Œå°†æŸä¸ª JAR ä¸Šä¼ åˆ° Nexusï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mvn deploy:deploy-file \\</span><br><span class=\"line\">    -DgroupId=com.example \\</span><br><span class=\"line\">    -DartifactId=my-artifact \\</span><br><span class=\"line\">    -Dversion=1.0.0 \\</span><br><span class=\"line\">    -Dpackaging=jar \\</span><br><span class=\"line\">    -Dfile=path/to/your-artifact.jar \\</span><br><span class=\"line\">    -DrepositoryId=nexus \\</span><br><span class=\"line\">    -Durl=http://your-nexus-server:8081/repository/maven-releases/</span><br></pre></td></tr></table></figure>\n<p>4.2 ä»å†…ç½‘ä»“åº“ä¸‹è½½ä¾èµ–</p>\n<p>é…ç½®å¥½å†…ç½‘ä»“åº“åï¼ŒMaven ä¼šè‡ªåŠ¨ä»å†…ç½‘ä»“åº“ä¸‹è½½ä¾èµ–ã€‚å¦‚æœä»“åº“ä¸­æ²¡æœ‰è¯¥ä¾èµ–ï¼ŒMaven ä¼šå°è¯•ä»å…¶ä»–é…ç½®çš„ä»“åº“ä¸‹è½½ã€‚</p>\n<h4 id=\"5-ä½¿ç”¨ç§æœ‰ä»“åº“ä¸­çš„ä¾èµ–\"><a href=\"#5-ä½¿ç”¨ç§æœ‰ä»“åº“ä¸­çš„ä¾èµ–\" class=\"headerlink\" title=\"5. ä½¿ç”¨ç§æœ‰ä»“åº“ä¸­çš„ä¾èµ–\"></a>5. ä½¿ç”¨ç§æœ‰ä»“åº“ä¸­çš„ä¾èµ–</h4><p>ä¸€æ—¦ä»“åº“é…ç½®å¥½ï¼ŒMaven å°†ä¼šä»é…ç½®çš„å†…ç½‘ä»“åº“ä¸‹è½½ä¾èµ–ã€‚ä½ å¯ä»¥åœ¨é¡¹ç›®çš„ pom.xml ä¸­æ­£å¸¸å¼•ç”¨ä¾èµ–ï¼ŒMaven ä¼šè‡ªåŠ¨ä»ç§æœ‰ä»“åº“ä¸­æ‹‰å–ã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;dependencies&gt;</span><br><span class=\"line\">    &lt;dependency&gt;</span><br><span class=\"line\">        &lt;groupId&gt;com.example&lt;/groupId&gt;</span><br><span class=\"line\">        &lt;artifactId&gt;my-artifact&lt;/artifactId&gt;</span><br><span class=\"line\">        &lt;version&gt;1.0.0&lt;/version&gt;</span><br><span class=\"line\">    &lt;/dependency&gt;</span><br><span class=\"line\">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>\n<h4 id=\"6-é…ç½®é•œåƒä»¥æé«˜æ„å»ºé€Ÿåº¦ï¼ˆå¯é€‰ï¼‰\"><a href=\"#6-é…ç½®é•œåƒä»¥æé«˜æ„å»ºé€Ÿåº¦ï¼ˆå¯é€‰ï¼‰\" class=\"headerlink\" title=\"6. é…ç½®é•œåƒä»¥æé«˜æ„å»ºé€Ÿåº¦ï¼ˆå¯é€‰ï¼‰\"></a>6. é…ç½®é•œåƒä»¥æé«˜æ„å»ºé€Ÿåº¦ï¼ˆå¯é€‰ï¼‰</h4><p>ä¸ºäº†æé«˜æ„å»ºé€Ÿåº¦ï¼Œä½ å¯ä»¥é…ç½® settings.xml æ¥ä½¿ç”¨ç§æœ‰ä»“åº“ä½œä¸º Maven çš„é»˜è®¤é•œåƒï¼Œç¡®ä¿æ‰€æœ‰çš„æ„å»ºä¾èµ–éƒ½ä»ç§æœ‰ä»“åº“ä¸­æ‹‰å–ï¼Œé¿å…æ¯æ¬¡è®¿é—®å¤–éƒ¨ä»“åº“ï¼Œé™ä½æ„å»ºæ—¶é—´ã€‚</p>\n",
            "tags": [
                "mavenæ­å»ºåº“",
                "maven",
                "mavenå†…ç½‘åº“"
            ]
        },
        {
            "id": "https://erik.xyz/2024/12/12/intranet-spring-boot-install/",
            "url": "https://erik.xyz/2024/12/12/intranet-spring-boot-install/",
            "title": "spring bootå†…ç½‘éƒ¨ç½²",
            "date_published": "2024-12-12T10:22:18.000Z",
            "content_html": "<h4 id=\"1-å‡†å¤‡ç¯å¢ƒ\"><a href=\"#1-å‡†å¤‡ç¯å¢ƒ\" class=\"headerlink\" title=\"1. å‡†å¤‡ç¯å¢ƒ\"></a>1. å‡†å¤‡ç¯å¢ƒ</h4><p>ç¡®ä¿å†…ç½‘ä¸­çš„æœåŠ¡å™¨æˆ–æœºå™¨å…·å¤‡è¿è¡Œ Spring Boot åº”ç”¨çš„åŸºæœ¬ç¯å¢ƒï¼š</p>\n<ul>\n<li>JDKï¼šç¡®ä¿æœåŠ¡å™¨å®‰è£…äº†åˆé€‚ç‰ˆæœ¬çš„ JDKï¼ˆé€šå¸¸å»ºè®®ä½¿ç”¨ Java 8 åŠä»¥ä¸Šç‰ˆæœ¬ï¼‰ã€‚</li>\n<li>Maven/Gradleï¼šæ ¹æ®é¡¹ç›®ä½¿ç”¨çš„æ„å»ºå·¥å…·å®‰è£… Maven æˆ– Gradleã€‚</li>\n<li>æ•°æ®åº“ï¼šå¦‚æœåº”ç”¨éœ€è¦è¿æ¥æ•°æ®åº“ï¼Œç¡®ä¿æ•°æ®åº“åœ¨å†…ç½‘ä¸­å¯è®¿é—®ï¼Œä¸”è¿æ¥é…ç½®æ­£ç¡®ã€‚</li>\n</ul>\n<span id=\"more\"></span>\n<h4 id=\"2-ç¼–è¯‘-Spring-Boot-åº”ç”¨\"><a href=\"#2-ç¼–è¯‘-Spring-Boot-åº”ç”¨\" class=\"headerlink\" title=\"2. ç¼–è¯‘ Spring Boot åº”ç”¨\"></a>2. ç¼–è¯‘ Spring Boot åº”ç”¨</h4><p>é¦–å…ˆï¼Œä½ éœ€è¦ç¼–è¯‘ä½ çš„ Spring Boot åº”ç”¨ï¼Œç”Ÿæˆå¯æ‰§è¡Œçš„ JAR æ–‡ä»¶ã€‚å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤åœ¨é¡¹ç›®ç›®å½•ä¸‹æ‰§è¡Œï¼š</p>\n<ul>\n<li>Maven æ„å»ºå‘½ä»¤ï¼š</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">mvn clean package</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<ul>\n<li>Gradle æ„å»ºå‘½ä»¤ï¼š</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">./gradlew build</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¼šåœ¨ target/ æˆ– build/libs/ ç›®å½•ä¸‹ç”Ÿæˆä¸€ä¸ªå¯æ‰§è¡Œçš„ JAR æ–‡ä»¶ï¼Œé€šå¸¸åä¸º your-application-name.jarã€‚</p>\n<h4 id=\"3-ä¼ è¾“-JAR-åˆ°å†…ç½‘æœåŠ¡å™¨\"><a href=\"#3-ä¼ è¾“-JAR-åˆ°å†…ç½‘æœåŠ¡å™¨\" class=\"headerlink\" title=\"3. ä¼ è¾“ JAR åˆ°å†…ç½‘æœåŠ¡å™¨\"></a>3. ä¼ è¾“ JAR åˆ°å†…ç½‘æœåŠ¡å™¨</h4><p>å°†ç”Ÿæˆçš„ JAR æ–‡ä»¶ä¸Šä¼ åˆ°å†…ç½‘çš„ç›®æ ‡æœåŠ¡å™¨ã€‚å¯ä»¥ä½¿ç”¨å„ç§æ–‡ä»¶ä¼ è¾“å·¥å…·ï¼Œæ¯”å¦‚ï¼š</p>\n<ul>\n<li>SCPï¼ˆå¦‚æœæœåŠ¡å™¨æ”¯æŒ SSHï¼‰ï¼š</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">scp your-application-name.jar user@server-ip:/path/to/deploy/</span><br></pre></td></tr></table></figure>\n<ul>\n<li>FTP æˆ– SFTPï¼ˆå¦‚æœæœ‰é…ç½® FTP æœåŠ¡ï¼‰ã€‚</li>\n</ul>\n<h4 id=\"4-é…ç½®-Spring-Boot-åº”ç”¨\"><a href=\"#4-é…ç½®-Spring-Boot-åº”ç”¨\" class=\"headerlink\" title=\"4. é…ç½® Spring Boot åº”ç”¨\"></a>4. é…ç½® Spring Boot åº”ç”¨</h4><p>åœ¨å†…ç½‘éƒ¨ç½²æ—¶ï¼Œä½ å¯èƒ½éœ€è¦æ ¹æ®ç¯å¢ƒä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚ application.properties æˆ– application.ymlã€‚å¸¸è§çš„é…ç½®é¡¹åŒ…æ‹¬ï¼š</p>\n<ul>\n<li>æ•°æ®åº“è¿æ¥ä¿¡æ¯ï¼ˆspring.datasource.urlã€spring.datasource.username ç­‰ï¼‰ã€‚</li>\n<li>æ—¥å¿—é…ç½®ã€‚</li>\n<li>æœåŠ¡ç«¯å£ï¼ˆserver.portï¼‰ã€‚</li>\n<li>å®‰å…¨è®¾ç½®ï¼ˆå¦‚ç¦ç”¨å¤–éƒ¨è®¿é—®ï¼Œæˆ–è€…è®¾ç½®è®¿é—®ç™½åå•ç­‰ï¼‰ã€‚</li>\n</ul>\n<p>ä¾‹å¦‚ï¼Œä¿®æ”¹ application.properties ä¸­çš„æ•°æ®åº“é…ç½®ï¼š<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">spring.datasource.url=jdbc:mysql://localhost:3306/your_db</span><br><span class=\"line\">spring.datasource.username=db_user</span><br><span class=\"line\">spring.datasource.password=db_password</span><br></pre></td></tr></table></figure></p>\n<h4 id=\"5-å¯åŠ¨-Spring-Boot-åº”ç”¨\"><a href=\"#5-å¯åŠ¨-Spring-Boot-åº”ç”¨\" class=\"headerlink\" title=\"5. å¯åŠ¨ Spring Boot åº”ç”¨\"></a>5. å¯åŠ¨ Spring Boot åº”ç”¨</h4><p>åœ¨å†…ç½‘æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨ Spring Boot åº”ç”¨ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">java -jar your-application-name.jar</span><br></pre></td></tr></table></figure>\n<p>å¦‚æœä½ å¸Œæœ›åº”ç”¨åœ¨åå°è¿è¡Œï¼Œå¯ä»¥ä½¿ç”¨ nohup æˆ–è€…ç±»ä¼¼çš„å·¥å…·ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">nohup java -jar your-application-name.jar &gt; output.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure>\n<p>è¿™ä¼šå°†è¾“å‡ºé‡å®šå‘åˆ° output.log æ–‡ä»¶ï¼Œå¹¶è®©åº”ç”¨åœ¨åå°è¿è¡Œã€‚</p>\n<h4 id=\"6-é…ç½®é˜²ç«å¢™å’Œç½‘ç»œ\"><a href=\"#6-é…ç½®é˜²ç«å¢™å’Œç½‘ç»œ\" class=\"headerlink\" title=\"6. é…ç½®é˜²ç«å¢™å’Œç½‘ç»œ\"></a>6. é…ç½®é˜²ç«å¢™å’Œç½‘ç»œ</h4><ul>\n<li>ç¡®ä¿æœåŠ¡å™¨çš„é˜²ç«å¢™å…è®¸è®¿é—®åº”ç”¨æ‰€ç»‘å®šçš„ç«¯å£ï¼ˆé»˜è®¤æ˜¯ 8080ï¼‰ã€‚å¦‚æœä½¿ç”¨å…¶ä»–ç«¯å£ï¼Œå¯ä»¥åœ¨é˜²ç«å¢™ä¸­é…ç½®å…è®¸è®¿é—®è¯¥ç«¯å£ã€‚</li>\n<li>å¦‚æœ Spring Boot åº”ç”¨éœ€è¦é€šè¿‡å†…ç½‘çš„ç‰¹å®š IP åœ°å€æˆ–åŸŸåè®¿é—®ï¼Œç¡®ä¿ DNS æˆ– hosts é…ç½®æ­£ç¡®ã€‚</li>\n</ul>\n<h4 id=\"7-ç›‘æ§å’Œæ—¥å¿—\"><a href=\"#7-ç›‘æ§å’Œæ—¥å¿—\" class=\"headerlink\" title=\"7. ç›‘æ§å’Œæ—¥å¿—\"></a>7. ç›‘æ§å’Œæ—¥å¿—</h4><ul>\n<li>æ—¥å¿—ï¼šSpring Boot åº”ç”¨ä¼šå°†æ—¥å¿—è¾“å‡ºåˆ°æ§åˆ¶å°ï¼Œä½ å¯ä»¥å°†æ—¥å¿—é…ç½®ä¸ºè¾“å‡ºåˆ°æ–‡ä»¶ä¸­è¿›è¡ŒæŒä¹…åŒ–å­˜å‚¨ã€‚å¸¸è§åšæ³•æ˜¯åœ¨ application.properties æˆ– application.yml ä¸­è®¾ç½®æ—¥å¿—è·¯å¾„ï¼š</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">logging.file.name=/path/to/logs/application.log</span><br></pre></td></tr></table></figure>\n<ul>\n<li>ç›‘æ§ï¼šå¯ä»¥ä½¿ç”¨ Spring Boot çš„ Actuator æˆ–å…¶ä»–ç›‘æ§å·¥å…·ï¼ˆå¦‚ Prometheus å’Œ Grafanaï¼‰æ¥ç›‘æ§åº”ç”¨çš„è¿è¡ŒçŠ¶æ€ã€‚</li>\n</ul>\n<h4 id=\"8-è®¾ç½®å¼€æœºå¯åŠ¨ï¼ˆå¯é€‰ï¼‰\"><a href=\"#8-è®¾ç½®å¼€æœºå¯åŠ¨ï¼ˆå¯é€‰ï¼‰\" class=\"headerlink\" title=\"8. è®¾ç½®å¼€æœºå¯åŠ¨ï¼ˆå¯é€‰ï¼‰\"></a>8. è®¾ç½®å¼€æœºå¯åŠ¨ï¼ˆå¯é€‰ï¼‰</h4><p>å¦‚æœå¸Œæœ›åº”ç”¨åœ¨æœåŠ¡å™¨é‡å¯æ—¶è‡ªåŠ¨å¯åŠ¨ï¼Œå¯ä»¥ä½¿ç”¨ systemdï¼ˆLinux ç³»ç»Ÿï¼‰æˆ–é…ç½®ä¸º Windows æœåŠ¡ã€‚</p>\n<p>Linux ç³»ç»Ÿ (Systemd)</p>\n<p>åˆ›å»ºä¸€ä¸ª systemd æœåŠ¡æ–‡ä»¶ï¼Œå¦‚ /etc/systemd/system/yourapp.serviceï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[Unit]</span><br><span class=\"line\">Description=Spring Boot Application</span><br><span class=\"line\">After=network.target</span><br><span class=\"line\"></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">User=your_user</span><br><span class=\"line\">ExecStart=/usr/bin/java -jar /path/to/your-application-name.jar</span><br><span class=\"line\">SuccessExitStatus=143</span><br><span class=\"line\">Restart=always</span><br><span class=\"line\"></span><br><span class=\"line\">[Install]</span><br><span class=\"line\">WantedBy=multi-user.target</span><br></pre></td></tr></table></figure>\n<p>ç„¶åå¯ç”¨å¹¶å¯åŠ¨æœåŠ¡ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo systemctl enable yourapp</span><br><span class=\"line\">sudo systemctl start yourapp</span><br></pre></td></tr></table></figure>",
            "tags": [
                "springboot",
                "springbootå†…ç½‘éƒ¨ç½²"
            ]
        },
        {
            "id": "https://erik.xyz/2024/11/15/deepin-not-login/",
            "url": "https://erik.xyz/2024/11/15/deepin-not-login/",
            "title": "deepinæ— æ³•ç™»å½•æŠ¥é”™emergency mode",
            "date_published": "2024-11-15T02:56:00.000Z",
            "content_html": "<p>ç”±äºç³»ç»Ÿé‡å¯åï¼Œæ–°å®‰è£…çš„å¾®ä¿¡ä¸€ç›´å¼¹å‡ºæ¡†ï¼Œå¡åœ¨é‚£éš¾å—ã€‚ç«‹é©¬å¼ºåˆ¶é‡å¯ï¼Œå¼€æœºåå°±ä¸€ç›´æ˜¾ç¤ºYou are in emergency modeâ€¦â€¦ä¸€å †ä¸œè¥¿ï¼Œæ„æ€æ˜¯è¯´è®©è¿›å…¥rootç”¨æˆ·ï¼ŒæŸ¥çœ‹æŠ¥é”™å¹¶ä¿®å¤ã€‚</p>\n<p>  æœ‰ç‚¹å¤´å¤§äº†ã€‚</p>\n<p>  ç³»ç»Ÿå‘½ä»¤å¯ä»¥æ˜¾ç¤ºï¼Œå›¾å½¢ç•Œé¢ä¸æ˜¾ç¤ºã€‚<br>  <span id=\"more\"></span><br>  æœæ–­æ‹¿å‡ºå®‰è£…ç³»ç»Ÿçš„uç›˜ï¼Œä½¿ç”¨uç›˜å¯åŠ¨è¿›å…¥å®‰è£…ç•Œé¢ï¼ŒæŒ‰ctrl+alt+f4è¿›å…¥uç›˜å‘½ä»¤ç•Œé¢ã€‚è¾“å…¥startxè¿›å…¥uç›˜å›¾å½¢ç•Œé¢ã€‚è¿™ä¸‹å¯ä»¥çœ‹åˆ°ç”µè„‘çš„æŒ‚ç€ç›˜ã€‚æ ¹æ®æŒ‚ç€çš„ç›˜ä¸€ä¸ªä¸ªæ‰¾æ ¹ç›®å½•ç›˜ã€‚æ‰¾åˆ°åä½¿ç”¨uç›˜ç³»ç»Ÿçš„å‘½ä»¤çª—å£:<br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo vi /etc/fstab</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure></p>\n<p> æ³¨é‡Šæ‰homeç›®å½•ï¼Œé‡å¯ç³»ç»Ÿã€‚</p>\n<p> é‡å¯åä¼šæ˜¾ç¤ºä¸ªç™»å½•å›¾å½¢ç•Œé¢ã€‚è¿™ä¸ªæ˜¯å‡çš„ï¼Œæ²¡ç”¨ã€‚æŒ‰ctrl+alt+f2è¿›å…¥å‘½ä»¤ç•Œé¢ã€‚<br> ä½¿ç”¨è´¦å·å¯†ç ç™»å½•å‘½ä»¤ç•Œé¢ã€‚</p>\n<p> æ‰“å¼€/etc/fstabæ–‡ä»¶å–æ¶ˆhomeæ³¨é‡Šã€‚ï¼ˆè¿™é‡Œè¦çœ‹ä¸€ä¸‹homeæŒ‚è½½è·¯å¾„ï¼Œæ¯”å¦‚æˆ‘çš„/dev/sda6ï¼‰</p>\n<p> ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ä¿®å¤ï¼š<br> <figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo e2fsck /dev/sda6</span><br></pre></td></tr></table></figure></p>\n<p> ä½ ä¼šçœ‹åˆ°ä¸€å †ä¿®å¤ï¼Œä¸€ä¸ªä¸ªç¡®è®¤åï¼Œç­‰å¾…ä¿®å¤å®Œæˆå°±é‡å¯ç³»ç»Ÿã€‚</p>\n",
            "tags": [
                "deepin",
                "emergency",
                "emergency mode",
                "deepiné»‘å±"
            ]
        },
        {
            "id": "https://erik.xyz/2024/11/11/mysql-redis-consistency/",
            "url": "https://erik.xyz/2024/11/11/mysql-redis-consistency/",
            "title": "å¦‚ä½•ä¸‹ä¿è¯MySQLæ•°æ®åº“ä¸Redisç¼“å­˜æ•°æ®ä¸€è‡´æ€§ï¼Ÿ",
            "date_published": "2024-11-11T01:58:00.000Z",
            "content_html": "<p>æœ‰æ—¶å€™æ„Ÿè§‰MySQLæˆ‘ä»¬æ‡‚äº†ï¼ŒRedisæˆ‘ä»¬æ‡‚äº†ï¼Œä½†æ˜¯é¢è¯•çš„æ—¶å€™ä¸€ç›´ç­”ä¸å¥½ï¼Œç»å¸¸è¢«éš¾ä½ï¼Œé—®é¢˜åœ¨å“ªå‘¢ï¼Ÿ</p>\n<p>ç­”æ¡ˆæ˜¯ï¼šé¢è¯•å®˜è€ƒçš„ä¸æ˜¯ä¸“é¡¹èƒ½åŠ›ï¼Œè€Œæ˜¯å¤šé¡¹æŠ€æœ¯ç»“åˆåº”ç”¨èƒ½åŠ›ã€‚</p>\n<p>å°±æ‹¿<strong>å¹¶å‘åœºæ™¯ä¸‹å¦‚ä½•ä¿è¯MySQLä¸Redisç¼“å­˜ä¸€è‡´æ€§ï¼Ÿ</strong>è¿™ä¸ªé¢è¯•å®˜å¸¸è§çš„æ‹·æ‰“è€ƒç‚¹ä¸¾ä¾‹ã€‚</p>\n<p>å¯¹äºè¯»å¤šå†™å°‘å¹¶ä¸”è¦æ±‚é«˜æ€§èƒ½çš„ä¸šåŠ¡é€»è¾‘ï¼Œæˆ‘ä»¬é€šå¸¸åœ¨åº”ç”¨æœåŠ¡å™¨è®¿é—®MySQLæ•°æ®åº“çš„ä¸­é—´åŠ ä¸Šä¸€å±‚<strong>Redisç¼“å­˜å±‚</strong>ï¼Œä»¥æé«˜æ•°æ®çš„æŸ¥è¯¢æ•ˆç‡ï¼Œå‡è½»MySQLæ•°æ®åº“çš„å‹åŠ›ï¼Œé¿å…åœ¨MySQLå‡ºç°æ€§èƒ½ç“¶é¢ˆã€‚<br><span id=\"more\"></span><br><img src=\"/img/2024/2024111101.png\" alt=\"https://erik.xyz\"></p>\n<p>è¯¥é—®é¢˜ï¼Œå¦‚æœåœ¨æ•°æ®å­˜å‚¨åï¼Œåªè¯»åœºæ™¯ä¸‹æ˜¯ä¸ä¼šå‡ºç°MySQLä¸Redisç¼“å­˜çš„ä¸€è‡´æ€§é—®é¢˜çš„ï¼Œæ‰€ä»¥çœŸæ­£éœ€è¦è€ƒè™‘çš„æ˜¯<strong>å¹¶å‘è¯»å†™åœºæ™¯</strong>ä¸‹çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ã€‚</p>\n<p>å¦‚æœæˆ‘ä»¬ä¸åŠ åˆ†æï¼Œå•ç‹¬åˆ©ç”¨MySQLå’ŒRedisçš„çŸ¥è¯†è¿›è¡Œå›ç­”å¹¶å‘åœºæ™¯ä¸‹å¦‚ä½•ä¿è¯MySQLä¸Redisç¼“å­˜ä¸€è‡´æ€§ï¼Ÿå¾ˆéš¾æŠŠè¿™ä¸ªé—®é¢˜å›ç­”å¥½ï¼Œå› ä¸ºçœ‹èµ·æ¥å¾ˆç®€å•çš„æ–¹æ¡ˆå®é™…ä¸Šæ˜¯æ¼æ´ç™¾å‡ºçš„ã€‚</p>\n<h4 id=\"ç®€å•æ–¹æ¡ˆä¸‹çš„æ¼æ´ç™¾å‡º\"><a href=\"#ç®€å•æ–¹æ¡ˆä¸‹çš„æ¼æ´ç™¾å‡º\" class=\"headerlink\" title=\"ç®€å•æ–¹æ¡ˆä¸‹çš„æ¼æ´ç™¾å‡º\"></a>ç®€å•æ–¹æ¡ˆä¸‹çš„æ¼æ´ç™¾å‡º</h4><p>æˆ‘ä»¬å…ˆçœ‹ä¸‹ç®€å•çš„æ›´æ–°æ•°æ®åº“ã€åˆ é™¤ç¼“å­˜å’Œæ›´æ–°ç¼“å­˜æ–¹æ¡ˆä¸‹ï¼Œä¼šå‡ºç°ä»€ä¹ˆé—®é¢˜ï¼Ÿ</p>\n<p><img src=\"/img/2024/2024111102.png\" alt=\"https://erik.xyz\"></p>\n<h4 id=\"æ›´æ–°ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“\"><a href=\"#æ›´æ–°ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“\" class=\"headerlink\" title=\"æ›´æ–°ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“\"></a>æ›´æ–°ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“</h4><p>å…ˆè¯´ç»“è®ºï¼šä¸è€ƒè™‘ã€‚</p>\n<p>åŸå› æ˜¯æ›´æ–°ç¼“å­˜æˆåŠŸåï¼Œæ•°æ®åº“å¯èƒ½æ›´æ–°å¤±è´¥ï¼Œå‡ºç°æ•°æ®åº“ä¸ºæ—§å€¼ï¼Œç¼“å­˜ä¸ºæ–°å€¼ã€‚å¯¼è‡´åç»­çš„æ‰€æœ‰çš„è¯»è¯·æ±‚ï¼Œåœ¨ç¼“å­˜æœªè¿‡æœŸæˆ–ç¼“å­˜æœªé‡æ–°æ­£ç¡®æ›´æ–°çš„æƒ…å†µä¸‹ï¼Œä¼šä¸€ç›´ä¿æŒäº†æ•°æ®çš„å®Œå…¨ä¸ä¸€è‡´ï¼å¹¶ä¸”å½“å‰æ•°æ®åº“ä¸­çš„å€¼ä¸ºæ—§å€¼ï¼Œè€Œä¸šåŠ¡æ•°æ®çš„æ­£ç¡®æ€§åº”è¯¥ä»¥æ•°æ®åº“çš„ä¸ºå‡†ã€‚</p>\n<p>é‚£ä¹ˆå¦‚æœæ›´æ–°ç¼“å­˜æˆåŠŸåï¼Œæ•°æ®åº“å¯èƒ½æ›´æ–°å¤±è´¥ï¼Œæˆ‘ä»¬<strong>é‡æ–°æ›´æ–°ç¼“å­˜</strong>æ˜¯ä¸æ˜¯å¯ä»¥äº†ï¼Ÿ</p>\n<p><img src=\"/img/2024/2024111103.png\" alt=\"https://erik.xyz\"></p>\n<p>æŠ›å¼€éœ€è¦é‡æ–°æ›´æ–°ç¼“å­˜æ—¶ï¼Œè¦å•è¡¨æˆ–å¤šè¡¨é‡æ–°æŸ¥è¯¢æ•°æ®ï¼Œå†æ›´æ–°æ•°æ®å¸¦æ¥çš„æ€§èƒ½é—®é¢˜ï¼Œè¿˜å¯èƒ½æœŸé—´æœ‰æ•°æ®å˜æ›´å†æ¬¡é™·å…¥è„æ•°æ®çš„æƒ…å†µã€‚å®é™…ä¸Šä»ç„¶è¿˜æ˜¯ä¼šå‡ºç°å¹¶å‘ä¸€è‡´æ€§é—®é¢˜ã€‚</p>\n<p>åªè¦ç¼“å­˜è¿›è¡Œäº†æ›´æ–°ï¼Œåç»­çš„è¯»è¯·æ±‚<strong>åœ¨æ›´æ–°æ•°æ®åº“å‰ã€æ›´æ–°æ•°æ®åº“å¤±è´¥å¹¶å‡†å¤‡æ›´æ–°ç¼“å­˜å‰</strong>ï¼ŒåŸºæœ¬ä¸Šéƒ½èƒ½å‘½ä¸­ç¼“å­˜æƒ…å†µï¼Œè€Œè¿™æ—¶è¿”å›çš„æ•°æ®éƒ½æ˜¯æœªè½åº“çš„è„æ•°æ®ã€‚</p>\n<p><img src=\"/img/2024/2024111104.png\" alt=\"https://erik.xyz\"></p>\n<h4 id=\"æ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜\"><a href=\"#æ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜\" class=\"headerlink\" title=\"æ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜\"></a>æ›´æ–°æ•°æ®åº“ï¼Œå†æ›´æ–°ç¼“å­˜</h4><p>ä¸è€ƒè™‘ã€‚</p>\n<p>åŸå› æ˜¯å½“æ•°æ®åº“æ›´æ–°æˆåŠŸåï¼Œç¼“å­˜æ›´æ–°å¤±è´¥ï¼Œå‡ºç°æ•°æ®åº“ä¸ºæœ€æ–°å€¼ï¼Œç¼“å­˜ä¸ºæ—§å€¼ã€‚å¯¼è‡´åç»­çš„æ‰€æœ‰çš„è¯»è¯·æ±‚ï¼Œåœ¨ç¼“å­˜æœªè¿‡æœŸæˆ–ç¼“å­˜æœªé‡æ–°æ­£ç¡®æ›´æ–°çš„æƒ…å†µä¸‹ï¼Œä¼šä¸€ç›´ä¿æŒäº†æ•°æ®çš„å®Œå…¨ä¸ä¸€è‡´ï¼</p>\n<p><img src=\"/img/2024/2024111105.png\" alt=\"https://erik.xyz\"></p>\n<p>è¯¥æ–¹æ¡ˆå°±ç®—åœ¨æ›´æ–°æ•°æ®åº“ã€æ›´æ–°ç¼“å­˜éƒ½æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œè¿˜æ˜¯ä¼šå­˜åœ¨å¹¶å‘å¼•å‘çš„ä¸€è‡´æ€§é—®é¢˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆç‚¹å‡»å›¾ç‰‡æŸ¥çœ‹å¤§å›¾ï¼‰ï¼š<br><img src=\"/img/2024/2024111106.png\" alt=\"https://erik.xyz\"></p>\n<p>å¯ä»¥çœ‹åˆ°åœ¨å¹¶å‘å¤šå†™å¤šè¯»çš„åœºæ™¯ä¸‹æ•°æ®å­˜åœ¨çš„ä¸ä¸€è‡´æ€§é—®é¢˜ã€‚</p>\n<h4 id=\"å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“\"><a href=\"#å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“\" class=\"headerlink\" title=\"å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“\"></a>å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“</h4><p>ä¸è€ƒè™‘ï¼Œä½†æ˜¯é€šè¿‡ä½¿ç”¨<strong>å»¶æ—¶åŒåˆ ç­–ç•¥</strong>åå¯ä»¥è€ƒè™‘ã€‚</p>\n<p>é‡‡ç”¨â€œ<strong>å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“</strong>â€çš„æ–¹æ¡ˆæ˜¯ä¸€ç§å¸¸è§çš„æ–¹æ³•æ¥å°è¯•è§£å†³è¿™ä¸ªé—®é¢˜çš„ç­–ç•¥ã€‚</p>\n<p>è¿™ç§æ–¹æ³•é€»è¾‘è¾ƒä¸ºç®€å•ï¼Œæ˜“äºç†è§£å’Œå®ç°ï¼Œç†è®ºä¸Šåˆ é™¤æ—§ç¼“å­˜åï¼Œä¸‹æ¬¡è¯»å–æ—¶å°†ä»æ•°æ®åº“è·å–æœ€æ–°æ•°æ®ã€‚</p>\n<p>ä½†åœ¨å¹¶å‘çš„æç«¯æƒ…å†µä¸‹ï¼Œåˆ é™¤ç¼“å­˜æˆåŠŸåï¼Œå¦‚æœå†æœ‰å¤§é‡çš„å¹¶å‘è¯·æ±‚è¿›æ¥ï¼Œé‚£ä¹ˆä¾¿ä¼šç›´æ¥è¯·æ±‚åˆ°æ•°æ®åº“ä¸­ï¼Œå¯¹æ•°æ®åº“é€ æˆå·¨å¤§çš„å‹åŠ›ã€‚è€Œä¸”æ­¤æ–¹æ¡ˆè¿˜æ˜¯å¯èƒ½ä¼šå‘ç”Ÿæ•°æ®ä¸ä¸€è‡´æ€§é—®é¢˜ã€‚</p>\n<p><img src=\"/img/2024/2024111107.png\" alt=\"https://erik.xyz\"></p>\n<p>é€šè¿‡ä¸Šå›¾å‘ç°åœ¨åˆ é™¤ç¼“å­˜åï¼Œå¦‚æœæœ‰å¹¶å‘è¯»è¯·æ±‚1.1è¿›æ¥ï¼Œé‚£ä¹ˆæŸ¥è¯¢ç¼“å­˜è‚¯å®šæ˜¯ä¸å­˜åœ¨ï¼Œåˆ™å»è¯»å–æ•°æ®åº“ï¼Œä½†å› ä¸ºæ­¤æ—¶æ›´æ–°æ•°æ®åº“x=10çš„æ“ä½œ2.æ›´æ–°æ•°æ®åº“è¿˜æœªå®Œæˆï¼Œæ‰€ä»¥è¯»å–åˆ°çš„ä»ç„¶æ˜¯æ—§å€¼x=5å¹¶è®¾ç½®ç¼“å­˜åï¼Œåœ¨2.æ›´æ–°æ•°æ®åº“å®Œæˆåï¼Œæ•°æ®æ˜¯æ–°å€¼10ï¼Œè€Œç¼“å­˜æ˜¯æ—§å€¼ï¼Œé€ æˆäº†æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p>\n<p>å¯¹æ­¤æˆ‘ä»¬å¯ä»¥å…ˆè¿›è¡Œä¸€æ³¢çš„å°ä¼˜åŒ–ï¼Œé‚£å°±æ˜¯<strong>å»¶æ—¶åŒåˆ ç­–ç•¥</strong>ã€‚å³åœ¨æ›´æ–°æ•°æ®åº“ä¹‹åï¼Œå…ˆå»¶è¿Ÿç­‰å¾…ä¸€ä¸‹ï¼ˆç­‰å¾…æ—¶é—´å‚è€ƒè¯¥è¯»è¯·æ±‚çš„å“åº”æ—¶é—´+å‡ åæ¯«ç§’ï¼‰ï¼Œå†ç»§ç»­åˆ é™¤ç¼“å­˜ã€‚è¿™æ ·åšçš„ç›®çš„æ˜¯ç¡®ä¿è¯»è¯·æ±‚ç»“æŸï¼ˆå·²ç»åœ¨1.2è¯»åº“ä¸­è¯»å–åˆ°äº†æ—§æ•°æ®ï¼Œåç»­ä¼šåœ¨è¯¥è¯·æ±‚ä¸­æ›´æ–°ç¼“å­˜ï¼‰ï¼Œå†™è¯·æ±‚å¯ä»¥åˆ é™¤è¯»è¯·æ±‚é€ æˆçš„ç¼“å­˜è„æ•°æ®ï¼Œä¿è¯å†åˆ é™¤ç¼“å­˜ä¹‹åçš„æ‰€æœ‰è¯»è¯·æ±‚éƒ½èƒ½è¯»åˆ°æœ€æ–°å€¼ã€‚</p>\n<p><img src=\"/img/2024/2024111108.png\" alt=\"https://erik.xyz\"></p>\n<p>å¯ä»¥çœ‹å‡ºæ­¤ä¼˜åŒ–æ–¹æ¡ˆå…³é”®ç‚¹åœ¨äºç­‰å¾…å¤šé•¿æ—¶é—´åï¼Œå†æ¬¡åˆ é™¤ç¼“å­˜å°¤ä¸ºé‡è¦ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶é—´éƒ½æ˜¯æ ¹æ®å†å²æŸ¥è¯¢è¯·æ±‚çš„å“åº”æ—¶é—´åˆ¤æ–­çš„ï¼Œå®é™…æƒ…å†µä¼šæœ‰æµ®åŠ¨ã€‚è¿™ä¹Ÿå¯¼è‡´å¦‚æœç­‰å¾…çš„å»¶æ—¶æ—¶é—´è¿‡çŸ­ï¼Œåˆ™ä»ç„¶ä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´çš„æƒ…å†µï¼›ç­‰å¾…å»¶è¿Ÿæ—¶é—´è¿‡é•¿ï¼Œåˆ™å¯¼è‡´å»¶è¿ŸæœŸé—´å‡ºç°æ•°æ®ä¸ä¸€è‡´çš„æ—¶é—´å˜é•¿ã€‚</p>\n<p>å¦å¤–<strong>å»¶æ—¶åŒåˆ ç­–ç•¥</strong>è¿˜éœ€è¦è€ƒè™‘å¦‚æœå†æ¬¡åˆ é™¤ç¼“å­˜å¤±è´¥çš„æƒ…å†µå¦‚ä½•å¤„ç†ï¼Ÿ</p>\n<p>å› ä¸ºåˆ é™¤å¤±è´¥å°†å¯¼è‡´åç»­çš„æ‰€æœ‰çš„è¯»è¯·æ±‚ï¼Œåœ¨ç¼“å­˜æœªè¿‡æœŸæˆ–ç¼“å­˜æœªé‡æ–°æ­£ç¡®æ›´æ–°çš„æƒ…å†µä¸‹ï¼Œä¼šä¸€ç›´ä¿æŒäº†æ•°æ®çš„å®Œå…¨ä¸ä¸€è‡´ï¼è¿™ä¸ªåœ¨ä¸‹æ–‡çš„æŠ€æœ¯ä¼˜åŒ–æ–¹æ¡ˆç»§ç»­è®¨è®ºã€‚</p>\n<h4 id=\"å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜\"><a href=\"#å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜\" class=\"headerlink\" title=\"å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜\"></a>å…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜</h4><p>æ¯”è¾ƒæ¨èã€‚</p>\n<p>é‡‡ç”¨çš„â€œå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜â€ç­–ç•¥ï¼Œè·Ÿâ€œå…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“â€ä¸­æˆ‘ä»¬è¿›è¡Œ<strong>å»¶æ—¶åŒåˆ ç­–ç•¥</strong>çš„å°ä¼˜åŒ–åŸºæœ¬ä¸€æ ·ï¼Œä»ç„¶éœ€è¦è€ƒè™‘åˆ é™¤ç¼“å­˜å¤±è´¥çš„æƒ…å†µå¦‚ä½•å¤„ç†ã€‚</p>\n<p>å•çº¯ä»â€œå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜â€å’Œâ€œå…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“â€å¯¹æ¯”èµ·æ¥ã€‚åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œâ€œå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜â€è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>\n<p>1.<strong>æ•°æ®çš„ä¸€è‡´æ€§</strong>ï¼šè¿™ç§æ–¹æ³•æ›´å€¾å‘äºä¿æŒæ•°æ®çš„æœ€ç»ˆä¸€è‡´æ€§ï¼Œå³ä½¿ç¼“å­˜åˆ é™¤å¤±è´¥ï¼Œä¹Ÿèƒ½ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ä¸ä¼šé•¿æœŸå—æŸã€‚</p>\n<p>2.<strong>ç”¨æˆ·ä½“éªŒ</strong>ï¼šåœ¨â€œå…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“â€çš„æƒ…å†µä¸‹ï¼Œå¦‚æœæ•°æ®åº“æ›´æ–°å¤±è´¥ï¼Œç”¨æˆ·å¯èƒ½ä¼šä¸€ç›´çœ‹åˆ°æ—§æ•°æ®ï¼Œç›´åˆ°ç¼“å­˜è¿‡æœŸã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œâ€œå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜â€å¯ä»¥åœ¨æŸç§ç¨‹åº¦ä¸Šé¿å…è¿™ç§æƒ…å†µã€‚</p>\n<p>ä½†è¯¥æ–¹æ¡ˆåŒæ ·ä¹Ÿä¼šå‡ºç°æ•°æ®ä¸ä¸€è‡´æ€§é—®é¢˜ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>\n<p><img src=\"/img/2024/2024111109.png\" alt=\"https://erik.xyz\"></p>\n<p>å½“æ•°æ®åº“çš„æ•°æ®è¢«æ›´æ–°åï¼Œç¼“å­˜ä¹Ÿè¢«åˆ é™¤ã€‚æ¥ä¸‹æ¥çš„å‡ºç°è¯»è¯·æ±‚3.1å’Œå†™è¯·æ±‚3.2åŒæ—¶è¿›æ¥ã€‚</p>\n<p>è¯»è¯·æ±‚å…ˆè¯»äº†ç¼“å­˜å‘ç°ç¼“å­˜æ— å‘½ä¸­ï¼Œåˆ™æŸ¥è¯¢æ•°æ®åº“å¹¶åœ¨å‡†å¤‡æ›´æ–°ç¼“å­˜æ—¶ï¼Œ3.2å†™è¯·æ±‚å·²ç»å®Œæˆäº†æ•°æ®çš„æ›´æ–°å’Œåˆ é™¤ç¼“å­˜çš„åŠ¨ä½œï¼Œä¹‹å3.1è¯»è¯·æ±‚æ‰æ›´æ–°äº†ç¼“å­˜ã€‚æœ€åå¯¼è‡´äº†æ•°æ®åº“ä¸­çš„å€¼æœªæ–°å€¼ï¼Œç¼“å­˜ä¸­çš„å€¼ä¸ºæ—§å€¼ã€‚</p>\n<h4 id=\"ä¼˜åŒ–åæ–¹æ¡ˆ\"><a href=\"#ä¼˜åŒ–åæ–¹æ¡ˆ\" class=\"headerlink\" title=\"ä¼˜åŒ–åæ–¹æ¡ˆ\"></a>ä¼˜åŒ–åæ–¹æ¡ˆ</h4><p>ä»ä¸Šé¢çš„ç®€å•æ–¹æ¡ˆæ–¹æ¡ˆä¸­ï¼Œä¼¼ä¹æ²¡æœ‰ä¸€ç§æ–¹æ¡ˆçœŸæ­£èƒ½è§£å†³å¹¶å‘åœºæ™¯ä¸‹MySQLæ•°æ®ä¸Redisç¼“å­˜æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚</p>\n<p>è¿™é‡Œæœ‰ä¸ªè¯´æ˜ä¸‹ï¼Œå¦‚æœä¸šåŠ¡è¦æ±‚å¿…é¡»è¦æ»¡è¶³<strong>å¼ºä¸€è‡´æ€§</strong>ï¼Œé‚£ä¹ˆä¸ç®¡å¦‚ä½•ä¼˜åŒ–ç¼“å­˜ç­–ç•¥ï¼Œéƒ½æ— æ³•æ»¡è¶³ï¼Œè€Œæœ€å¥½çš„åŠæ³•æ˜¯ä¸ç”¨ç¼“å­˜ã€‚</p>\n<p>å¼ºä¸€è‡´æ€§ï¼šå®ƒè¦æ±‚ç³»ç»Ÿå†™å…¥ä»€ä¹ˆï¼Œè¯»å‡ºæ¥çš„ä¹Ÿä¼šæ˜¯ä»€ä¹ˆï¼Œç”¨æˆ·ä½“éªŒå¥½ï¼Œä½†å®ç°èµ·æ¥å¾€å¾€å¯¹ç³»ç»Ÿçš„æ€§èƒ½å½±å“å¤§ã€‚</p>\n<p>è§£å†³æ–¹æ¡ˆæ˜¯è¯»å†™ä¸²è¡ŒåŒ–ï¼Œè€Œæ­¤æ–¹æ¡ˆä¼šå¤§å¤§å¢åŠ ç³»ç»Ÿçš„å¤„ç†æ•ˆç‡ï¼Œååé‡ä¹Ÿä¼šå¤§å¤§é™ä½ã€‚</p>\n<p>å¦å¤–åœ¨å¤§å‹åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå…¶å®åˆ†å¸ƒå¼äº‹åŠ¡å¤§å¤šæ•°æƒ…å†µéƒ½ä¸ä¼šä½¿ç”¨ï¼Œå› ä¸ºç»´æŠ¤æˆæœ¬å¤ªé«˜äº†ã€å¤æ‚åº¦ä¹Ÿé«˜ã€‚æ‰€ä»¥åœ¨åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œæˆ‘ä»¬ä¸€èˆ¬éƒ½ä¼šæ¨å´‡æœ€ç»ˆä¸€è‡´æ€§ï¼Œå³è¿™ç§ä¸€è‡´æ€§çº§åˆ«çº¦æŸäº†ç³»ç»Ÿåœ¨å†™å…¥æˆåŠŸåï¼Œä¸æ‰¿è¯ºç«‹å³å¯ä»¥è¯»åˆ°å†™å…¥çš„å€¼ï¼Œä¹Ÿä¸æ‰¿è¯ºå¤šä¹…ä¹‹åæ•°æ®èƒ½å¤Ÿè¾¾åˆ°ä¸€è‡´ï¼Œä½†ä¼šå°½å¯èƒ½åœ°ä¿è¯åˆ°æŸä¸ªæ—¶é—´çº§åˆ«ï¼ˆæ¯”å¦‚ç§’çº§åˆ«ï¼‰åï¼Œæ•°æ®èƒ½å¤Ÿè¾¾åˆ°ä¸€è‡´çŠ¶æ€ã€‚</p>\n<p>ç°åœ¨æˆ‘ä»¬æ¥ç€ç»§ç»­ä¼˜åŒ–..</p>\n<h4 id=\"å»¶è¿ŸåŒåˆ ç­–ç•¥-é‡è¯•æœºåˆ¶\"><a href=\"#å»¶è¿ŸåŒåˆ ç­–ç•¥-é‡è¯•æœºåˆ¶\" class=\"headerlink\" title=\"å»¶è¿ŸåŒåˆ ç­–ç•¥+é‡è¯•æœºåˆ¶\"></a>å»¶è¿ŸåŒåˆ ç­–ç•¥+é‡è¯•æœºåˆ¶</h4><p>ä»ä¸Šé¢ç®€å•æ–¹æ¡ˆä¸‹çš„æ¼æ´ç™¾å‡ºä¸‹çš„å…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºæ¥å…¶å®<strong>å»¶è¿ŸåŒåˆ ç­–ç•¥</strong>ï¼Œç®—æ˜¯èåˆâ€œå…ˆåˆ é™¤ç¼“å­˜ï¼Œå†æ›´æ–°æ•°æ®åº“â€å’Œâ€œå…ˆæ›´æ–°æ•°æ®åº“ï¼Œå†åˆ é™¤ç¼“å­˜â€çš„ç­–ç•¥ï¼Œå¯ä»¥è§£å†³å¤§éƒ¨åˆ†çš„æ•°æ®ä¸€è‡´æ€§çš„ä¸šåŠ¡é€»è¾‘å¤„ç†é—®é¢˜ã€‚</p>\n<p>ä½†æˆ‘ä»¬å‰é¢è¿˜é—ç•™äº†ä¸€ä¸ªå¾…è§£å†³çš„é—®é¢˜ï¼šå¦‚æœå†æ¬¡<strong>åˆ é™¤ç¼“å­˜å¤±è´¥çš„æƒ…å†µå¦‚ä½•å¤„ç†</strong>ï¼Ÿ</p>\n<p>â€”â€”-å½“ç„¶æ˜¯è¡¥æ•‘å»ç»§ç»­åˆ é™¤è¿™ä¸ªç¼“å­˜Keyäº†ï¼Œè€Œè¡¥æ•‘æ–¹æ³•åˆ™æ˜¯<strong>é‡è¯•</strong>ã€‚</p>\n<p><strong>é‡è¯•æœºåˆ¶</strong>å¯ä»¥åœ¨å½“å‰ä¸­å¯åŠ¨æ–°åç¨‹ï¼ˆGolangä¸­å±äºç”¨æˆ·æ€çš„è½»é‡çº§çº¿ç¨‹ï¼‰ä¸­è¿›è¡Œé‡è¯•ï¼›ä¹Ÿå¯ä»¥æ”¾åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¿›è¡Œé‡è¯•ï¼›è¿˜å¯ä»¥æ˜¯å…ˆå¯åŠ¨æ–°åç¨‹é‡è¯•3æ¬¡ï¼Œé‡è¯•å¤±è´¥åç»§ç»­æ”¾åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­é‡è¯•ï¼Œå¦‚ä¸‹å›¾å±•ç¤ºçš„æ˜¯æ”¾åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­è¿›è¡Œé‡è¯•ã€‚</p>\n<p>æ–°åç¨‹ä¸­è¿›è¡Œé‡è¯•éœ€è¦æ³¨æ„çš„æ˜¯ä½¿ç”¨çš„æ–°ä¸Šä¸‹æ–‡context.Background()ï¼Œè€Œä¸æ˜¯å½“å‰è¯·æ±‚çš„ä¸Šä¸‹æ–‡ã€‚</p>\n<p>ä¸€èˆ¬æ¶ˆæ¯é˜Ÿåˆ—ä¼šæ”¯æŒé«˜å¯é æ€§çš„é˜Ÿåˆ—ï¼Œä¾‹å¦‚ RabbitMQã€Kafka ç­‰ã€‚è¿™äº›æ¶ˆæ¯é˜Ÿåˆ—æä¾›äº†éå¸¸å¼ºçš„æ¶ˆæ¯ä¼ é€’ã€å¼‚æ­¥å¤„ç†å’ŒæŒä¹…åŒ–åŠŸèƒ½ï¼Œå¯ä»¥æœ‰æ•ˆåœ°è§£å†³æ•°æ®åŒæ­¥çš„é—®é¢˜ã€‚</p>\n<p><img src=\"/img/2024/2024111110.png\" alt=\"https://erik.xyz\"></p>\n<p>æ­¤æ–¹æ¡ˆä»ç„¶å­˜åœ¨ä¸€äº›éœ€è¦ï¼Œå¦‚ï¼šé€‰æ‹©åˆé€‚çš„å»¶è¿Ÿç­‰å¾…æ—¶é—´è¿›è¡Œåˆ é™¤ç¼“å­˜ï¼›åç¨‹ä¸­é‡è¯•åˆ é™¤ç¼“å­˜æ¬¡æ•°ã€é—´éš”æ—¶é—´ï¼›æ¶ˆæ¯é˜Ÿåˆ—ä¸­åˆ é™¤å¤±è´¥ç¼“å­˜å¤±è´¥åæ˜¯å¦éœ€è¦é‡è¯•ç­‰ã€‚</p>\n<h4 id=\"è¯»å–binlogå¼‚æ­¥åˆ é™¤ç¼“å­˜\"><a href=\"#è¯»å–binlogå¼‚æ­¥åˆ é™¤ç¼“å­˜\" class=\"headerlink\" title=\"è¯»å–binlogå¼‚æ­¥åˆ é™¤ç¼“å­˜\"></a>è¯»å–binlogå¼‚æ­¥åˆ é™¤ç¼“å­˜</h4><p>é‡è¯•åˆ é™¤ç¼“å­˜æœºåˆ¶è¿˜å¯ä»¥å§ï¼Œå°±æ˜¯ä¼šé€ æˆå¥½å¤šä¸šåŠ¡ä»£ç å…¥ä¾µã€‚</p>\n<p>å…¶å®ï¼Œè¿˜å¯ä»¥è¿™æ ·ä¼˜åŒ–ï¼š</p>\n<p>1.é€šè¿‡Canalå°†binlogæ—¥å¿—é‡‡é›†å‘é€åˆ°MQé˜Ÿåˆ—æ¥å¼‚æ­¥æ·˜æ±°keyã€‚</p>\n<p>2.åˆ é™¤ç¼“å­˜çš„åº”ç”¨ç¨‹åºé€šè¿‡ACKæ‰‹åŠ¨æœºåˆ¶ç¡®è®¤å¤„ç†è¿™æ¡æ›´æ–°æ¶ˆæ¯ï¼Œåˆ é™¤ç¼“å­˜ï¼Œä¿è¯æ•°æ®ç¼“å­˜ä¸€è‡´æ€§ã€‚</p>\n<p><img src=\"/img/2024/2024111111.png\" alt=\"https://erik.xyz\"></p>\n<p>å¼‚æ­¥æ·˜æ±°keyç›¸æ¯”äºç­‰æ–°å¯¹æ¯”ç¼“å­˜æ•°æ®å¹¶æ›´æ–°ä¼šç®€å•ä¸€äº›ï¼Œå› ä¸ºå¯èƒ½ä¸€ä»½ç¼“å­˜æ•°æ®æ¶‰åŠå¤šå¼ è¡¨çš„æ•°æ®æŸ¥è¯¢ã€èšåˆã€æ’åºç­‰ã€‚</p>\n<p>å°½ç®¡è¯¥æ–¹æ¡ˆçœ‹èµ·æ¥ä¹Ÿä¸é”™äº†ï¼Œä½†æ˜¯å› ä¸ºå¼•å…¥é¢å¤–çš„ç»„ä»¶ï¼ˆå¦‚Canalã€æ¶ˆæ¯é˜Ÿåˆ—ï¼‰å¤æ‚æ€§å¢åŠ äº†ä¹Ÿä¸å°‘ï¼Œéœ€è¦ç»´æŠ¤å’Œç›‘æ§è¿™äº›ç»„ä»¶çš„è¿è¡ŒçŠ¶æ€ï¼Œä¿è¯ç»„ä»¶è¿è¡Œæ­£å¸¸ã€‚</p>\n<h4 id=\"å®šæ—¶ä»»åŠ¡\"><a href=\"#å®šæ—¶ä»»åŠ¡\" class=\"headerlink\" title=\"å®šæ—¶ä»»åŠ¡\"></a>å®šæ—¶ä»»åŠ¡</h4><p>åœ¨æŸäº›ä¸šåŠ¡åœºæ™¯çš„éœ€æ±‚ä¸‹ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å®šæ—¶ä»»åŠ¡çš„æ–¹å¼è¿›è¡Œ Redis å’Œ MySQL çš„æ•°æ®åŒæ­¥ã€‚</p>\n<p>å…·ä½“åšæ³•æ˜¯é€šè¿‡å®šæ—¶ä»»åŠ¡ä» Redis ä¸­è¯»å–æ•°æ®ï¼Œç„¶åè·Ÿ MySQL ä¸­çš„æ•°æ®è¿›è¡Œæ¯”å¯¹ï¼Œå¦‚æœ Redis ä¸­æ•°æ®æœ‰å˜åŒ–ï¼Œåˆ™è¿›è¡ŒåŒæ­¥ã€‚</p>\n<p><img src=\"/img/2024/2024111112.png\" alt=\"https://erik.xyz\"></p>\n<p>è¿™ç§æ–¹å¼è™½ç„¶å®ç°èµ·æ¥æ¯”è¾ƒç®€å•ï¼Œä½†éœ€è¦æ³¨æ„åŒæ­¥çš„æ—¶æ•ˆæ€§ï¼Œå¦‚æœæ—¶é—´é—´éš”è®¾ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒæ­¥çš„æ•°æ®ä¸¢å¤±æˆ–è€…ä¸å‡†ç¡®ã€‚</p>\n<h4 id=\"åŒå†™ä¸€è‡´æ€§\"><a href=\"#åŒå†™ä¸€è‡´æ€§\" class=\"headerlink\" title=\"åŒå†™ä¸€è‡´æ€§\"></a>åŒå†™ä¸€è‡´æ€§</h4><p>åœ¨æ›´æ–°æ•°æ®åº“çš„åŒæ—¶ä¹Ÿæ›´æ–°ç¼“å­˜/åˆ é™¤ç¼“å­˜ï¼Œå³æ‰€è°“çš„â€œ<strong>åŒå†™</strong>â€ã€‚</p>\n<p>è¿™æ ·å¯ä»¥ç¡®ä¿åœ¨æ•°æ®åº“æ›´æ–°åï¼Œç¼“å­˜ä¸­çš„æ•°æ®ä¹Ÿæ˜¯æœ€æ–°çš„ï¼Œä»è€Œå‡å°‘æ•°æ®ä¸ä¸€è‡´çš„æ—¶é—´çª—å£ã€‚</p>\n<p><img src=\"/img/2024/2024111113.png\" alt=\"https://erik.xyz\"></p>\n<p><strong>å¹¶å‘æ§åˆ¶</strong>ï¼šåœ¨é«˜å¹¶å‘åœºæ™¯ä¸‹ï¼Œå¤šä¸ªè¯·æ±‚åŒæ—¶å¯¹åŒä¸€ä¸ªæ•°æ®è¿›è¡Œæ›´æ–°æ—¶ï¼Œå¦‚æœæ²¡æœ‰å¦¥å–„å¤„ç†å¹¶å‘æ§åˆ¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ã€‚æ‰€ä»¥è¿™é‡Œå¼•å…¥äº†åˆ†å¸ƒå¼é”å’Œäº‹åŠ¡æ“ä½œï¼š</p>\n<p><strong>ä½¿ç”¨åˆ†å¸ƒå¼é”</strong>ï¼šåœ¨æ‰§è¡ŒåŒå†™æ“ä½œä¹‹å‰ï¼Œè·å–ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼ˆå¦‚Zookeeperã€Redisçš„SETNXå‘½ä»¤ç­‰ï¼‰ï¼Œç¡®ä¿åŒä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹/è¿›ç¨‹èƒ½å¤Ÿæ‰§è¡ŒåŒå†™æ“ä½œã€‚</p>\n<p><strong>äº‹åŠ¡å¤„ç†</strong>ï¼šå¯¹äºæ”¯æŒäº‹åŠ¡çš„ç¼“å­˜ç³»ç»Ÿï¼ˆå¦‚Redisçš„MULTI/EXECå‘½ä»¤ï¼‰å’ŒMySQLäº‹åŠ¡ï¼Œå¯ä»¥å°†Redisç¼“å­˜å’ŒMySQLæ›´æ–°æ“ä½œæ”¾å…¥äº‹åŠ¡ä¸­ï¼Œç¡®ä¿è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥ã€‚</p>\n<p>å½“ç„¶åœ¨â€œåŒå†™â€çš„ç­–ç•¥ä¸­ï¼Œé™¤äº†å¹¶å‘æ§åˆ¶å¤–ï¼Œå¯ä»¥ç»“åˆä¸Šé¢æåˆ°çš„é‡è¯•ã€å®šæ—¶ç­–ç•¥è¿›è¡Œç»„åˆï¼Œä»¥åº”å¯¹æç«¯æƒ…å†µä¸‹çš„æ•°æ®ä¸ä¸€è‡´æ€§é—®é¢˜ã€‚</p>\n<p>å¦å¤–ä¹Ÿå¯ä»¥å¤„ç†å¤±è´¥çš„é€»è¾‘ä¸ŠåŠ å…¥å‘Šè­¦æœºåˆ¶ï¼ŒåŠæ—¶é€šçŸ¥å¼€å‘å’Œè¿ç»´äººå‘˜ã€‚</p>\n<p>è½¬è½½è‡ªï¼š<a href=\"https://mp.weixin.qq.com/s/sG7xDtLKLtlnu9ntpc5hdw\">çš‡å­è°ˆæŠ€æœ¯</a></p>\n",
            "tags": [
                "mysql",
                "redis",
                "æ•°æ®ä¸€è‡´æ€§"
            ]
        },
        {
            "id": "https://erik.xyz/2024/10/23/rohibit-video-playback/",
            "url": "https://erik.xyz/2024/10/23/rohibit-video-playback/",
            "title": "åœ¨æ‰‹æœºæµè§ˆå™¨ä¸­ç¦æ­¢æ’­æ”¾è§†é¢‘ã€æš‚åœã€å¿«è¿›ç­‰æ“ä½œ",
            "date_published": "2024-10-23T12:27:00.000Z",
            "content_html": "<p><b>1. ç¦æ­¢æš‚åœã€å¿«è¿›ç­‰æ“ä½œ</b></p>\n<p>å¯ä»¥é€šè¿‡å°† controls å±æ€§ä» <code>&lt;video&gt;</code>å…ƒç´ ä¸­ç§»é™¤ï¼Œé˜²æ­¢ç”¨æˆ·é€šè¿‡æ§åˆ¶æ¡è¿›è¡Œæ“ä½œã€‚ç„¶åé€šè¿‡ JavaScript å¼ºåˆ¶æ§åˆ¶è§†é¢‘æ’­æ”¾çš„çŠ¶æ€ï¼Œä¸å…è®¸ç”¨æˆ·æš‚åœæˆ–å¿«è¿›ã€‚<br><span id=\"more\"></span><br><figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;video id=&quot;myVideo&quot; width=&quot;100%&quot; autoplay loop&gt;</span><br><span class=\"line\">  &lt;source src=&quot;your-video.mp4&quot; type=&quot;video/mp4&quot;&gt;</span><br><span class=\"line\">  Your browser does not support the video tag.</span><br><span class=\"line\">&lt;/video&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;script&gt;</span><br><span class=\"line\">  var video = document.getElementById(&quot;myVideo&quot;);</span><br><span class=\"line\">  </span><br><span class=\"line\">  // ç¦æ­¢æš‚åœã€å¿«è¿›ç­‰æ“ä½œ</span><br><span class=\"line\">  video.controls = false; // ç¦ç”¨æ§ä»¶</span><br><span class=\"line\">  video.play(); // å¼ºåˆ¶æ’­æ”¾</span><br><span class=\"line\">  </span><br><span class=\"line\">  // ç›‘å¬æ—¶é—´æ›´æ–°äº‹ä»¶ï¼Œç¡®ä¿è§†é¢‘ä¸è¢«æš‚åœæˆ–å¿«è¿›</span><br><span class=\"line\">  video.addEventListener(&#x27;play&#x27;, function() &#123;</span><br><span class=\"line\">    video.currentTime = 0; // é‡ç½®è§†é¢‘æ—¶é—´ï¼Œé¿å…ç”¨æˆ·å¿«è¿›</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  video.addEventListener(&#x27;seeked&#x27;, function() &#123;</span><br><span class=\"line\">    video.currentTime = 0; // é‡ç½®è§†é¢‘æ—¶é—´ï¼Œé¿å…ç”¨æˆ·è·³è·ƒ</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">  // ç›‘å¬ç‚¹å‡»æš‚åœç­‰æ“ä½œ</span><br><span class=\"line\">  video.addEventListener(&#x27;pause&#x27;, function() &#123;</span><br><span class=\"line\">    video.play(); // ç¦æ­¢æš‚åœ</span><br><span class=\"line\">  &#125;);</span><br><span class=\"line\">&lt;/script&gt;</span><br></pre></td></tr></table></figure><br><b>2. ä½¿ç”¨ pointer-events ç¦æ­¢ç‚¹å‡»æ“ä½œ</b></p>\n<p>ä½ è¿˜å¯ä»¥é€šè¿‡ CSS æ¥ç¦æ­¢ç”¨æˆ·ä¸è§†é¢‘æ§ä»¶è¿›è¡Œäº¤äº’ã€‚é€šè¿‡ pointer-events: none; å¯ä»¥ä½¿ç”¨æˆ·æ— æ³•ç‚¹å‡»è§†é¢‘ï¼Œè¿›è€Œç¦æ­¢æ’­æ”¾ã€æš‚åœç­‰äº¤äº’æ“ä½œã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;video id=&quot;myVideo&quot; width=&quot;100%&quot; autoplay loop&gt;</span><br><span class=\"line\">  &lt;source src=&quot;your-video.mp4&quot; type=&quot;video/mp4&quot;&gt;</span><br><span class=\"line\">  Your browser does not support the video tag.</span><br><span class=\"line\">&lt;/video&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style&gt;</span><br><span class=\"line\">  #myVideo &#123;</span><br><span class=\"line\">    pointer-events: none; /* ç¦æ­¢ç”¨æˆ·äº¤äº’ */</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n<p><b>3. ç¦æ­¢è§†é¢‘æ§åˆ¶æ¡æ˜¾ç¤º</b></p>\n<p>ä¸€äº›æ‰‹æœºæµè§ˆå™¨ä¼šè‡ªåŠ¨æ˜¾ç¤ºè§†é¢‘æ§åˆ¶æ¡ã€‚ä¸ºäº†ç¦æ­¢è¿™ç§è¡Œä¸ºï¼Œå¯ä»¥é€šè¿‡ CSS æ§åˆ¶ï¼š</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;video id=&quot;myVideo&quot; width=&quot;100%&quot; autoplay loop&gt;</span><br><span class=\"line\">  &lt;source src=&quot;your-video.mp4&quot; type=&quot;video/mp4&quot;&gt;</span><br><span class=\"line\">  Your browser does not support the video tag.</span><br><span class=\"line\">&lt;/video&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;style&gt;</span><br><span class=\"line\">  #myVideo::-webkit-media-controls &#123;</span><br><span class=\"line\">    display: none !important; /* Safari/iOS */</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  #myVideo::-moz-media-controls &#123;</span><br><span class=\"line\">    display: none !important; /* Firefox */</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  #myVideo::-ms-media-controls &#123;</span><br><span class=\"line\">    display: none !important; /* IE/Edge */</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&lt;/style&gt;</span><br></pre></td></tr></table></figure>\n<p><b>4. å®Œå…¨é˜»æ­¢ç”¨æˆ·ä¸è§†é¢‘äº¤äº’</b></p>\n<p>é€šè¿‡å°†è§†é¢‘å…ƒç´ è®¾ç½®ä¸ºå…¨å±ï¼Œæˆ–è€…å®Œå…¨è¦†ç›–åœ¨è§†é¢‘ä¸Šçš„é€æ˜å±‚ä¹Ÿå¯ä»¥å®ç°ç¦æ­¢ç”¨æˆ·ä¸è§†é¢‘äº¤äº’çš„æ•ˆæœã€‚</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;video id=&quot;myVideo&quot; width=&quot;100%&quot; autoplay loop&gt;</span><br><span class=\"line\">  &lt;source src=&quot;your-video.mp4&quot; type=&quot;video/mp4&quot;&gt;</span><br><span class=\"line\">  Your browser does not support the video tag.</span><br><span class=\"line\">&lt;/video&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">&lt;div id=&quot;overlay&quot; style=&quot;position:absolute; top:0; left:0; width:100%; height:100%; background: rgba(255, 255, 255, 0); pointer-events: all;&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>",
            "tags": [
                "æµè§ˆå™¨ç¦æ­¢æ“ä½œè§†é¢‘",
                "ç¦æ­¢è§†é¢‘"
            ]
        },
        {
            "id": "https://erik.xyz/2024/09/22/internet-practice/",
            "url": "https://erik.xyz/2024/09/22/internet-practice/",
            "title": "å²ä¸Šæœ€è¯¦ç»†çš„äº’è”ç½‘é¡¹ç›®ç®¡ç†å®æˆ˜å›¾è§£",
            "date_published": "2024-09-22T00:46:00.000Z",
            "content_html": "<p><img src=\"/img/2024/640.jpeg\" alt=\"erik.xyz\"></p>\n<p>å¦‚ä½•ç³»ç»Ÿçš„æŒæ¡äº’è”ç½‘é¡¹ç›®ç®¡ç†çŸ¥è¯†å’Œç»éªŒï¼Œæˆ‘æœç½—ä¸–é¢ä¸ŠåŸºæœ¬æ²¡æœ‰ä»‹ç»è¿™æ–¹é¢çš„å›¾ä¹¦ï¼Œä¸ºæ­¤å’±ä»¬å»å¹´å¹´åˆï¼Œç»„ç»‡å’±ä»¬å‰æ²¿ç¤¾åŒºçš„ä¼—å¤šå¤§å’–è”åˆç”µå­å·¥ä¸šå‡ºç‰ˆç¤¾å‡ºç‰ˆäº†è¿™æœ¬æ–°ä¹¦ã€Šäº’è”ç½‘é¡¹ç›®ç®¡ç†å®æˆ˜æŒ‡å—ã€‹å¸Œæœ›å¯ä»¥åŠ©å¤§å®¶ä¸€è‡‚ä¹‹åŠ›ï¼ä»Šå¤©æŠŠæ–‡ç« çš„æ€ç»´å¯¼å›¾å¹²è´§ä¸€èµ·åˆ†äº«ç»™å¤§å®¶ï¼<br><span id=\"more\"></span><br><img src=\"/img/2024/640.png\" alt=\"erik.xyz\"></p>\n<p><img src=\"/img/2024/641.png\" alt=\"erik.xyz\"></p>\n<p><img src=\"/img/2024/642.png\" alt=\"erik.xyz\"></p>\n<p><img src=\"/img/2024/643.png\" alt=\"erik.xyz\"></p>\n<p><img src=\"/img/2024/644.png\" alt=\"erik.xyz\"></p>\n<p>äº’è”ç½‘é¡¹ç›®ç®¡ç†çš„17æ¡ç»éªŒæ²Ÿé€šæ˜¯ç‹é“ </p>\n<ul>\n<li>ä¸è®ºæŠ€æœ¯å¤šä¹ˆå…ˆè¿›ï¼Œæ²¡æœ‰è‰¯å¥½çš„æ²Ÿé€šæœºåˆ¶ï¼Œé¡¹ç›®éƒ½ä¼šé‡åˆ°ç“¶é¢ˆã€‚ç¡®ä¿å›¢é˜Ÿæˆå‘˜ä¹‹é—´æœ‰å¼€æ”¾çš„æ²Ÿé€šæ¸ é“ï¼Œå¹¶ä¸”æ¯ä¸ªäººéƒ½æ¸…æ¥šè‡ªå·±çš„èŒè´£å’Œé¡¹ç›®çš„æ•´ä½“ç›®æ ‡ã€‚ä¼˜å…ˆçº§é«˜äºä¸€åˆ‡ </li>\n<li>å­¦ä¼šåŒºåˆ†å“ªäº›åŠŸèƒ½æ˜¯å¿…é¡»çš„ï¼Œå“ªäº›å¯ä»¥ç¨åæ·»åŠ ã€‚ä¼˜å…ˆå¤„ç†é‚£äº›å¯¹ç”¨æˆ·æ¥è¯´æœ€é‡è¦çš„åŠŸèƒ½ã€‚çŸ­å‘¨æœŸå‘å¸ƒ </li>\n<li>é€šè¿‡ç¼©çŸ­å‘å¸ƒå‘¨æœŸï¼Œå¯ä»¥æ›´å¿«åœ°å¾—åˆ°ç”¨æˆ·åé¦ˆï¼Œå¹¶åŠæ—¶è°ƒæ•´æ–¹å‘ï¼Œå‡å°‘èµ„æºæµªè´¹ã€‚ç”¨æˆ·åé¦ˆæ˜¯é‡‘ - å§‹ç»ˆä¿æŒä¸ç”¨æˆ·çš„è”ç³»ï¼Œæ”¶é›†ä»–ä»¬çš„åé¦ˆï¼Œå¹¶å¿«é€Ÿåšå‡ºå“åº”ã€‚è¿™æœ‰åŠ©äºäº§å“ä¸æ–­æ”¹è¿›ã€‚ç®€åŒ–å°±æ˜¯ç¾ </li>\n<li>å°½é‡ç®€åŒ–äº§å“çš„è®¾è®¡å’ŒåŠŸèƒ½ï¼Œé¿å…ä¸å¿…è¦çš„å¤æ‚æ€§ã€‚ç®€å•æ˜“ç”¨çš„äº§å“å¾€å¾€æ›´å—æ¬¢è¿ã€‚è´¨é‡æ§åˆ¶ä¸å¯å¿½è§† </li>\n<li>åœ¨é¡¹ç›®çš„æ¯ä¸ªé˜¶æ®µéƒ½è¦è¿›è¡Œè´¨é‡æ£€æŸ¥ï¼Œé˜²æ­¢å°é—®é¢˜ç§¯ç´¯æˆå¤§é—®é¢˜ã€‚é£é™©ç®¡ç†è¦æå‰ - å¯¹æ½œåœ¨çš„é£é™©è¿›è¡Œè¯„ä¼°ï¼Œå¹¶åˆ¶å®šç›¸åº”çš„åº”å¯¹ç­–ç•¥ï¼Œè¿™æ ·å¯ä»¥åœ¨é—®é¢˜å‘ç”Ÿå‰å°±è§£å†³å®ƒä»¬ã€‚çµæ´»è°ƒæ•´è®¡åˆ’ </li>\n<li>è®¡åˆ’æ°¸è¿œèµ¶ä¸ä¸Šå˜åŒ–ï¼Œå­¦ä¼šåœ¨é¡¹ç›®è¿‡ç¨‹ä¸­æ ¹æ®å®é™…æƒ…å†µè°ƒæ•´è®¡åˆ’æ˜¯éå¸¸é‡è¦çš„ã€‚å›¢é˜Ÿå»ºè®¾å¾ˆé‡è¦ </li>\n<li>æŠ•èµ„äºå›¢é˜Ÿå»ºè®¾æ´»åŠ¨ï¼Œå¢å¼ºå›¢é˜Ÿå‡èšåŠ›ï¼Œæé«˜å·¥ä½œæ•ˆç‡ã€‚æŠ€æœ¯é€‰å‹è¦è°¨æ… </li>\n<li>åœ¨é€‰æ‹©æŠ€æœ¯æ ˆæ—¶è¦è€ƒè™‘é•¿è¿œå‘å±•ï¼Œè€Œä¸æ˜¯ä»…ä»…å› ä¸ºæŸé¡¹æŠ€æœ¯å½“å‰æµè¡Œã€‚æ•°æ®é©±åŠ¨å†³ç­– </li>\n<li>ä½¿ç”¨æ•°æ®åˆ†ææ¥æ”¯æŒäº§å“å†³ç­–ï¼Œè€Œä¸æ˜¯ä»…å‡­ç›´è§‰ã€‚é‡è§†ç”¨æˆ·ä½“éªŒ </li>\n<li>ç”¨æˆ·ä½“éªŒåº”è¯¥è´¯ç©¿æ•´ä¸ªäº§å“ç”Ÿå‘½å‘¨æœŸï¼Œä»è®¾è®¡åˆ°å¼€å‘å†åˆ°æµ‹è¯•ï¼Œéƒ½è¦è€ƒè™‘åˆ°ç”¨æˆ·ä½“éªŒã€‚æŒç»­å­¦ä¹ ä¸é€‚åº” </li>\n<li>æŠ€æœ¯å’Œå¸‚åœºéƒ½åœ¨ä¸æ–­å˜åŒ–ï¼ŒæŒç»­å­¦ä¹ æ–°çš„çŸ¥è¯†å’ŒæŠ€æœ¯æ˜¯å¿…è¦çš„ã€‚æ–‡æ¡£åŒ–é‡è¦ä¿¡æ¯ </li>\n<li>ç¡®ä¿æ‰€æœ‰çš„å…³é”®å†³ç­–å’Œä¿¡æ¯éƒ½æœ‰è®°å½•ï¼Œè¿™å¯¹äºæ–°åŠ å…¥çš„å›¢é˜Ÿæˆå‘˜æ¥è¯´å°¤å…¶é‡è¦ã€‚å¥åº·çš„å·¥ä½œç”Ÿæ´»å¹³è¡¡ - é¼“åŠ±å›¢é˜Ÿæˆå‘˜ä¿æŒè‰¯å¥½çš„å·¥ä½œç”Ÿæ´»å¹³è¡¡ï¼Œè¿‡åº¦åŠ³ç´¯åªä¼šé™ä½ç”Ÿäº§åŠ›å’Œåˆ›æ–°èƒ½åŠ›ã€‚æŒç»­é›†æˆ/æŒç»­éƒ¨ç½²ï¼ˆCI/CDï¼‰ </li>\n<li>å®æ–½CI/CDæµç¨‹ï¼Œä¸ä»…æé«˜äº†ä»£ç çš„è´¨é‡ï¼Œä¹ŸåŠ é€Ÿäº†è½¯ä»¶çš„å‘å¸ƒå‘¨æœŸã€‚é€æ˜åº¦æå‡ä¿¡ä»» </li>\n<li>ä¿æŒé¡¹ç›®è¿›å±•çš„é€æ˜ï¼Œå®šæœŸå‘æ‰€æœ‰ç›¸å…³æ–¹æ±‡æŠ¥è¿›åº¦ï¼Œè¿™æ ·å¯ä»¥å»ºç«‹ä¿¡ä»»å¹¶å‡å°‘è¯¯è§£ã€‚</li>\n</ul>\n<p>è½¬è½½è‡ªï¼š<a href=\"https://mp.weixin.qq.com/s/kv0BAmE6ASll9eZjvlZImQ\">PMOå‰æ²¿</a></p>\n",
            "tags": [
                "äº’è”",
                "é¡¹ç›®å®æˆ˜"
            ]
        }
    ]
}